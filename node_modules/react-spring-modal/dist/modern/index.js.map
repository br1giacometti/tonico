{"version":3,"file":"index.js","sources":["../../src/index.tsx"],"sourcesContent":["import {\n  Children,\n  cloneElement,\n  ComponentProps,\n  ComponentType,\n  createContext,\n  CSSProperties,\n  HTMLAttributes,\n  ReactNode,\n  useContext,\n  useMemo,\n  useState,\n  isValidElement\n} from 'react';\n\nimport { animated, useTransition, UseTransitionProps } from 'react-spring';\nimport { DialogOverlay, DialogContent } from '@reach/dialog';\n\nimport { useId } from '@reach/auto-id';\n\nexport const AnimatedDialogOverlay = animated(DialogOverlay);\nexport const AnimatedDialogContent = animated(DialogContent);\n\nconst emptyObject = {};\ntype CssTransitionProps = UseTransitionProps<boolean, CSSProperties>;\ninterface ModalTransition {\n  initial?: CssTransitionProps['initial'];\n  from?: CssTransitionProps['from'];\n  enter?: CssTransitionProps['enter'];\n  leave?: CssTransitionProps['leave'];\n}\n\n/**\n * Input: `{ opacity: 0 }`\n * Output: `{ 'overlay__opacity': 0 }`\n */\nfunction prefixProperties(\n  prefix: string,\n  props: ModalTransition['initial'] | ModalTransition['from'] | ModalTransition['enter'] | ModalTransition['leave']\n): Object {\n  if (typeof props === 'object' && props !== null) {\n    return Object.fromEntries(Object.entries(props).map(([key, value]) => [`${prefix}__${key}`, value]));\n  }\n\n  return emptyObject;\n}\n\n/**\n * Input: `{ 'overlay__opacity': 0, other: 'stuff' }`\n * Output: `{ opacity: 0 }`\n */\nfunction removePropertyPrefixes(prefix: string, props: Object): Object {\n  return Object.fromEntries(\n    Object.entries(props)\n      .filter(([key]) => key.startsWith(prefix + '__'))\n      .map(([key, value]) => [key.replace(prefix + '__', ''), value])\n  );\n}\n\nconst defaultOverlayTransition: ModalTransition = {\n  from: { opacity: 0 },\n  enter: { opacity: 1 },\n  leave: { opacity: 0 }\n};\n\ntype ReplacePartial<Type, Keys> = { [key in Exclude<keyof Type, Keys>]: Type[key] } &\n  { [key in keyof Type]?: Type[key] | undefined };\ntype OverlayProps = HTMLAttributes<Element> & ReplacePartial<ComponentProps<typeof AnimatedDialogOverlay>, 'as'>;\ntype ContentProps = HTMLAttributes<Element> & ReplacePartial<ComponentProps<typeof AnimatedDialogContent>, 'as'>;\n\ninterface ModalContextState {\n  labelId?: string;\n  onDismiss?: (event?: React.SyntheticEvent) => void;\n}\nconst ModalContext = createContext<ModalContextState>({});\n\ninterface BaseModalProps {\n  isOpen: boolean;\n  onDismiss?: (event?: React.SyntheticEvent) => void;\n  children: ReactNode;\n  dangerouslyBypassFocusLock?: boolean;\n  overlayProps?: OverlayProps;\n  overlayTransition?: ModalTransition;\n  contentProps?: ContentProps;\n  contentTransition?: ModalTransition;\n  transitionConfig?: Omit<CssTransitionProps, 'initial' | 'from' | 'enter' | 'leave'> & {\n    onRest?: (isOpen: boolean, animationStatus: string) => void;\n  };\n  labelId?: string;\n}\nexport function BaseModal({\n  isOpen,\n  onDismiss,\n  children,\n  dangerouslyBypassFocusLock,\n  overlayProps: {\n    style: overlayStyle = emptyObject,\n    className: overlayClassName = '',\n    ...otherOverlayProps\n  } = emptyObject,\n  overlayTransition = defaultOverlayTransition,\n  contentProps: {\n    style: contentStyle = emptyObject,\n    className: contentClassName = '',\n    ...otherContentProps\n  } = emptyObject,\n  contentTransition,\n  transitionConfig = emptyObject,\n  labelId\n}: BaseModalProps) {\n  const [status, setStatus] = useState('focus-unlocked');\n  const values = useMemo(\n    () =>\n      ({\n        initial: {\n          ...prefixProperties('overlay', overlayTransition?.initial),\n          ...prefixProperties('content', contentTransition?.initial)\n        },\n        from: {\n          ...prefixProperties('overlay', overlayTransition?.from),\n          ...prefixProperties('content', contentTransition?.from)\n        },\n        enter: {\n          ...prefixProperties('overlay', overlayTransition?.enter),\n          ...prefixProperties('content', contentTransition?.enter)\n        },\n        leave: {\n          ...prefixProperties('overlay', overlayTransition?.leave),\n          ...prefixProperties('content', contentTransition?.leave)\n        },\n        ...transitionConfig,\n        onRest(isOpen: boolean, animationStatus: string) {\n          if (typeof transitionConfig.onRest === 'function') {\n            transitionConfig?.onRest(isOpen, animationStatus);\n          }\n          if (animationStatus === 'update') setStatus(isOpen ? 'focus-locked' : 'focus-unlocked'); // if done opening, lock focus. if done closing, unlock focus\n        }\n      } as ModalTransition),\n    [overlayTransition, contentTransition, transitionConfig]\n  );\n  const transition = useTransition(isOpen, null, values);\n  labelId = useId(labelId);\n\n  // If the dev doesn't set `dangerouslyBypassFocusLock`, use our status\n  if (dangerouslyBypassFocusLock === undefined) dangerouslyBypassFocusLock = status === 'focus-unlocked';\n\n  return (\n    <ModalContext.Provider value={{ labelId, onDismiss }}>\n      {transition.map(\n        ({ item, key, props: styles }) =>\n          item && (\n            <AnimatedDialogOverlay\n              key={key}\n              as=\"div\"\n              onDismiss={onDismiss}\n              dangerouslyBypassFocusLock={dangerouslyBypassFocusLock}\n              style={{\n                ...removePropertyPrefixes('overlay', styles),\n                ...overlayStyle\n              }}\n              className={`ModalOverlay ${overlayClassName}`}\n              {...otherOverlayProps}\n            >\n              <AnimatedDialogContent\n                as=\"div\"\n                style={{\n                  ...removePropertyPrefixes('content', styles),\n                  ...contentStyle\n                }}\n                className={`ModalContent ${contentClassName}`}\n                aria-labelledby={labelId}\n                {...otherContentProps}\n              >\n                {children}\n              </AnimatedDialogContent>\n            </AnimatedDialogOverlay>\n          )\n      )}\n    </ModalContext.Provider>\n  );\n}\n\n/** Modal Utility Components */\n\ninterface ModalTitleProps extends HTMLAttributes<Element> {\n  as?: ComponentType | keyof JSX.IntrinsicElements;\n  children: ReactNode;\n}\nexport function ModalTitle({ as: Component = 'h1', id, ...props }: ModalTitleProps) {\n  const { labelId } = useContext(ModalContext);\n  return <Component id={id || labelId} {...props} />;\n}\n\ninterface ModalCloseTargetProps {\n  children: ReactNode;\n}\nexport function ModalCloseTarget({ children }: ModalCloseTargetProps) {\n  const { onDismiss } = useContext(ModalContext);\n  return (\n    <>\n      {Children.map(children, child => {\n        if (isValidElement(child)) {\n          const onClick = (event: React.SyntheticEvent) => {\n            if (onDismiss) onDismiss(event);\n            if (child.props.onClick) child.props.onClick(event);\n          };\n          return cloneElement(child, { onClick });\n        }\n        return child;\n      })}\n    </>\n  );\n}\n\n/** Pre-built Custom Modals */\n\nexport function CenterModal({ overlayProps, contentProps, ...props }: BaseModalProps) {\n  return (\n    <BaseModal\n      overlayProps={{ ...overlayProps, className: 'ModalOverlay--center ' + overlayProps?.className ?? '' }}\n      contentProps={{ ...contentProps, className: 'CenterModal ' + contentProps?.className ?? '' }}\n      {...props}\n    />\n  );\n}\n\nexport function BottomModal({ overlayProps, contentProps, ...props }: BaseModalProps) {\n  return (\n    <BaseModal\n      overlayProps={{ ...overlayProps, className: 'ModalOverlay--bottom ' + overlayProps?.className ?? '' }}\n      contentProps={{ ...contentProps, className: 'BottomModal ' + contentProps?.className ?? '' }}\n      contentTransition={{\n        initial: { transform: 'translateY(100%)' },\n        from: { transform: 'translateY(100%)' },\n        enter: { transform: 'translateY(0%)' },\n        leave: { transform: 'translateY(100%)' }\n      }}\n      {...props}\n    />\n  );\n}\n\ninterface ExpandModalProps extends BaseModalProps {\n  x?: number;\n  y?: number;\n}\nexport function ExpandModal({ overlayProps, contentProps, x = 50, y = 50, ...props }: ExpandModalProps) {\n  return (\n    <BaseModal\n      overlayProps={{ ...overlayProps, className: 'ExpandModal__overlay ' + overlayProps?.className }}\n      contentTransition={{\n        from: { clipPath: `circle(0% at ${x}% ${y}%)` },\n        enter: { clipPath: `circle(100% at ${x}% ${y}%)` },\n        leave: { clipPath: `circle(0% at ${x}% ${y}%)` }\n      }}\n      contentProps={{\n        ...contentProps,\n        className: 'ExpandModal ' + contentProps?.className ?? ''\n      }}\n      {...props}\n    />\n  );\n}\n"],"names":["_jsx"],"mappings":"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"}