{"version":3,"file":"index.umd.js","sources":["../src/custom-properties.ts","../src/index.tsx"],"sourcesContent":["import { css, get, Theme, __internalGetUseRootStyles } from '@theme-ui/css'\n\nconst toVarName = (key: string) => `--theme-ui-${key.replace('-__default', '')}`\nconst toVarValue = (key: string) => `var(${toVarName(key)})`\n\nconst join = (...args: (string | undefined)[]) => args.filter(Boolean).join('-')\n\nconst numberScales = {\n  fontWeights: true,\n  lineHeights: true,\n}\nconst reservedKeys = {\n  useCustomProperties: true,\n  initialColorModeName: true,\n  printColorModeName: true,\n  initialColorMode: true,\n  useLocalStorage: true,\n}\n\nconst toPixel = (key: string, value: string | number) => {\n  if (typeof value !== 'number') return value\n  if (numberScales[key as keyof typeof numberScales]) return value\n  return value + 'px'\n}\n\n// convert theme values to custom properties\nexport const toCustomProperties = (\n  obj: Record<string, any> | undefined,\n  parent?: string,\n  themeKey?: string\n) => {\n  const next: Record<string, any> = Array.isArray(obj) ? [] : {}\n\n  for (let key in obj) {\n    const value = obj[key]\n    const name = join(parent, key)\n    if (value && typeof value === 'object') {\n      next[key] = toCustomProperties(value, name, key)\n      continue\n    }\n    if (reservedKeys[key as keyof typeof reservedKeys]) {\n      next[key] = value\n      continue\n    }\n    const val = toPixel(themeKey || key, value)\n    next[key] = toVarValue(name)\n  }\n\n  return next\n}\n\nexport const objectToVars = (parent: string, obj: Record<string, any>) => {\n  let vars: Record<string, object> = {}\n  for (let key in obj) {\n    if (key === 'modes') continue\n    const name = join(parent, key)\n    const value = obj[key]\n    if (value && typeof value === 'object') {\n      vars = {\n        ...vars,\n        ...objectToVars(name, value),\n      }\n    } else {\n      vars[toVarName(name)] = value\n    }\n  }\n  return vars\n}\n\n// create root styles for color modes\nexport const createColorStyles = (theme: Theme = {}) => {\n  const rootStyles = __internalGetUseRootStyles(theme)\n  const colors = theme.rawColors || theme.colors\n\n  if (!colors || rootStyles.rootStyles === false) return {}\n  if (theme.useCustomProperties === false) {\n    return css({\n      [rootStyles.scope]: {\n        color: 'text',\n        bg: 'background',\n      },\n    })(theme)\n  }\n  const { initialColorModeName, printColorModeName } = theme\n  const modes = colors.modes || {}\n  const styles = objectToVars('colors', colors)\n\n  Object.keys(modes).forEach((mode) => {\n    const key = `&.theme-ui-${mode}`\n    styles[key] = objectToVars('colors', modes[mode])\n  })\n\n  if (printColorModeName) {\n    const mode =\n      printColorModeName === 'initial' ||\n      printColorModeName === initialColorModeName\n        ? colors\n        : modes[printColorModeName]\n    styles['@media print'] = objectToVars('colors', mode)\n  }\n  const colorToVarValue = (color: string) => toVarValue(`colors-${color}`)\n\n  return css({\n    [rootStyles.scope]: {\n      ...styles,\n      color: colorToVarValue('text'),\n      bg: colorToVarValue('background'),\n    },\n  })(theme)\n}\n","import React, { Dispatch, useEffect, useState, SetStateAction } from 'react'\nimport {\n  jsx,\n  useThemeUI,\n  merge,\n  __ThemeUIInternalBaseThemeProvider,\n} from '@theme-ui/core'\nimport { get, Theme, __internalGetUseRootStyles } from '@theme-ui/css'\nimport { Global } from '@emotion/react'\n\nimport { toCustomProperties, createColorStyles } from './custom-properties'\n\nconst STORAGE_KEY = 'theme-ui-color-mode'\n\ndeclare module '@theme-ui/core' {\n  export interface ThemeUIContextValue {\n    colorMode?: string\n    setColorMode?: (colorMode: SetStateAction<string | undefined>) => void\n  }\n}\n\nconst storage = {\n  get: () => {\n    try {\n      return window.localStorage.getItem(STORAGE_KEY)\n    } catch (e) {\n      console.warn(\n        'localStorage is disabled and color mode might not work as expected.',\n        'Please check your Site Settings.',\n        e\n      )\n    }\n  },\n  set: (value: string) => {\n    try {\n      window.localStorage.setItem(STORAGE_KEY, value)\n    } catch (e) {\n      console.warn(\n        'localStorage is disabled and color mode might not work as expected.',\n        'Please check your Site Settings.',\n        e\n      )\n    }\n  },\n}\n\nconst getPreferredColorScheme = (): 'dark' | 'light' | null => {\n  if (typeof window !== 'undefined' && window.matchMedia) {\n    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n      return 'dark'\n    }\n    if (window.matchMedia('(prefers-color-scheme: light)').matches) {\n      return 'light'\n    }\n  }\n  return null\n}\n\nconst getModeFromClass = (): string | undefined => {\n  let mode: string | undefined\n  if (typeof document !== 'undefined') {\n    document.documentElement.classList.forEach((className) => {\n      if (className.startsWith('theme-ui-')) {\n        mode = className.replace('theme-ui-', '')\n      }\n    })\n  }\n  return mode\n}\n\nconst useColorModeState = (theme: Theme = {}) => {\n  let [mode, setMode] = useState(() => {\n    const modeFromClass = getModeFromClass()\n    if (modeFromClass) {\n      return modeFromClass\n    }\n\n    const preferredMode =\n      theme.useColorSchemeMediaQuery !== false && getPreferredColorScheme()\n\n    return preferredMode || theme.initialColorModeName\n  })\n\n  // on first render, we read the color mode from localStorage and\n  // clear the class on document element body\n  useEffect(() => {\n    const stored = theme.useLocalStorage !== false && storage.get()\n\n    if (typeof document !== 'undefined') {\n      document.documentElement.classList.remove('theme-ui-' + stored)\n      document.body.classList.remove('theme-ui-' + stored)\n    }\n\n    if (stored && stored !== mode) {\n      mode = stored\n      setMode(stored)\n    }\n  }, [])\n\n  // when mode changes, we save it to localStorage\n  React.useEffect(() => {\n    if (mode && theme.useLocalStorage !== false) {\n      storage.set(mode)\n    }\n  }, [mode])\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (\n      theme.colors &&\n      theme.colors.modes &&\n      theme.initialColorModeName &&\n      Object.keys(theme.colors.modes).indexOf(theme.initialColorModeName) > -1\n    ) {\n      console.warn(\n        'The `initialColorModeName` value should be a unique name' +\n          ' and cannot reference a key in `theme.colors.modes`.'\n      )\n    }\n  }\n\n  return [mode, setMode] as const\n}\n\nexport function useColorMode<T extends string = string>(): [\n  T,\n  Dispatch<SetStateAction<T>>\n] {\n  const { colorMode, setColorMode } = useThemeUI()\n\n  if (typeof setColorMode !== 'function') {\n    throw new Error(`[useColorMode] requires the ColorModeProvider component`)\n  }\n\n  // We're allowing the user to specify a narrower type for its color mode name.\n  return ([colorMode, setColorMode] as unknown) as [\n    T,\n    Dispatch<SetStateAction<T>>\n  ]\n}\n\nconst applyColorMode = (theme: Theme, mode: string | undefined): Theme => {\n  if (!mode) return { ...theme }\n  const modes = get(theme, 'colors.modes', {})\n  return merge.all({}, theme, {\n    colors: get(modes, mode, {}),\n  })\n}\n\nexport const ColorModeProvider: React.FC = ({ children }) => {\n  const outer = useThemeUI()\n  const [colorMode, setColorMode] = useColorModeState(outer.theme)\n\n  const theme = applyColorMode(outer.theme || {}, colorMode)\n  if (theme.useCustomProperties !== false) {\n    // TODO: This mutation is less than ideal\n    // We could save custom properties to `theme.colorVars`,\n    // But it's infeasible to do this because of how the packages are split.\n    theme.rawColors = theme.colors\n    theme.colors = toCustomProperties(theme.colors, 'colors')\n  }\n\n  const context = {\n    ...outer,\n    theme,\n    colorMode,\n    setColorMode,\n  }\n\n  const isTopLevelColorModeProvider = outer.setColorMode === undefined\n\n  return jsx(\n    __ThemeUIInternalBaseThemeProvider,\n    { context },\n    isTopLevelColorModeProvider\n      ? jsx(Global, {\n          styles: () => {\n            return createColorStyles(theme)\n          },\n        })\n      : jsx('div', {\n          className: 'theme-ui__nested-color-mode-provider',\n          // TODO: This could be refactored a bit.\n          style: createColorStyles(theme)[\n            __internalGetUseRootStyles(theme).scope\n          ],\n        }),\n    children\n  )\n}\n\nconst noflash = `(function() { try {\n  var mode = localStorage.getItem('theme-ui-color-mode');\n  if (!mode) return\n  document.documentElement.classList.add('theme-ui-' + mode);\n  document.body.classList.add('theme-ui-' + mode);\n} catch (e) {} })();`\n\nexport const InitializeColorMode = () =>\n  jsx('script', {\n    key: 'theme-ui-no-flash',\n    dangerouslySetInnerHTML: {\n      __html: noflash,\n    },\n  })\n"],"names":["toVarName","key","replace","toVarValue","join","filter","Boolean","reservedKeys","useCustomProperties","initialColorModeName","printColorModeName","initialColorMode","useLocalStorage","toCustomProperties","obj","parent","themeKey","next","Array","isArray","value","name","objectToVars","vars","createColorStyles","theme","rootStyles","__internalGetUseRootStyles","colors","rawColors","css","scope","color","bg","modes","styles","Object","keys","forEach","mode","colorToVarValue","STORAGE_KEY","storage","get","window","localStorage","getItem","e","console","warn","set","setItem","getPreferredColorScheme","matchMedia","matches","getModeFromClass","document","documentElement","classList","className","startsWith","useColorModeState","useState","modeFromClass","preferredMode","useColorSchemeMediaQuery","setMode","useEffect","stored","remove","body","React","process","env","NODE_ENV","indexOf","useColorMode","useThemeUI","colorMode","setColorMode","Error","applyColorMode","merge","all","ColorModeProvider","children","outer","context","isTopLevelColorModeProvider","undefined","jsx","__ThemeUIInternalBaseThemeProvider","Global","style","noflash","InitializeColorMode","dangerouslySetInnerHTML","__html"],"mappings":"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"}