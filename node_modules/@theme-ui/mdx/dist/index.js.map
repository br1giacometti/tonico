{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import { jsx, IntrinsicSxElements } from '@theme-ui/core'\nimport { css, get, Theme } from '@theme-ui/css'\nimport {\n  ComponentType,\n  FC,\n  ReactNode,\n  DetailedHTMLProps,\n  HTMLAttributes,\n  ElementType,\n  ComponentProps,\n  createElement,\n  useEffect,\n} from 'react'\nimport styled, { StyledComponent } from '@emotion/styled'\nimport { MDXProvider as _MDXProvider, useMDXComponents } from '@mdx-js/react'\n\ntype MDXProviderComponentsKnownKeys = {\n  [key in keyof IntrinsicSxElements]?: ComponentType<any> | string\n}\nexport interface MDXProviderComponents extends MDXProviderComponentsKnownKeys {\n  [key: string]: ComponentType<any> | string | undefined\n}\nexport type MdxAliases = {\n  [key in keyof IntrinsicSxElements]: keyof JSX.IntrinsicElements\n}\n\nexport type MdxAliasesKeys = 'inlineCode' | 'thematicBreak' | 'root'\n\nexport type ThemedProps = {\n  theme: Theme\n}\n\nexport interface MdxProviderProps {\n  components?: MDXProviderComponents\n  children: ReactNode\n}\n\n// mdx components\nconst tags: Array<keyof IntrinsicSxElements> = [\n  'p',\n  'b',\n  'i',\n  'a',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'img',\n  'pre',\n  'code',\n  'ol',\n  'ul',\n  'li',\n  'blockquote',\n  'hr',\n  'em',\n  'table',\n  'tr',\n  'th',\n  'td',\n  'em',\n  'strong',\n  'del',\n  // mdx\n  'inlineCode',\n  'thematicBreak',\n  // other\n  'div',\n  // theme-ui\n  'root',\n]\n\nconst aliases = {\n  inlineCode: 'code',\n  thematicBreak: 'hr',\n  root: 'div',\n} as const\n\ntype Aliases = typeof aliases\nconst isAlias = (x: string): x is keyof Aliases => x in aliases\n\nexport type ThemedComponentName =\n  | keyof IntrinsicSxElements\n  | keyof JSX.IntrinsicElements\n\nconst alias = (n: ThemedComponentName): keyof JSX.IntrinsicElements =>\n  isAlias(n) ? aliases[n] : n\n\nconst propOverrides: {\n  [key in Partial<ThemedComponentName>]?: Record<string, string>\n} = {\n  th: {\n    align: 'textAlign',\n  },\n  td: {\n    align: 'textAlign',\n  },\n}\nexport const themed = (key: ThemedComponentName) => ({\n  theme,\n  ...rest\n}: ThemedProps) => {\n  const propsStyle = propOverrides[key]\n\n  const extraStyles = propsStyle\n    ? Object.keys(rest)\n        .filter((prop) => propsStyle[prop] !== undefined)\n        .reduce(\n          (acc, prop) => ({\n            ...acc,\n            [propsStyle[prop]]: (rest as Record<string, string>)[prop],\n          }),\n          {}\n        )\n    : undefined\n  return css({ ...get(theme, `styles.${key}`), ...extraStyles })(theme)\n}\n\n// opt out of typechecking whenever `as` prop is used\ninterface AnyComponentProps extends JSX.IntrinsicAttributes {\n  [key: string]: unknown\n}\n\nexport type WithPoorAsProp<\n  Props,\n  As extends ElementType | undefined = undefined\n> = {\n  as?: As\n} & (undefined extends As\n  ? As extends undefined\n    ? Props\n    : AnyComponentProps\n  : AnyComponentProps)\n\nexport interface ThemedComponent<Name extends ElementType> {\n  <As extends ElementType | undefined = undefined>(\n    props: WithPoorAsProp<ComponentProps<Name>, As>\n  ): JSX.Element\n}\n\nexport type ThemedComponentsDict = {\n  [K in keyof IntrinsicSxElements]: K extends keyof Aliases\n    ? ThemedComponent<Aliases[K]>\n    : K extends keyof JSX.IntrinsicElements\n    ? ThemedComponent<K>\n    : never\n}\n\ntype ThemedDiv = StyledComponent<\n  DetailedHTMLProps<HTMLAttributes<HTMLDivElement>, HTMLDivElement>,\n  ThemedProps,\n  Theme\n>\n\nexport const Themed: ThemedDiv & ThemedComponentsDict = styled('div')(\n  themed('div')\n) as ThemedDiv & ThemedComponentsDict\n\n/**\n * @deprecated since 0.6.0.\n *\n * `Styled` was renamed to `Themed` to avoid confusion with styled components.\n */\nexport const Styled: ThemedDiv & ThemedComponentsDict = styled('div')(\n  themed('div')\n) as ThemedDiv & ThemedComponentsDict\n\nconst warnStyled = (tag: keyof IntrinsicSxElements): FC => (props) => {\n  useEffect(() => {\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn(\n        '[theme-ui] The Styled component from \"@theme-ui/mdx\" is deprecated and will be removed in a future version. It has been renamed to Themed with the same API.'\n      )\n    }\n  }, [])\n  return createElement(alias(tag), props)\n}\n\nexport const components = {} as ThemedComponentsDict\n\ntags.forEach((tag) => {\n  // fixme?\n  components[tag] = styled(alias(tag))(themed(tag)) as any\n  Themed[tag] = components[tag] as any\n\n  Styled[tag] = styled(warnStyled(tag))(themed(tag)) as any\n})\n\nconst createComponents = (comps: MDXProviderComponents) => {\n  const next = { ...components }\n\n  const componentKeys = Object.keys(comps) as Array<keyof IntrinsicSxElements>\n\n  componentKeys.forEach((key) => {\n    ;(next[key] as ThemedComponentsDict[typeof key]) = styled<any>(comps[key])(\n      themed(key)\n    ) as ThemedComponentsDict[typeof key]\n  })\n  return next\n}\n\nexport const MDXProvider: FC<MdxProviderProps> = ({ components, children }) => {\n  const outer = useMDXComponents() as MDXProviderComponents\n\n  return jsx(_MDXProvider, {\n    components: createComponents({ ...outer, ...components }),\n    children,\n  })\n}\n"],"names":["tags","aliases","inlineCode","thematicBreak","root","isAlias","x","alias","n","propOverrides","th","align","td","themed","key","theme","rest","propsStyle","extraStyles","Object","keys","filter","prop","undefined","reduce","acc","css","get","Themed","styled","Styled","warnStyled","tag","props","useEffect","process","env","NODE_ENV","console","warn","createElement","components","forEach","createComponents","comps","next","componentKeys","MDXProvider","children","outer","useMDXComponents","jsx","_MDXProvider"],"mappings":"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"}