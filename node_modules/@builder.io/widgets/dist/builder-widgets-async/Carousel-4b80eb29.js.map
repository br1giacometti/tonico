{"version":3,"file":"Carousel-4b80eb29.js","sources":["../../src/components/Carousel.tsx"],"sourcesContent":["import {\n  Builder,\n  BuilderAsyncRequestsContext,\n  BuilderBlockComponent,\n  BuilderBlocks,\n  BuilderElement,\n  BuilderStoreContext,\n  stringToFunction,\n} from '@builder.io/react';\nimport * as React from 'react';\nimport Slider, { ResponsiveObject, Settings } from 'react-slick';\n\ntype BuilderBlockType = BuilderElement;\n\ninterface CarouselProps {\n  slides: Array<\n    React.ReactNode | { content: BuilderBlockType[] } /* BuilderBlock <- export this type */\n  >;\n  builderBlock: BuilderBlockType;\n  nextButton?: BuilderBlockType[];\n  prevButton?: BuilderBlockType[];\n  autoplay?: boolean;\n  autoplaySpeed?: number;\n  hideDots?: boolean;\n  useChildrenForSlides?: boolean;\n  slickProps?: Settings;\n  responsive?: ResponsiveObject[];\n}\n\n// TODO: change to slick grid\nexport class CarouselComponent extends React.Component<CarouselProps> {\n  divRef: HTMLElement | null = null;\n  sliderRef: Slider | null = null;\n\n  private _errors?: Error[];\n  private _logs?: string[];\n\n  componentDidMount() {\n    setTimeout(() => {\n      if (this.divRef) {\n        this.divRef.dispatchEvent(\n          new CustomEvent('builder:carousel:load', {\n            bubbles: true,\n            cancelable: false,\n            detail: {\n              block: this.props.builderBlock,\n              carousel: this.sliderRef,\n            },\n          })\n        );\n      }\n    });\n  }\n\n  render() {\n    let slides = this.props.slides;\n\n    if (slides && !Builder.isBrowser) {\n      slides = slides.slice(0, 1);\n    }\n\n    return (\n      <BuilderAsyncRequestsContext.Consumer>\n        {value => {\n          this._errors = value && value.errors;\n          this._logs = value && value.logs;\n\n          return (\n            <BuilderStoreContext.Consumer>\n              {state => (\n                <div ref={ref => (this.divRef = ref)} className=\"builder-carousel\">\n                  {/* Strange encoding issue workaround... */}\n                  {Builder.isServer ? (\n                    <style\n                      type=\"text/css\"\n                      dangerouslySetInnerHTML={{ __html: slickStyles }}\n                    ></style>\n                  ) : (\n                    <style type=\"text/css\">{slickStyles}</style>\n                  )}\n                  <Slider\n                    responsive={this.props.responsive}\n                    ref={ref => (this.sliderRef = ref)}\n                    afterChange={slide => {\n                      // TODO; callbacks\n                      if (this.divRef) {\n                        this.divRef.dispatchEvent(\n                          new CustomEvent('builder:carousel:change', {\n                            bubbles: true,\n                            cancelable: false,\n                            detail: {\n                              slide,\n                              block: this.props.builderBlock,\n                              carousel: this.sliderRef,\n                            },\n                          })\n                        );\n                      }\n                    }}\n                    autoplay={this.props.autoplay}\n                    autoplaySpeed={\n                      this.props.autoplaySpeed ? this.props.autoplaySpeed * 1000 : undefined\n                    }\n                    dots={!this.props.hideDots}\n                    // TODO: on change emit event on element?\n                    // renderBottomCenterControls={this.props.hideDots ? () => null : undefined}\n\n                    // OOF!!\n                    nextArrow={\n                      <div>\n                        <BuilderBlocks\n                          parentElementId={this.props.builderBlock.id}\n                          dataPath=\"component.options.prevButton\"\n                          blocks={this.props.prevButton}\n                        />\n                      </div>\n                    }\n                    // OOF!!\n                    prevArrow={\n                      <div>\n                        <BuilderBlocks\n                          parentElementId={this.props.builderBlock.id}\n                          dataPath=\"component.options.nextButton\"\n                          blocks={this.props.nextButton}\n                        />\n                      </div>\n                    }\n                    {...this.props.slickProps}\n                  >\n                    {/* todo: children.forEach hmm insert block inside */}\n                    {this.props.useChildrenForSlides\n                      ? this.props.builderBlock &&\n                        this.props.builderBlock.children &&\n                        this.props.builderBlock.children.map(\n                          (block: BuilderElement, index: number) => {\n                            if (block.repeat && block.repeat.collection) {\n                              const collectionPath = block.repeat.collection;\n                              const collectionName = (collectionPath || '')\n                                .split(/\\.\\w+\\(/)[0]\n                                .trim()\n                                .split('.')\n                                .pop();\n                              const itemName =\n                                block.repeat.itemName ||\n                                (collectionName ? collectionName + 'Item' : 'item');\n\n                              let array: any[] | void = stringToFunction(\n                                collectionPath,\n                                true,\n                                this._errors,\n                                this._logs\n                              )(state.state);\n\n                              if (Array.isArray(array)) {\n                                if (!Builder.isBrowser) {\n                                  array = array.slice(0, 1);\n                                }\n\n                                return array.map((data, index) => {\n                                  // TODO: Builder state produce the data\n                                  const childState = {\n                                    ...state.state,\n                                    $index: index,\n                                    $item: data,\n                                    [itemName]: data,\n                                  };\n\n                                  return (\n                                    <BuilderStoreContext.Provider\n                                      key={block.id}\n                                      value={{ ...state, state: childState } as any}\n                                    >\n                                      <BuilderBlockComponent\n                                        block={{\n                                          ...block,\n                                          repeat: null,\n                                        }}\n                                        index={index}\n                                        child={true} /* TODO: fieldname? */\n                                      />\n                                    </BuilderStoreContext.Provider>\n                                  );\n                                });\n                              }\n                            }\n                            return (\n                              <BuilderBlockComponent\n                                key={block.id}\n                                block={block}\n                                index={index}\n                                child={true} /* TODO: fieldname? */\n                              />\n                            );\n                          }\n                        )\n                      : this.props.slides &&\n                        this.props.slides.map((slide, index) => (\n                          // TODO: how make react compatible with plain react components\n                          // slides: <Foo><Bar> <- builder blocks if passed react nodes as blocks just forward them\n                          <BuilderBlocks\n                            key={index}\n                            parentElementId={this.props.builderBlock && this.props.builderBlock.id}\n                            dataPath={`component.options.slides.${index}.content`}\n                            child\n                            blocks={(slide as any).content || slide}\n                          />\n                        ))}\n                  </Slider>\n                </div>\n              )}\n            </BuilderStoreContext.Consumer>\n          );\n        }}\n      </BuilderAsyncRequestsContext.Consumer>\n    );\n  }\n}\n\nconst slickStyles = `@charset 'UTF-8';\n  .slick-list,.slick-slider,.slick-track{position:relative;display:block}.slick-loading .slick-slide,.slick-loading .slick-track{visibility:hidden}.slick-slider{box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-touch-callout:none;-khtml-user-select:none;-ms-touch-action:pan-y;touch-action:pan-y;-webkit-tap-highlight-color:transparent}.slick-list{overflow:hidden;margin:0;padding:0}.slick-list:focus{outline:0}.slick-list.dragging{cursor:pointer;cursor:hand}.slick-slider .slick-list,.slick-slider .slick-track{-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);-o-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.slick-track{top:0;left:0}.slick-track:after,.slick-track:before{display:table;content:''}.slick-track:after{clear:both}.slick-slide{display:none;float:left;height:auto;min-height:1px}[dir=rtl] .slick-slide{float:right}.slick-slide img{display:block}.slick-slide.slick-loading img{display:none}.slick-slide.dragging img{pointer-events:none}.slick-initialized .slick-slide{display:block}.slick-vertical .slick-slide{display:block;height:auto;border:1px solid transparent}.slick-arrow.slick-hidden{display:none}\n  .slick-dots,.slick-next,.slick-prev{position:absolute;display:block;padding:0}.slick-dots li button:before,.slick-next:before,.slick-prev:before{font-family:slick;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.slick-loading .slick-list{background:url(ajax-loader.gif) center center no-repeat #fff}@font-face{font-display:swap;font-family:slick;font-weight:400;font-style:normal;src:url(https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/fonts/slick.eot);src:local(\"slick\"),url(https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/fonts/slick.eot?#iefix) format('embedded-opentype'),url(https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/fonts/slick.woff) format('woff'),url(https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/fonts/slick.ttf) format('truetype'),url(https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/fonts/slick.svg#slick) format('svg')}.slick-next,.slick-prev{font-size:0;line-height:0;top:50%;width:20px;height:20px;-webkit-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);cursor:pointer;color:transparent;border:none;outline:0;background:0 0}.slick-next:focus,.slick-next:hover,.slick-prev:focus,.slick-prev:hover{color:transparent;outline:0;background:0 0}.slick-next:focus:before,.slick-next:hover:before,.slick-prev:focus:before,.slick-prev:hover:before{opacity:1}.slick-next.slick-disabled:before,.slick-prev.slick-disabled:before{opacity:.25}.slick-next:before,.slick-prev:before{font-size:20px;line-height:1;opacity:.75;color:#fff}.slick-prev{left:-25px}[dir=rtl] .slick-prev{right:-25px;left:auto}.slick-prev:before{content:''}.slick-next:before,[dir=rtl] .slick-prev:before{content:''}.slick-next{right:-25px}[dir=rtl] .slick-next{right:auto;left:-25px}[dir=rtl] .slick-next:before{content:'•'}.slick-dotted.slick-slider{margin-bottom:30px}.slick-dots{bottom:-25px;width:100%;margin:0;list-style:none;text-align:center}.slick-dots li{position:relative;display:inline-block;width:20px;height:20px;margin:0 5px;padding:0;cursor:pointer}.slick-dots li button{font-size:0;line-height:0;display:block;width:20px;height:20px;padding:5px;cursor:pointer;color:transparent;border:0;outline:0;background:0 0}.slick-dots li button:focus,.slick-dots li button:hover{outline:0}.slick-dots li button:focus:before,.slick-dots li button:hover:before{opacity:1}.slick-dots li button:before{font-size:6px;line-height:20px;position:absolute;top:0;left:0;width:20px;height:20px;content:'•';text-align:center;opacity:.25;color:#000}.slick-dots li.slick-active button:before{opacity:.75;color:#000}\n`;\n"],"names":["React.createElement","React.Component"],"mappings":";;;;;AA6BA;;IACuC,qCAA8B;IAArE;QAAA,qEA0LC;QAzLC,YAAM,GAAuB,IAAI,CAAC;QAClC,eAAS,GAAkB,IAAI,CAAC;;KAwLjC;IAnLC,6CAAiB,GAAjB;QAAA,iBAeC;QAdC,UAAU,CAAC;YACT,IAAI,KAAI,CAAC,MAAM,EAAE;gBACf,KAAI,CAAC,MAAM,CAAC,aAAa,CACvB,IAAI,WAAW,CAAC,uBAAuB,EAAE;oBACvC,OAAO,EAAE,IAAI;oBACb,UAAU,EAAE,KAAK;oBACjB,MAAM,EAAE;wBACN,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,YAAY;wBAC9B,QAAQ,EAAE,KAAI,CAAC,SAAS;qBACzB;iBACF,CAAC,CACH,CAAC;aACH;SACF,CAAC,CAAC;KACJ;IAED,kCAAM,GAAN;QAAA,iBAiKC;QAhKC,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;QAE/B,IAAI,MAAM,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;YAChC,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;SAC7B;QAED,QACEA,cAAC,2BAA2B,CAAC,QAAQ,QAClC,UAAA,KAAK;YACJ,KAAI,CAAC,OAAO,GAAG,KAAK,IAAI,KAAK,CAAC,MAAM,CAAC;YACrC,KAAI,CAAC,KAAK,GAAG,KAAK,IAAI,KAAK,CAAC,IAAI,CAAC;YAEjC,QACEA,cAAC,mBAAmB,CAAC,QAAQ,QAC1B,UAAA,KAAK,IAAI,QACRA,uBAAK,GAAG,EAAE,UAAA,GAAG,IAAI,QAAC,KAAI,CAAC,MAAM,GAAG,GAAG,IAAC,EAAE,SAAS,EAAC,kBAAkB;gBAE/D,OAAO,CAAC,QAAQ,IACfA,yBACE,IAAI,EAAC,UAAU,EACf,uBAAuB,EAAE,EAAE,MAAM,EAAE,WAAW,EAAE,GACzC,KAETA,yBAAO,IAAI,EAAC,UAAU,IAAE,WAAW,CAAS,CAC7C;gBACDA,cAAC,MAAM,aACL,UAAU,EAAE,KAAI,CAAC,KAAK,CAAC,UAAU,EACjC,GAAG,EAAE,UAAA,GAAG,IAAI,QAAC,KAAI,CAAC,SAAS,GAAG,GAAG,IAAC,EAClC,WAAW,EAAE,UAAA,KAAK;;wBAEhB,IAAI,KAAI,CAAC,MAAM,EAAE;4BACf,KAAI,CAAC,MAAM,CAAC,aAAa,CACvB,IAAI,WAAW,CAAC,yBAAyB,EAAE;gCACzC,OAAO,EAAE,IAAI;gCACb,UAAU,EAAE,KAAK;gCACjB,MAAM,EAAE;oCACN,KAAK,OAAA;oCACL,KAAK,EAAE,KAAI,CAAC,KAAK,CAAC,YAAY;oCAC9B,QAAQ,EAAE,KAAI,CAAC,SAAS;iCACzB;6BACF,CAAC,CACH,CAAC;yBACH;qBACF,EACD,QAAQ,EAAE,KAAI,CAAC,KAAK,CAAC,QAAQ,EAC7B,aAAa,EACX,KAAI,CAAC,KAAK,CAAC,aAAa,GAAG,KAAI,CAAC,KAAK,CAAC,aAAa,GAAG,IAAI,GAAG,SAAS,EAExE,IAAI,EAAE,CAAC,KAAI,CAAC,KAAK,CAAC,QAAQ;;;;oBAK1B,SAAS,EACPA;wBACEA,cAAC,aAAa,IACZ,eAAe,EAAE,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,EAC3C,QAAQ,EAAC,8BAA8B,EACvC,MAAM,EAAE,KAAI,CAAC,KAAK,CAAC,UAAU,GAC7B,CACE;;oBAGR,SAAS,EACPA;wBACEA,cAAC,aAAa,IACZ,eAAe,EAAE,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,EAC3C,QAAQ,EAAC,8BAA8B,EACvC,MAAM,EAAE,KAAI,CAAC,KAAK,CAAC,UAAU,GAC7B,CACE,IAEJ,KAAI,CAAC,KAAK,CAAC,UAAU,GAGxB,KAAI,CAAC,KAAK,CAAC,oBAAoB;sBAC5B,KAAI,CAAC,KAAK,CAAC,YAAY;wBACvB,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ;wBAChC,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAClC,UAAC,KAAqB,EAAE,KAAa;4BACnC,IAAI,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,UAAU,EAAE;gCAC3C,IAAM,cAAc,GAAG,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC;gCAC/C,IAAM,cAAc,GAAG,CAAC,cAAc,IAAI,EAAE;qCACzC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;qCACnB,IAAI,EAAE;qCACN,KAAK,CAAC,GAAG,CAAC;qCACV,GAAG,EAAE,CAAC;gCACT,IAAM,UAAQ,GACZ,KAAK,CAAC,MAAM,CAAC,QAAQ;qCACpB,cAAc,GAAG,cAAc,GAAG,MAAM,GAAG,MAAM,CAAC,CAAC;gCAEtD,IAAI,KAAK,GAAiB,gBAAgB,CACxC,cAAc,EACd,IAAI,EACJ,KAAI,CAAC,OAAO,EACZ,KAAI,CAAC,KAAK,CACX,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gCAEf,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;oCACxB,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE;wCACtB,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;qCAC3B;oCAED,OAAO,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI,EAAE,KAAK;;;wCAE3B,IAAM,UAAU,yBACX,KAAK,CAAC,KAAK,WACd,MAAM,EAAE,KAAK,EACb,KAAK,EAAE,IAAI,OACV,UAAQ,IAAG,IAAI,MACjB,CAAC;wCAEF,QACEA,cAAC,mBAAmB,CAAC,QAAQ,IAC3B,GAAG,EAAE,KAAK,CAAC,EAAE,EACb,KAAK,EAAE,sBAAK,KAAK,KAAE,KAAK,EAAE,UAAU,GAAS;4CAE7CA,cAAC,qBAAqB,IACpB,KAAK,wBACA,KAAK,KACR,MAAM,EAAE,IAAI,KAEd,KAAK,EAAE,KAAK,EACZ,KAAK,EAAE,IAAI,GACX,CAC2B,EAC/B;qCACH,CAAC,CAAC;iCACJ;6BACF;4BACD,QACEA,cAAC,qBAAqB,IACpB,GAAG,EAAE,KAAK,CAAC,EAAE,EACb,KAAK,EAAE,KAAK,EACZ,KAAK,EAAE,KAAK,EACZ,KAAK,EAAE,IAAI,GACX,EACF;yBACH,CACF;sBACD,KAAI,CAAC,KAAK,CAAC,MAAM;wBACjB,KAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,UAAC,KAAK,EAAE,KAAK,IAAK;;;wBAGtCA,cAAC,aAAa,IACZ,GAAG,EAAE,KAAK,EACV,eAAe,EAAE,KAAI,CAAC,KAAK,CAAC,YAAY,IAAI,KAAI,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,EACtE,QAAQ,EAAE,8BAA4B,KAAK,aAAU,EACrD,KAAK,QACL,MAAM,EAAG,KAAa,CAAC,OAAO,IAAI,KAAK,GACvC,IACH,CAAC,CACC,CACL,IACP,CAC4B,EAC/B;SACH,CACoC,EACvC;KACH;IACH,wBAAC;AAAD,CAAC,CA1LsCC,SAAe,GA0LrD;AAED,IAAM,WAAW,GAAG,g0HAGnB;;;;"}