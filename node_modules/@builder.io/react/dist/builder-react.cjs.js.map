{"version":3,"file":"builder-react.cjs.js","sources":["../src/scripts/init-editing.ts","../src/constants/device-sizes.constant.ts","../src/functions/set.ts","../src/functions/safe-dynamic-require.ts","../src/functions/string-to-function.ts","../src/store/builder-async-requests.ts","../src/store/builder-store.ts","../src/functions/apply-patch-with-mutation.ts","../src/functions/block-to-html-string.ts","../src/components/Link.tsx","../src/components/builder-block.component.tsx","../src/components/builder-blocks.component.tsx","../src/components/no-wrap.tsx","../src/components/variants-provider.component.tsx","../src/components/builder-content.component.tsx","../lib/on-change.js","../src/functions/debonce-next-tick.ts","../src/functions/throttle.ts","../src/store/builder-meta.ts","../src/components/builder-component.component.tsx","../src/decorators/builder-block.decorator.ts","../src/functions/update-metadata.ts","../src/functions/with-builder.ts","../src/functions/with-children.tsx","../src/functions/no-wrap.tsx","../src/blocks/Text.tsx","../src/blocks/Slot.tsx","../src/blocks/Fragment.tsx","../src/blocks/Columns.tsx","../src/blocks/Embed.tsx","../src/blocks/CustomCode.tsx","../src/blocks/Image.tsx","../src/blocks/Video.tsx","../src/blocks/Symbol.tsx","../src/blocks/Button.tsx","../src/blocks/Section.tsx","../src/blocks/StateProvider.tsx","../src/blocks/Router.tsx","../src/functions/get.ts","../src/blocks/forms/Form.tsx","../src/blocks/forms/Input.tsx","../src/blocks/forms/Button.tsx","../src/blocks/forms/Label.tsx","../src/blocks/forms/Select.tsx","../src/blocks/forms/TextArea.tsx","../src/blocks/raw/Img.tsx","../src/blocks/raw/RawText.tsx","../src/builder-react.ts"],"sourcesContent":["import { version } from '../../package.json';\n\nif (typeof window !== 'undefined') {\n  window.parent?.postMessage(\n    {\n      type: 'builder.isReactSdk',\n      data: {\n        value: true,\n        supportsPatchUpdates: 'v3',\n        priorVersion: version,\n      },\n    },\n    '*'\n  );\n}\n","export type Size = 'large' | 'medium' | 'small' | 'xsmall';\nexport const sizeNames: Size[] = ['xsmall', 'small', 'medium', 'large'];\n\n// TODO: put in @builder.io/core\nexport const sizes = {\n  xsmall: {\n    min: 0,\n    default: 0,\n    max: 0,\n  },\n  small: {\n    min: 320,\n    default: 321,\n    max: 640,\n  },\n  medium: {\n    min: 641,\n    default: 642,\n    max: 991,\n  },\n  large: {\n    min: 990,\n    default: 991,\n    max: 1200,\n  },\n  getWidthForSize(size: Size) {\n    return this[size].default;\n  },\n  getSizeForWidth(width: number) {\n    for (const size of sizeNames) {\n      const value = this[size];\n      if (width <= value.max) {\n        return size;\n      }\n    }\n    return 'large';\n  },\n};\n","export const set = (obj: any, _path: string | string[], value: any) => {\n  if (Object(obj) !== obj) {\n    return obj;\n  }\n  const path: string[] = Array.isArray(_path)\n    ? _path\n    : (_path.toString().match(/[^.[\\]]+/g) as string[]);\n\n  path\n    .slice(0, -1)\n    .reduce(\n      (a, c, i) =>\n        Object(a[c]) === a[c]\n          ? a[c]\n          : (a[c] = Math.abs(Number(path[i + 1])) >> 0 === +path[i + 1] ? [] : {}),\n      obj\n    )[path[path.length - 1]] = value;\n  return obj;\n};\n","'use strict';\n\nimport { Builder } from '@builder.io/sdk';\n\n// Allow us to require things dynamically safe from webpack bundling\nexport const safeDynamicRequire: typeof require = Builder.isServer\n  ? eval('require')\n  : ((() => null) as any);\n","import { Builder, builder } from '@builder.io/sdk';\nimport { safeDynamicRequire } from './safe-dynamic-require';\n\nconst fnCache: { [key: string]: BuilderEvanFunction | undefined } = {};\n\ntype BuilderEvanFunction = (\n  state: object,\n  event?: Event | undefined | null,\n  block?: any,\n  builder?: Builder,\n  Device?: any,\n  update?: Function | null,\n  _Builder?: typeof Builder,\n  context?: object\n) => any;\n\nexport const api = (state: any) => builder;\n\nexport function stringToFunction(\n  str: string,\n  expression = true,\n  errors?: Error[],\n  logs?: string[]\n): BuilderEvanFunction {\n  /* TODO: objedct */\n  if (!str || !str.trim()) {\n    return () => undefined;\n  }\n\n  const cacheKey = str + ':' + expression;\n  if (fnCache[cacheKey]) {\n    return fnCache[cacheKey]!;\n  }\n\n  // FIXME: gross hack\n  const useReturn =\n    (expression &&\n      !(str.includes(';') || str.includes(' return ') || str.trim().startsWith('return '))) ||\n    str.trim().startsWith('builder.run');\n  let fn: Function = () => {\n    /* intentionally empty */\n  };\n\n  try {\n    // tslint:disable-next-line:no-function-constructor-with-string-args\n    if (Builder.isBrowser) {\n      // TODO: use strict and eval\n      fn = new Function(\n        'state',\n        'event',\n        'block',\n        'builder',\n        'Device',\n        'update',\n        'Builder',\n        'context',\n        // TODO: remove the with () {} - make a page v3 that doesn't use this\n        // Or only do if can't find state\\s*\\. anywhere hm\n        `\n          var names = [\n            'state',\n            'event',\n            'block',\n            'builder',\n            'Device',\n            'update',\n            'Builder',\n            'context'\n          ];\n          var rootState = state;\n          if (typeof Proxy !== 'undefined') {\n            rootState = new Proxy(rootState, {\n              set: function () {\n                return false;\n              },\n              get: function (target, key) {\n                if (names.includes(key)) {\n                  return undefined;\n                }\n                return target[key];\n              }\n            });\n          }\n          /* Alias */\n          var ctx = context;\n          with (rootState) {\n            ${useReturn ? `return (${str});` : str};\n          }\n        `\n      );\n    }\n  } catch (error) {\n    if (errors) {\n      errors.push(error);\n    }\n    const message = error && error.message;\n    if (message && typeof message === 'string') {\n      if (logs && logs.indexOf(message) === -1) {\n        logs.push(message);\n      }\n    }\n    if (Builder.isBrowser) {\n      console.warn(`Function compile error in ${str}`, error);\n    }\n  }\n\n  const final = (fnCache[cacheKey] = (...args: any[]) => {\n    try {\n      if (Builder.isBrowser) {\n        return fn(...args);\n      } else {\n        // TODO: memoize on server\n        // TODO: use something like this instead https://www.npmjs.com/package/rollup-plugin-strip-blocks\n        // There must be something more widely used?\n        // TODO: regex for between comments instead so can still type check the code... e.g. //SERVER-START ... code ... //SERVER-END\n        // Below is a hack to get certain code to *only* load in the server build, to not screw with\n        // browser bundler's like rollup and webpack. Our rollup plugin strips these comments only\n        // for the server build\n        // TODO: cache these for better performancs with new VmScript\n        // tslint:disable:comment-format\n        const { VM } = safeDynamicRequire('vm2');\n        const [state, event] = args;\n        return new VM({\n          timeout: 100,\n          sandbox: {\n            ...state,\n            ...{ state },\n            ...{ builder: api },\n            event,\n          },\n        }).run(str.replace(/(^|;)return /, '$1'));\n        // tslint:enable:comment-format\n      }\n    } catch (error) {\n      if (Builder.isBrowser) {\n        console.warn(\n          'Builder custom code error:',\n          error.message || error,\n          'in',\n          str,\n          error.stack || error\n        );\n      } else {\n        if (process.env.DEBUG) {\n          console.debug(\n            'Builder custom code error:',\n            error.message || error,\n            'in',\n            str,\n            error.stack || error\n          );\n        }\n      }\n      if (errors) {\n        errors.push(error);\n      }\n    }\n  });\n\n  return final;\n}\n","import React from 'react';\n\nexport interface RequestInfo {\n  promise: Promise<any>;\n  url?: string;\n}\n\nexport type RequestOrPromise = RequestInfo | Promise<any>;\n\nexport const isPromise = (thing: RequestOrPromise): thing is Promise<any> =>\n  typeof (thing as any).then === 'function';\nexport const isRequestInfo = (thing: RequestOrPromise): thing is RequestInfo => !isPromise(thing);\n\nexport const BuilderAsyncRequestsContext = React.createContext({\n  requests: [] as RequestOrPromise[],\n  errors: [] as Error[],\n  logs: [] as string[],\n});\n","import React from 'react';\n\nexport const BuilderStoreContext = React.createContext<BuilderStore>({\n  state: {},\n  rootState: {},\n  content: {},\n  context: {},\n  update: (mutator: (state: any) => any) => null,\n});\n\nexport interface BuilderStore {\n  state: any;\n  rootState: any;\n  content: any;\n  context: any;\n  update: (mutator: (state: any) => any) => any;\n  renderLink?: (props: React.AnchorHTMLAttributes<any>) => React.ReactNode;\n}\n","export const applyPatchWithMinimalMutationChain = (\n  obj: any,\n  patch: { path: string; op: 'add' | 'remove' | 'replace'; value: any },\n  preserveRoot = true\n) => {\n  if (Object(obj) !== obj) {\n    return obj;\n  }\n  const { path, op, value } = patch;\n  const pathArr: string[] = path.split(/\\//);\n  if (pathArr[0] === '') {\n    pathArr.shift();\n  }\n\n  const newObj = preserveRoot ? obj : { ...obj };\n  let objPart = newObj;\n  for (let i = 0; i < pathArr.length; i++) {\n    const isLast = i === pathArr.length - 1;\n    const property = pathArr[i];\n    if (isLast) {\n      if (op === 'replace') {\n        objPart[property] = value;\n      } else if (op === 'add') {\n        const index = Number(property);\n        if (Array.isArray(objPart)) {\n          if (property === '-') {\n            objPart.push(value);\n          } else {\n            objPart.splice(index, 0, value);\n          }\n        } else {\n          objPart[property] = value;\n        }\n      } else if (op === 'remove') {\n        const index = Number(property);\n        if (Array.isArray(objPart)) {\n          objPart.splice(index, 1);\n        } else {\n          delete objPart[property];\n        }\n      }\n    } else {\n      const nextProperty = pathArr[i + 1];\n      const newPart =\n        Object(objPart[property]) === objPart[property]\n          ? objPart[property]\n          : String(Number(nextProperty)) === nextProperty\n          ? []\n          : {};\n      objPart = objPart[property] = Array.isArray(newPart) ? [...newPart] : { ...newPart };\n    }\n  }\n\n  return newObj;\n};\n","import { BuilderElement } from '@builder.io/sdk';\n\nexport const htmlEscape = (str: string) =>\n  str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n\n// TODO: handle self closing tags\n// TODO: how allow components (e.g. react components) in templates?\nexport const blockToHtmlString = (block: BuilderElement): string =>\n  `<${htmlEscape(block.tagName || 'div')} \n    class=\"builder-block ${block.id} ${block.class || ''}\"\n    builder-id=\"${block.id}\"\n  ${Object.keys(block.properties || {})\n    .map(key => `${htmlEscape(key)}=\"${htmlEscape(block.properties![key])}\"`)\n    .join(' ')}\n  >${\n    block?.component?.name === 'Text'\n      ? block.component.options.text\n      : block.children\n      ? block.children.map(item => blockToHtmlString(item)).join('')\n      : ''\n  }</${block.tagName || 'div'}>`.replace(/\\s+/g, ' ');\n","import React from 'react';\nimport { BuilderStoreContext } from '../store/builder-store';\n/**\n * Link component should be used instead of an anchor tag in our components,\n * this is to allow our users to override anchor tags in\n * case they're using a routing Lib that requires using their\n * custom Link component (e.g Next, Gatsby, React Router)\n * <BuilderComponent renderLink=(props) => <myCustomLink {...props} /> />\n */\nexport const Link: React.SFC<React.AnchorHTMLAttributes<HTMLAnchorElement>> = props => (\n  <BuilderStoreContext.Consumer>\n    {context => {\n      if (context.renderLink) {\n        return context.renderLink(props);\n      }\n      return <a {...props} />;\n    }}\n  </BuilderStoreContext.Consumer>\n);\n","/** @jsx jsx */\n\nimport { Builder, builder, BuilderElement, Component } from '@builder.io/sdk';\nimport { ClassNames, jsx } from '@emotion/core';\nimport React from 'react';\nimport { Size, sizeNames, sizes } from '../constants/device-sizes.constant';\nimport { set } from '../functions/set';\nimport { api, stringToFunction } from '../functions/string-to-function';\nimport { BuilderAsyncRequestsContext, RequestOrPromise } from '../store/builder-async-requests';\nimport { BuilderStoreContext } from '../store/builder-store';\nimport { applyPatchWithMinimalMutationChain } from '../functions/apply-patch-with-mutation';\nimport { blockToHtmlString } from '../functions/block-to-html-string';\nimport { Link } from './Link';\n\nconst camelCaseToKebabCase = (str?: string) =>\n  str ? str.replace(/([A-Z])/g, g => `-${g[0].toLowerCase()}`) : '';\n\nconst kebabCaseToCamelCase = (str = '') =>\n  str.replace(/-([a-z])/g, match => match[1].toUpperCase());\n\nconst Device = { desktop: 0, tablet: 1, mobile: 2 };\nconst blocksMap: Record<string, BuilderElement> = {};\n\nconst voidElements = new Set([\n  'area',\n  'base',\n  'br',\n  'col',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'link',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr',\n  'textarea', // In React, we want to treat this as void (no children, otherwise React throws errors)\n]);\n\nconst last = <T extends any>(arr: T[]) => arr[arr.length - 1];\n\nfunction omit(obj: any, values: string[]) {\n  const newObject = Object.assign({}, obj);\n  for (const key of values) {\n    delete newObject[key];\n  }\n  return newObject;\n}\n\nconst cssCase = (property: string) => {\n  if (!property) {\n    return property;\n  }\n\n  let str = camelCaseToKebabCase(property);\n\n  if (property[0] === property[0].toUpperCase()) {\n    str = '-' + str;\n  }\n\n  return str;\n};\n\n// TODO: pull from builer internal utils\nconst fastClone = (obj: object) => JSON.parse(JSON.stringify(obj));\n\n// TODO: share these types in shared\ntype ElementType = any;\n\nexport interface BuilderBlockProps {\n  fieldName?: string;\n  block: BuilderElement;\n  // TODO:\n  // block: BuilderElement\n  child?: boolean;\n  index?: number;\n  size?: Size;\n  emailMode?: boolean;\n  // TODO: use context\n}\n\nfunction capitalize(str: string) {\n  if (!str) {\n    return;\n  }\n  return str[0].toUpperCase() + str.slice(1);\n}\n\ninterface BuilderBlockState {\n  state: any;\n  rootState: any;\n  context: any;\n  update: Function;\n}\n\nexport class BuilderBlock extends React.Component<\n  BuilderBlockProps,\n  { hasError: boolean; updates: number }\n> {\n  private _asyncRequests?: RequestOrPromise[];\n  private _errors?: Error[];\n  private _logs?: string[];\n\n  state = {\n    hasError: false,\n    updates: 0,\n  };\n\n  private privateState: BuilderBlockState = {\n    state: {},\n    rootState: {},\n    context: {},\n    update: () => {\n      /* Intentionally empty */\n    },\n  };\n\n  get store() {\n    return this.privateState;\n  }\n\n  static getDerivedStateFromError(error: any) {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error: any, errorInfo: any) {\n    console.error('Builder block error:', error, errorInfo);\n  }\n\n  // TODO: handle adding return if none provided\n  // TODO: cache/memoize this (globally with LRU?)\n  stringToFunction(str: string, expression = true) {\n    return stringToFunction(str, expression, this._errors, this._logs);\n  }\n\n  get block() {\n    return blocksMap[this.props.block.id!] || this.props.block;\n  }\n\n  get emotionCss() {\n    let initialAnimationStepStyles: any;\n    const { block } = this;\n    if (Builder.isServer) {\n      const animation = block.animations && block.animations[0];\n      if (animation && animation.trigger !== 'hover') {\n        const firstStep = animation && animation.steps && animation.steps[0];\n        const stepStyles = firstStep && firstStep.styles;\n        if (stepStyles) {\n          initialAnimationStepStyles = stepStyles;\n        }\n      }\n    }\n\n    const reversedNames = sizeNames.slice().reverse();\n    const self = this.block;\n    const styles: any = {};\n    if (self.responsiveStyles) {\n      for (const size of reversedNames) {\n        if (size === 'large') {\n          if (!this.props.emailMode) {\n            styles[`&.builder-block`] = Object.assign(\n              {},\n              self.responsiveStyles[size],\n              initialAnimationStepStyles\n            );\n          }\n        } else {\n          styles[`@media only screen and (max-width: ${sizes[size].max}px)`] = {\n            '&.builder-block': self.responsiveStyles[size],\n          };\n        }\n      }\n    }\n\n    const hoverAnimation =\n      block.animations && block.animations.find(item => item.trigger === 'hover');\n    if (hoverAnimation) {\n      styles[':hover'] = hoverAnimation.steps?.[1]?.styles || {};\n      // TODO: if manually has set transition property deal with that\n      // TODO: only include properties explicitly set in the animation\n      // using Object.keys(styles)\n      styles.transition = `all ${hoverAnimation.duration}s ${camelCaseToKebabCase(\n        hoverAnimation.easing\n      )}`;\n      if (hoverAnimation.delay) {\n        styles.transitionDelay = hoverAnimation.delay + 's';\n      }\n    }\n\n    return styles;\n  }\n\n  eval(str: string) {\n    const fn = this.stringToFunction(str);\n    // TODO: only one root instance of this, don't rewrap every time...\n    return fn(\n      this.privateState.state,\n      undefined,\n      this.block,\n      builder,\n      Device,\n      this.privateState.update,\n      Builder,\n      this.privateState.context\n    );\n  }\n\n  componentWillUnmount() {\n    if (Builder.isEditing) {\n      removeEventListener('message', this.onWindowMessage);\n    }\n  }\n\n  onWindowMessage = (event: MessageEvent) => {\n    const message = event.data;\n    if (!message) {\n      return;\n    }\n    switch (message.type) {\n      case 'builder.selectionChange': {\n        const { data } = message;\n        if (!data) {\n          break;\n        }\n        const { selection } = data;\n        const id = this.block && this.block.id;\n        if (id && Array.isArray(selection) && selection.indexOf(id) > -1) {\n          setTimeout(() => {\n            (window as any).$block = this;\n            if (!(window as any).$blocks) {\n              (window as any).$blocks = [];\n            }\n            (window as any).$blocks.push(this);\n          });\n        }\n        break;\n      }\n\n      case 'builder.patchUpdates': {\n        const { data } = message;\n        if (!(data && data.data)) {\n          break;\n        }\n        const patches = data.data[this.block.id!];\n        if (!patches) {\n          return;\n        }\n\n        if (location.href.includes('builder.debug=true')) {\n          this.eval('debugger');\n        }\n        let newBlock = { ...this.block };\n        for (const patch of patches) {\n          // TODO: soehow mark this.block as a new object,\n          // e.g. access it's parent hm. maybe do the listning mutations\n          // on hte parent element not the child (or rather\n          // send the message to the parent)\n          applyPatchWithMinimalMutationChain(newBlock, patch);\n        }\n        blocksMap[this.props.block.id!] = newBlock;\n        this.setState({ updates: this.state.updates + 1 });\n\n        break;\n      }\n    }\n  };\n\n  componentDidMount() {\n    const block = this.block;\n    const animations = block && block.animations;\n\n    if (Builder.isEditing) {\n      addEventListener('message', this.onWindowMessage);\n    }\n\n    // tslint:disable-next-line:comment-format\n    ///REACT15ONLY if (this.ref) { this.ref.setAttribute('builder-id', block.id); }\n\n    if (animations) {\n      const options = {\n        animations: fastClone(animations),\n      };\n\n      // TODO: listen to Builder.editingMode and bind animations when editing\n      // and unbind when not\n      // TODO: apply bindings first\n      if (block.bindings) {\n        for (const key in block.bindings) {\n          if (!key.trim?.()) {\n            continue;\n          }\n\n          if (key.startsWith('animations.')) {\n            // TODO: this needs to run in getElement bc of local state per element for repeats\n            const value = this.stringToFunction(block.bindings[key]);\n            if (value !== undefined) {\n              set(\n                options,\n                key,\n                value(\n                  this.privateState.state,\n                  null,\n                  block,\n                  builder,\n                  null,\n                  null,\n                  Builder,\n                  this.privateState.context\n                )\n              );\n            }\n          }\n        }\n      }\n      Builder.animator.bindAnimations(\n        options.animations\n          .filter((item: any) => item.trigger !== 'hover')\n          .map((animation: any) => ({\n            ...animation,\n            elementId: this.block.id,\n          }))\n      );\n    }\n  }\n\n  // <!-- Builder Blocks --> in comments hmm\n  getElement(index = 0, state = this.privateState.state): React.ReactNode {\n    const { child, fieldName } = this.props;\n    const block = this.block;\n    let TagName: string | typeof Link = (block.tagName || 'div').toLowerCase();\n\n    if (TagName === 'template') {\n      const html = block.children\n        ? block.children.map(item => blockToHtmlString(item)).join(' ')\n        : '';\n      console.debug('template html', html);\n      return (\n        // React has an undesired behavior (for us) for template tags, so we must\n        // turn the contents into a string\n        <template\n          {...block.properties}\n          dangerouslySetInnerHTML={{\n            __html: html,\n          }}\n        />\n      );\n    }\n\n    let InnerComponent: any;\n    const componentName =\n      block.component && (block.component.name || (block.component as any).component);\n    let componentInfo: Component | null = null;\n    if (block.component && !(block.component as any).class) {\n      if (block.component && block.component.tag) {\n        InnerComponent = block.component.tag;\n      } else {\n        componentInfo = Builder.components.find(item => item.name === componentName) || null;\n        if (componentInfo && componentInfo.class) {\n          InnerComponent = componentInfo.class;\n        } else if (componentInfo && componentInfo.tag) {\n          InnerComponent = componentInfo.tag;\n        }\n      }\n    }\n\n    const TextTag: any = 'span';\n\n    let options: any = {\n      // Attributes?\n      ...block.properties,\n      style: {}, // this.styles\n    };\n\n    options = {\n      ...options.properties,\n      ...options,\n    };\n\n    if (block.component) {\n      options.component = fastClone(block.component);\n    }\n\n    // Binding should be properties to href or href?\n    // Manual style editor show bindings\n    // Show if things bound in overlays hmm\n    if (block.bindings) {\n      for (const key in block.bindings) {\n        if (!key.trim?.()) {\n          continue;\n        }\n\n        const value = this.stringToFunction(block.bindings[key]);\n        // TODO: pass block, etc\n        set(\n          options,\n          key,\n          value(state, null, block, api(state), Device, null, Builder, this.privateState.context)\n        );\n      }\n    }\n\n    if (options.hide) {\n      return null;\n    } else {\n      delete options.hide;\n    }\n    // TODO: UI for this\n    if (('show' in options || (block.bindings && block.bindings.show)) && !options.show) {\n      return null;\n    } else {\n      delete options.show;\n    }\n\n    if (block.actions) {\n      for (const key in block.actions) {\n        if (!key.trim?.()) {\n          continue;\n        }\n\n        const value = block.actions[key];\n        options['on' + capitalize(key)] = (event: any) => {\n          let useState = state;\n          if (typeof Proxy !== 'undefined') {\n            useState = new Proxy(state, {\n              set: (obj, prop, value) => {\n                obj[prop] = value;\n                this.privateState.rootState[prop] = value;\n                return true;\n              },\n            });\n          }\n          const fn = this.stringToFunction(value, false);\n          // TODO: only one root instance of this, don't rewrap every time...\n          return fn(\n            useState,\n            event,\n            this.block,\n            builder,\n            Device,\n            this.privateState.update,\n            Builder,\n            this.privateState.context\n          );\n        };\n      }\n    }\n\n    const innerComponentProperties = (options.component || options.options) && {\n      ...options.options,\n      ...(options.component.options || options.component.data),\n    };\n\n    const isVoid = voidElements.has(TagName);\n\n    const noWrap = componentInfo && (componentInfo.fragment || componentInfo.noWrap);\n\n    const styleStr =\n      options.attr?.style || (typeof options.style === 'string' ? options.style : '') || '';\n\n    if (typeof styleStr === 'string') {\n      if (typeof options.style !== 'object') {\n        options.style = {};\n      }\n\n      const styleSplit = styleStr.split(';');\n      for (const pair of styleSplit) {\n        const stylePieces = pair.split(':');\n        if (!stylePieces.length) {\n          return;\n        }\n\n        let [key, value] = stylePieces;\n\n        if (stylePieces.length > 2) {\n          value = stylePieces.slice(1).join(':');\n        }\n\n        options.style[kebabCaseToCamelCase(key)] = value;\n      }\n    }\n\n    const finalOptions: { [key: string]: string } = {\n      ...omit(options, ['class', 'component', 'attr']),\n      [typeof TagName === 'string' && !TagName.includes('-') ? 'className' : 'class']:\n        `builder-block ${this.id}${block.class ? ` ${block.class}` : ''}${\n          block.component && !(['Image', 'Video', 'Banner'].indexOf(componentName) > -1)\n            ? ` builder-has-component`\n            : ''\n        }` +\n        (options.class ? ' ' + options.class : '') +\n        (Builder.isEditing && this.privateState.state._spacer?.parent === block.id\n          ? ' builder-spacer-parent'\n          : ''),\n      key: this.id + index,\n      'builder-id': this.id,\n      // ...(state && state.$index && typeof state.$index === 'number'\n      //   ? {\n      // TODO: ONLY include on repeat!\n      // TODO: what if dymically repeated by another component like tabs... may not work.\n      // need function to provide that right\n      ...(index !== 0 && {\n        'builder-index': index, // String(state.$index)\n      }),\n      //   }\n      // : null)\n    };\n\n    // tslint:disable-next-line:comment-format\n    ///REACT15ONLY finalOptions.className = finalOptions.class\n\n    if (Builder.isIframe) {\n      // TODO: removed bc JS can add styles inline too?\n      (finalOptions as any)['builder-inline-styles'] = !(options.attr && options.attr.style)\n        ? ''\n        : Object.keys(options.style).reduce(\n            (memo, key) => (memo ? `${memo};` : '') + `${cssCase(key)}:${options.style[key]};`,\n            ''\n          );\n    }\n\n    if (\n      (((finalOptions as any).properties && (finalOptions as any).properties.href) ||\n        (finalOptions as any).href) &&\n      TagName === 'div'\n    ) {\n      TagName = 'a';\n    }\n\n    if (TagName === 'a') {\n      TagName = Link;\n    }\n    // const css = this.css\n\n    // const styleTag = css.trim() && (\n    //   <style className=\"builder-style\">\n    //     {(InnerComponent && !isBlock ? `.${this.id} > * { height: 100%; width: 100%; }` : '') +\n    //       this.css}\n    //   </style>\n    // )\n\n    const children = block.children || finalOptions.children || [];\n\n    // TODO: test it out\n    return (\n      <React.Fragment>\n        {/* <InsertSpacer id={block.id!} position=\"before\" /> */}\n        <ClassNames>\n          {({ css, cx }) => {\n            if (!this.props.emailMode) {\n              const addClass = ' ' + css(this.emotionCss);\n              if (finalOptions.class) {\n                finalOptions.class += addClass;\n              }\n              if (finalOptions.className) {\n                finalOptions.className += addClass;\n              }\n            }\n\n            return (\n              <BuilderAsyncRequestsContext.Consumer>\n                {value => {\n                  this._asyncRequests = value && value.requests;\n                  this._errors = value && value.errors;\n                  this._logs = value && value.logs;\n                  return isVoid ? (\n                    <TagName {...finalOptions} />\n                  ) : InnerComponent && (noWrap || this.props.emailMode) ? (\n                    // TODO: pass the class to be easier\n                    // TODO: acceptsChildren option?\n                    <InnerComponent\n                      // Final options maaay be wrong here hm\n                      {...innerComponentProperties}\n                      // should really call this builderAttributes bc people can name a\n                      // componet input \"attributes\"\n                      attributes={finalOptions}\n                      builderBlock={block}\n                      builderState={this.privateState}\n                    />\n                  ) : (\n                    <TagName {...(finalOptions as any)}>\n                      {InnerComponent && (\n                        <InnerComponent\n                          builderState={this.privateState}\n                          builderBlock={block}\n                          {...innerComponentProperties}\n                        />\n                      )}\n                      {(block as any).text || options.text\n                        ? options.text\n                        : !InnerComponent && children && Array.isArray(children) && children.length\n                        ? children.map((block: ElementType, index: number) => (\n                            <BuilderBlock\n                              key={((this.id as string) || '') + index}\n                              block={block}\n                              index={index}\n                              size={this.props.size}\n                              fieldName={this.props.fieldName}\n                              child={this.props.child}\n                              emailMode={this.props.emailMode}\n                            />\n                          ))\n                        : null}\n                    </TagName>\n                  );\n                }}\n              </BuilderAsyncRequestsContext.Consumer>\n            );\n          }}\n        </ClassNames>\n        {/* <InsertSpacer id={block.id!} position=\"after\" /> */}\n      </React.Fragment>\n    );\n  }\n\n  get id() {\n    const { block } = this;\n    if (!block.id!.startsWith('builder')) {\n      return 'builder-' + block.id;\n    }\n    return block.id!;\n  }\n\n  contents(state: BuilderBlockState) {\n    const block = this.block;\n\n    // this.setState(state);\n    this.privateState = state;\n\n    if (block.repeat && block.repeat.collection) {\n      const collectionPath = block.repeat.collection;\n      const collectionName = last((collectionPath || '').trim().split('(')[0].trim().split('.'));\n      const itemName = block.repeat.itemName || (collectionName ? collectionName + 'Item' : 'item');\n      const array = this.stringToFunction(collectionPath)(\n        state.state,\n        null,\n        block,\n        api(state),\n        Device,\n        null,\n        Builder,\n        this.privateState.context\n      );\n      if (Array.isArray(array)) {\n        return array.map((data, index) => {\n          // TODO: Builder state produce the data\n          const childState = {\n            ...state.state,\n            $index: index,\n            $item: data,\n            [itemName]: data,\n            [`$${itemName}Index`]: index,\n          };\n\n          return (\n            <BuilderStoreContext.Provider\n              key={index}\n              value={{ ...state, state: childState } as any}\n            >\n              {this.getElement(index, childState)}\n            </BuilderStoreContext.Provider>\n          );\n        });\n      }\n      return null;\n    }\n\n    return this.getElement();\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <span\n          css={{\n            display: 'inline-block',\n            padding: 5,\n            color: '#999',\n            fontSize: 11,\n            fontStyle: 'italic',\n          }}\n        >\n          Builder block error :( Check console for details\n        </span>\n      );\n    }\n    return (\n      <BuilderStoreContext.Consumer>{value => this.contents(value)}</BuilderStoreContext.Consumer>\n    );\n  }\n}\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\nimport { Builder } from '@builder.io/sdk';\nimport { BuilderBlock } from './builder-block.component';\n// TODO: fetch these for user and send them with same response like graphql\nimport { Size } from '../constants/device-sizes.constant';\n\nexport interface BuilderBlocksProps {\n  fieldName?: string;\n  // TODO: block type (ElementType[])\n  blocks?: any[] | React.ReactNode;\n  child?: boolean;\n  // TODO: use new react context for this to pass window size all the way down\n  size?: Size;\n  style?: React.CSSProperties;\n  parentElementId?: string;\n  parent?: any;\n  dataPath?: string;\n  className?: string;\n  emailMode?: boolean;\n}\n\ninterface BuilderBlocksState {\n  // width: number\n}\n\n// TODO: options to set direciotn\nexport class BuilderBlocks extends React.Component<BuilderBlocksProps, BuilderBlocksState> {\n  get isRoot() {\n    return !this.props.child;\n  }\n\n  get noBlocks() {\n    const { blocks } = this.props;\n    return !(blocks && (blocks as any).length); // TODO: allow react nodes\n  }\n  get path() {\n    const pathPrefix = 'component.options.';\n    let path = this.props.dataPath || '';\n    const thisPrefix = 'this.';\n    if (path.trim()) {\n      if (path.startsWith(thisPrefix)) {\n        path = path.replace(thisPrefix, '');\n      } else if (!path.startsWith(pathPrefix)) {\n        path = pathPrefix + path;\n      }\n    }\n    return path;\n  }\n\n  get parentId() {\n    if (this.props.parentElementId) {\n      return this.props.parentElementId;\n    }\n    return this.props.parent && this.props.parent.id;\n  }\n\n  onClickEmptyBlocks = () => {\n    if (Builder.isIframe && this.noBlocks) {\n      window.parent?.postMessage(\n        {\n          type: 'builder.clickEmptyBlocks',\n          data: {\n            parentElementId: this.parentId,\n            dataPath: this.path,\n          },\n        },\n        '*'\n      );\n    }\n  };\n\n  // <!-- Builder Blocks --> in comments hmm\n  render() {\n    const { blocks } = this.props;\n\n    const TagName = this.props.emailMode ? 'span' : 'div';\n\n    // TODO: how deep check this automatically for mobx... hmmm optional / peer dependency?\n    return (\n      // TODO: component <Stack direction=\"vertical\">\n      // TODO: react.fragment instead?\n      <TagName\n        className={\n          'builder-blocks' +\n          (this.noBlocks ? ' no-blocks' : '') +\n          (this.props.child ? ' builder-blocks-child' : '') +\n          (this.props.className ? ' ' + this.props.className : '')\n        }\n        builder-type=\"blocks\"\n        // TODO: only fi in iframe?\n        builder-path={Builder.isIframe ? this.path : undefined}\n        css={{\n          ...(!this.props.emailMode && {\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'stretch',\n          }),\n          ...this.props.style,\n        }}\n        onClick={() => {\n          if (this.noBlocks) {\n            this.onClickEmptyBlocks();\n          }\n        }}\n      >\n        {/* TODO: if is react node (for react compatibility) render it */}\n        {/* TODO: maybe don't do this to preserve blocks always editable */}\n        {(blocks &&\n          Array.isArray(blocks) &&\n          (blocks as any[]).map((block, index) =>\n            block && block['@type'] === '@builder.io/sdk:Element' ? (\n              <BuilderBlock\n                key={block.id}\n                block={block}\n                index={index}\n                fieldName={this.props.fieldName}\n                child={this.props.child}\n                emailMode={this.props.emailMode}\n              />\n            ) : (\n              block\n            )\n          )) ||\n          blocks}\n      </TagName>\n    );\n  }\n}\n","import React from 'react';\n\nexport const NoWrap = (props: React.ComponentPropsWithoutRef<any>) => props.children;\n","import * as React from 'react';\nimport { builder, Builder, BuilderContent, BuilderContentVariation } from '@builder.io/sdk';\n\nfunction getData(content: BuilderContentVariation) {\n  if (typeof content?.data === 'undefined') {\n    return undefined;\n  }\n\n  const { blocks, blocksString } = content.data;\n  const hasBlocks = Array.isArray(blocks) || typeof blocksString === 'string';\n  const newData: any = {\n    ...content.data,\n    ...(hasBlocks && { blocks: blocks || JSON.parse(blocksString) }),\n  };\n\n  delete newData.blocksString;\n  return newData;\n}\n\nconst variantsScript = (variantsString: string, contentId: string) =>\n  `\n(function() {\n  if (window.builderNoTrack || window.navigator.doNotTrack === '1') {\n    return;\n  }\n\n  var variants = ${variantsString};\n  function removeVariants() {\n    variants.forEach((template) => {\n      document.querySelector('template[data-template-variant-id=\"' + template.id + '\"]').remove();\n    });\n  }\n\n  if (typeof document.createElement(\"template\").content === 'undefined') {\n    removeVariants();\n    return ;\n  }\n\n  function setCookie(name,value,days) {\n    var expires = \"\";\n    if (days) {\n        var date = new Date();\n        date.setTime(date.getTime() + (days*24*60*60*1000));\n        expires = \"; expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + (value || \"\")  + expires + \"; path=/\" + \"; Secure; SameSite=None\";\n  }\n\n  function getCookie(name) {\n    var nameEQ = name + \"=\";\n    var ca = document.cookie.split(';');\n    for(var i=0;i < ca.length;i++) {\n        var c = ca[i];\n        while (c.charAt(0)==' ') c = c.substring(1,c.length);\n        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n    }\n    return null;\n  }\n  var cookieName = 'builder.tests.${contentId}';\n  var variantInCookie = getCookie(cookieName);\n  var availableIDs = variants.map(function(vr) { return vr.id }).concat('${contentId}');\n  var variantId;\n  if (availableIDs.indexOf(variantInCookie) > -1) {\n    variantId = variantInCookie;\n  }\n  if (!variantId) {\n    var n = 0;\n    var set = false;\n    var random = Math.random();\n    for (var i = 0; i < variants.length; i++) {\n      var variant = variants[i];\n      var testRatio = variant.testRatio;\n      n += testRatio;\n      if (random < n) {\n        setCookie(cookieName, variant.id);\n        variantId = variant.id;\n        break;\n      }\n    }\n    if (!variantId) {\n      variantId = \"${contentId}\";\n      setCookie(cookieName, \"${contentId}\");\n    }\n  }\n  if (variantId && variantId !== \"${contentId}\") {\n    var winningTemplate = document.querySelector('template[data-template-variant-id=\"' + variantId + '\"]');\n    if (winningTemplate) {\n      var parentNode = winningTemplate.parentNode;\n      var newParent = parentNode.cloneNode(false);\n      newParent.appendChild(winningTemplate.content.firstChild);\n      parentNode.parentNode.replaceChild(newParent, parentNode);\n    }\n  } else if (variants.length > 0) {\n    removeVariants();\n  }\n})()`.replace(/\\s+/g, ' ');\n\ninterface VariantsProviderProps {\n  initialContent: BuilderContent;\n  children: (variants: BuilderContent[], renderScript?: () => JSX.Element) => JSX.Element;\n}\n\nexport const VariantsProvider: React.SFC<VariantsProviderProps> = ({\n  initialContent,\n  children,\n}) => {\n  if (Builder.isBrowser && !builder.canTrack) {\n    return children([initialContent]);\n  }\n\n  const hasTests = Boolean(Object.keys(initialContent?.variations || {}).length);\n\n  // when it's not isStatic variants are already elected by the sdk\n  if (!hasTests) return children([initialContent]);\n\n  const variants: BuilderContent[] = Object.keys(initialContent.variations!).map(id => ({\n    id,\n    ...initialContent.variations![id],\n    data: getData(initialContent.variations![id]!),\n  }));\n\n  const allVariants = [...variants, initialContent];\n  if (Builder.isServer) {\n    const variantsJson = JSON.stringify(\n      Object.keys(initialContent.variations || {}).map(item => ({\n        id: item,\n        testRatio: initialContent.variations![item]!.testRatio,\n      }))\n    );\n    const renderScript = () => (\n      <script\n        dangerouslySetInnerHTML={{\n          __html: variantsScript(variantsJson, initialContent.id!),\n        }}\n      ></script>\n    );\n\n    // render all variants on the server side\n    return <React.Fragment>{children(allVariants, renderScript)}</React.Fragment>;\n  }\n\n  const cookieName = `builder.tests.${initialContent.id}`;\n\n  let variantId = builder.getCookie(cookieName);\n\n  if (!variantId && Builder.isBrowser) {\n    let n = 0;\n    let set = false;\n    const random = Math.random();\n    for (let i = 0; i < variants.length; i++) {\n      const variant = variants[i];\n      const testRatio = variant.testRatio;\n      n += testRatio!;\n      if (random < n) {\n        builder.setCookie(cookieName, variant.id);\n        variantId = variant.id;\n        break;\n      }\n    }\n  }\n\n  if (!variantId) {\n    // render initial content when no winning variation or on the server\n    variantId = initialContent.id;\n    builder.setCookie(cookieName, variantId);\n  }\n\n  return children([allVariants.find(item => item.id === variantId)!]);\n};\n","import React from 'react';\nimport { builder, Subscription, GetContentOptions, Builder } from '@builder.io/sdk';\nimport { NoWrap } from './no-wrap';\nimport { applyPatchWithMinimalMutationChain } from '../functions/apply-patch-with-mutation';\nimport { VariantsProvider } from './variants-provider.component';\n\nexport type BuilderContentProps<ContentType> = {\n  /**\n   * Callback to run when content is fetched and loaded.\n   */\n  contentLoaded?: (data: any, content: any) => void;\n  /**\n   * Callback to run if an error occurred while fetching content.\n   */\n  contentError?: (error: any) => void;\n  options?: GetContentOptions;\n  children: (content: ContentType, loading?: boolean, fullData?: any) => React.ReactNode;\n  /**\n   * Only render what was explicitly passed in via `content` - don't fetch from\n   * the Builder API.\n   *\n   * @see content\n   */\n  inline?: boolean;\n  /**\n   * @package\n   * @deprecated\n   */\n  dataOnly?: boolean;\n  /**\n   * @package\n   * Pass in a specific builder instance to use instead of the default\n   * singleton.\n   */\n  builder?: Builder;\n  /**\n   * @deprecated use `Builder.isStatic` instead\n   */\n  isStatic?: boolean;\n  /**\n   * Builder content object to use instead of fetching from the API.\n   *\n   * Required if `inline` is set to `true`.\n   */\n  content?: BuilderContent;\n} & ({ model: string } | { modelName: string }); // model and modelName are aliases of the same thing¸\n\n/**\n * When passed content json explicitly it'll calculate a/b tests on the content\n * and pass the winning variation down to the children function. If then content\n * prop was omitted it'll try to fetch matching content from your Builder\n * account based on the default user attributes and model.\n *\n * ## Notes\n *\n * A/B testing will show only the default content if DoNotTrack is enabled.\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/DNT\n */\nexport class BuilderContent<ContentType extends object = any> extends React.Component<\n  BuilderContentProps<ContentType>\n> {\n  ref: HTMLDivElement | null = null;\n\n  get builder() {\n    return this.props.builder || builder;\n  }\n  get name() {\n    const props = this.props;\n\n    if ('model' in props) {\n      return props.model;\n    } else {\n      return props.modelName;\n    }\n  }\n\n  get renderedVairantId() {\n    const id = this.props.isStatic\n      ? this.builder.getCookie(`builder.tests.${this.data?.id}`)\n      : this.data?.variationId;\n    if (id !== null) {\n      return id;\n    }\n  }\n\n  get options() {\n    let options = {\n      ...(this.props.options || ({} as GetContentOptions)),\n    };\n    if (this.props.content && !options.initialContent?.length) {\n      options.initialContent = [this.props.content];\n    }\n\n    return options;\n  }\n\n  get data() {\n    const { data } = this.state;\n\n    return (\n      ((this.props.inline || !Builder.isBrowser || this.firstLoad) &&\n        this.options.initialContent &&\n        this.options.initialContent[0]) ||\n      data\n    );\n  }\n\n  state = {\n    loading: true,\n    data: null as any,\n    updates: 1,\n  };\n\n  onWindowMessage = (event: MessageEvent) => {\n    const message = event.data;\n    if (!message) {\n      return;\n    }\n    switch (message.type) {\n      case 'builder.patchUpdates': {\n        if (this.props.options?.noEditorUpdates) {\n          return;\n        }\n        const { data } = message;\n        if (!(data && data.data)) {\n          break;\n        }\n        const patches = data.data[this.state.data?.id];\n        if (!(patches && patches.length)) {\n          return;\n        }\n\n        if (location.href.includes('builder.debug=true')) {\n          eval('debugger');\n        }\n        for (const patch of patches) {\n          applyPatchWithMinimalMutationChain(this.state.data, patch);\n        }\n        this.setState({\n          updates: this.state.updates + 1,\n          data: this.state.data ? { ...this.state.data } : this.state.data,\n        });\n        if (this.props.contentLoaded) {\n          this.props.contentLoaded(this.state.data.data, this.state.data);\n        }\n\n        break;\n      }\n    }\n  };\n\n  subscriptions = new Subscription();\n\n  firstLoad = true;\n  clicked = false;\n  trackedImpression = false;\n\n  intersectionObserver: IntersectionObserver | null = null;\n\n  // TODO: observe model name for changes\n  componentDidMount() {\n    // Temporary to test metrics diving in with bigquery and heatmaps\n    // this.builder.autoTrack = true;\n    // this.builder.env = 'development';\n    if (!this.props.inline || Builder.isEditing) {\n      this.subscribeToContent();\n    } else if (this.props.inline && this.options?.initialContent?.length) {\n      const contentData = this.options.initialContent[0];\n      // TODO: intersectionobserver like in subscribetocontent - reuse the logic\n      this.builder.trackImpression(contentData.id, this.renderedVairantId, undefined, {\n        content: contentData,\n      });\n    }\n\n    if (Builder.isEditing) {\n      addEventListener('message', this.onWindowMessage);\n    }\n\n    /// REACT15ONLY if (this.ref) { this.ref.setAttribute('builder-model', this.name); }\n  }\n\n  subscribeToContent() {\n    if (this.name !== '_inline') {\n      // TODO:... using targeting...? express.request hmmm\n      this.subscriptions.add(\n        builder.queueGetContent(this.name, this.options).subscribe(\n          matches => {\n            const match = matches && matches[0];\n            this.setState({\n              data: match,\n              loading: false,\n            });\n\n            if (match && this.firstLoad) {\n              this.firstLoad = false;\n              // TODO: autoTrack\n              if (builder.autoTrack && !Builder.isEditing) {\n                let addedObserver = false;\n                if (typeof IntersectionObserver === 'function' && this.ref) {\n                  try {\n                    const observer = (this.intersectionObserver = new IntersectionObserver(\n                      (entries, observer) => {\n                        entries.forEach(entry => {\n                          // In view\n                          if (entry.intersectionRatio > 0 && !this.trackedImpression) {\n                            this.builder.trackImpression(\n                              match.id!,\n                              this.renderedVairantId,\n                              undefined,\n                              {\n                                content: this.data,\n                              }\n                            ),\n                              { content: this.data };\n                            this.trackedImpression = true;\n                            if (this.ref) {\n                              observer.unobserve(this.ref);\n                            }\n                          }\n                        });\n                      }\n                    ));\n\n                    observer.observe(this.ref);\n                    addedObserver = true;\n                  } catch (err) {\n                    console.warn('Could not bind intersection observer');\n                  }\n                }\n                if (!addedObserver) {\n                  this.trackedImpression = true;\n                  this.builder.trackImpression(match.id!, this.renderedVairantId, undefined, {\n                    content: match,\n                  });\n                }\n              }\n            }\n            if (this.props.contentLoaded) {\n              this.props.contentLoaded(match && match.data, match);\n            }\n          },\n          error => {\n            if (this.props.contentError) {\n              this.props.contentError(error);\n              this.setState({\n                loading: false,\n              });\n            }\n          }\n        )\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    if (Builder.isEditing) {\n      removeEventListener('message', this.onWindowMessage);\n    }\n\n    this.subscriptions.unsubscribe();\n    if (this.intersectionObserver && this.ref) {\n      this.intersectionObserver.unobserve(this.ref);\n    }\n  }\n\n  onClick = (reactEvent: React.MouseEvent<HTMLElement>) => {\n    // TODO: viewport scrolling tracking for impression events\n    const event = reactEvent.nativeEvent;\n\n    const content = this.data;\n    if (!content) {\n      return;\n    }\n    if (builder.autoTrack) {\n      this.builder.trackInteraction(content.id, this.renderedVairantId, this.clicked, event, {\n        content,\n      });\n    }\n    if (!this.clicked) {\n      this.clicked = true;\n    }\n  };\n\n  render() {\n    if (this.props.dataOnly) {\n      return null;\n    }\n    const { loading } = this.state;\n\n    const useData = this.data;\n    const TagName = this.props.dataOnly ? NoWrap : 'div';\n\n    if (!this.props.isStatic) {\n      return (\n        <TagName\n          {...(!this.props.dataOnly && {\n            ref: (ref: any) => (this.ref = ref),\n          })}\n          className=\"builder-content\"\n          onClick={this.onClick}\n          builder-content-id={useData?.id}\n          builder-model={this.name}\n        >\n          {this.props.children(useData?.data, this.props.inline ? false : loading, useData)}\n        </TagName>\n      );\n    }\n\n    return (\n      <VariantsProvider initialContent={useData}>\n        {(variants, renderScript) => {\n          return (\n            <React.Fragment>\n              {variants.map((content, index) => {\n                // default Variation is at the end, wrap the rest with template\n                // TODO: IE11 don't support templates\n                const Tag = index === variants.length - 1 ? React.Fragment : 'template';\n                return (\n                  <React.Fragment key={String(content?.id! + index)}>\n                    {Tag !== 'template' && renderScript?.()}\n                    <Tag\n                      key={String(content?.id! + index)}\n                      {...(Tag === 'template' && {\n                        'data-template-variant-id': content?.id,\n                      })}\n                    >\n                      <TagName\n                        {...(index === 0 &&\n                          !this.props.dataOnly && {\n                            ref: (ref: any) => (this.ref = ref),\n                          })}\n                        className=\"builder-content\"\n                        onClick={this.onClick}\n                        builder-content-id={content?.id}\n                        builder-model={this.name}\n                      >\n                        {this.props.children(\n                          content?.data! as any,\n                          this.props.inline ? false : loading,\n                          useData\n                        )}\n                      </TagName>\n                    </Tag>\n                  </React.Fragment>\n                );\n              })}\n            </React.Fragment>\n          );\n        }}\n      </VariantsProvider>\n    );\n  }\n}\n","// Via https://github.com/sindresorhus/on-change but\n// compiled for ES5\n\n'use strict';\nObject.defineProperty(exports, '__esModule', { value: true });\n('use strict');\nvar PATH_SEPARATOR = '.';\nvar TARGET = Symbol('target');\nvar UNSUBSCRIBE = Symbol('unsubscribe');\nvar isPrimitive = function (value) {\n  return value === null || (typeof value !== 'object' && typeof value !== 'function');\n};\nvar isBuiltinWithoutMutableMethods = function (value) {\n  return value instanceof RegExp || value instanceof Number;\n};\nvar isBuiltinWithMutableMethods = function (value) {\n  return value instanceof Date;\n};\nvar concatPath = function (path, property) {\n  if (property && property.toString) {\n    if (path) {\n      path += PATH_SEPARATOR;\n    }\n    path += property.toString();\n  }\n  return path;\n};\nvar walkPath = function (path, callback) {\n  var index;\n  while (path) {\n    index = path.indexOf(PATH_SEPARATOR);\n    if (index === -1) {\n      index = path.length;\n    }\n    callback(path.slice(0, index));\n    path = path.slice(index + 1);\n  }\n};\nvar shallowClone = function (value) {\n  if (Array.isArray(value)) {\n    return value.slice();\n  }\n  return Object.assign({}, value);\n};\nvar onChange = function (object, onChange, options) {\n  if (typeof Proxy === 'undefined') {\n    // TODO: use immer? or a technique like immer to diff maybe\n    return object;\n  }\n  if (options === void 0) {\n    options = {};\n  }\n  var proxyTarget = Symbol('ProxyTarget');\n  var inApply = false;\n  var changed = false;\n  var applyPath;\n  var applyPrevious;\n  var isUnsubscribed = false;\n  var equals = options.equals || Object.is;\n  var propCache = new WeakMap();\n  var pathCache = new WeakMap();\n  var proxyCache = new WeakMap();\n  var handleChange = function (path, property, previous, value) {\n    if (isUnsubscribed) {\n      return;\n    }\n    if (!inApply) {\n      onChange(concatPath(path, property), value, previous);\n      return;\n    }\n    if (\n      inApply &&\n      applyPrevious &&\n      previous !== undefined &&\n      value !== undefined &&\n      property !== 'length'\n    ) {\n      var item_1 = applyPrevious;\n      if (path !== applyPath) {\n        path = path.replace(applyPath, '').slice(1);\n        walkPath(path, function (key) {\n          item_1[key] = shallowClone(item_1[key]);\n          item_1 = item_1[key];\n        });\n      }\n      item_1[property] = previous;\n    }\n    changed = true;\n  };\n  var getOwnPropertyDescriptor = function (target, property) {\n    var props = propCache ? propCache.get(target) : undefined;\n    if (props) {\n      return props;\n    }\n    props = new Map();\n    propCache.set(target, props);\n    var prop = props.get(property);\n    if (!prop) {\n      prop = Reflect.getOwnPropertyDescriptor(target, property);\n      props.set(property, prop);\n    }\n    return prop;\n  };\n  var invalidateCachedDescriptor = function (target, property) {\n    var props = propCache ? propCache.get(target) : undefined;\n    if (props) {\n      props.delete(property);\n    }\n  };\n  var buildProxy = function (value, path) {\n    if (isUnsubscribed) {\n      return value;\n    }\n    pathCache.set(value, path);\n    var proxy = proxyCache.get(value);\n    if (proxy === undefined) {\n      proxy = new Proxy(value, handler);\n      proxyCache.set(value, proxy);\n    }\n    return proxy;\n  };\n  var unsubscribe = function (target) {\n    isUnsubscribed = true;\n    propCache = null;\n    pathCache = null;\n    proxyCache = null;\n    return target;\n  };\n  var ignoreChange = function (property) {\n    return isUnsubscribed || (options.ignoreSymbols === true && typeof property === 'symbol');\n  };\n  var handler = {\n    get: function (target, property, receiver) {\n      if (property === proxyTarget || property === TARGET) {\n        return target;\n      }\n      if (property === UNSUBSCRIBE && pathCache.get(target) === '') {\n        return unsubscribe(target);\n      }\n      var value = Reflect.get(target, property, receiver);\n      if (\n        isPrimitive(value) ||\n        isBuiltinWithoutMutableMethods(value) ||\n        property === 'constructor' ||\n        options.isShallow === true\n      ) {\n        return value;\n      }\n      // Preserve invariants\n      var descriptor = getOwnPropertyDescriptor(target, property);\n      if (descriptor && !descriptor.configurable) {\n        if (descriptor.set && !descriptor.get) {\n          return undefined;\n        }\n        if (descriptor.writable === false) {\n          return value;\n        }\n      }\n      return buildProxy(value, concatPath(pathCache.get(target), property));\n    },\n    set: function (target, property, value, receiver) {\n      if (value && value[proxyTarget] !== undefined) {\n        value = value[proxyTarget];\n      }\n      var ignore = ignoreChange(property);\n      var previous = ignore ? null : Reflect.get(target, property, receiver);\n      var result = Reflect.set(target[proxyTarget] || target, property, value);\n      if (!ignore && !equals(previous, value)) {\n        handleChange(pathCache.get(target), property, previous, value);\n      }\n      return result;\n    },\n    defineProperty: function (target, property, descriptor) {\n      var result = Reflect.defineProperty(target, property, descriptor);\n      if (!ignoreChange(property)) {\n        invalidateCachedDescriptor(target, property);\n        handleChange(pathCache.get(target), property, undefined, descriptor.value);\n      }\n      return result;\n    },\n    deleteProperty: function (target, property) {\n      if (!Reflect.has(target, property)) {\n        return true;\n      }\n      var ignore = ignoreChange(property);\n      var previous = ignore ? null : Reflect.get(target, property);\n      var result = Reflect.deleteProperty(target, property);\n      if (!ignore) {\n        invalidateCachedDescriptor(target, property);\n        handleChange(pathCache.get(target), property, previous);\n      }\n      return result;\n    },\n    apply: function (target, thisArg, argumentsList) {\n      var compare = isBuiltinWithMutableMethods(thisArg);\n      if (compare) {\n        thisArg = thisArg[proxyTarget];\n      }\n      if (!inApply) {\n        inApply = true;\n        if (compare) {\n          applyPrevious = thisArg.valueOf();\n        }\n        if (Array.isArray(thisArg) || toString.call(thisArg) === '[object Object]') {\n          applyPrevious = shallowClone(thisArg[proxyTarget]);\n        }\n        applyPath = pathCache.get(target);\n        applyPath = applyPath.slice(0, Math.max(applyPath.lastIndexOf(PATH_SEPARATOR), 0));\n        var result = Reflect.apply(target, thisArg, argumentsList);\n        inApply = false;\n        if (changed || (compare && !equals(applyPrevious, thisArg.valueOf()))) {\n          handleChange(applyPath, '', applyPrevious, thisArg[proxyTarget] || thisArg);\n          applyPrevious = null;\n          changed = false;\n        }\n        return result;\n      }\n      return Reflect.apply(target, thisArg, argumentsList);\n    },\n  };\n  var proxy = buildProxy(object, '');\n  onChange = onChange.bind(proxy);\n  return proxy;\n};\nonChange.target = function (proxy) {\n  return proxy[TARGET] || proxy;\n};\nonChange.unsubscribe = function (proxy) {\n  return proxy[UNSUBSCRIBE] || proxy;\n};\nmodule.exports = onChange;\nexports.default = onChange;\n","import { Builder } from '@builder.io/sdk';\n\nconst nextTick = Builder.nextTick;\n\n// Plain function - e.g. const debounced = debounceNextTick(fn);\nexport function debounceNextTick(fn: (...args: any[]) => void): () => void;\n// Decorator - e.g. class Foo { @debounceNextTick myMethod() { ... } }\nexport function debounceNextTick(\n  target: any,\n  key: PropertyKey,\n  descriptor: PropertyDescriptor\n): PropertyDescriptor;\nexport function debounceNextTick(\n  target: object | ((...args: any[]) => void),\n  key?: PropertyKey,\n  descriptor?: PropertyDescriptor\n) {\n  if (typeof key === 'undefined' && typeof target === 'function') {\n    return debounceNextTickImpl(target as any);\n  }\n  return {\n    configurable: true,\n    enumerable: descriptor!.enumerable,\n    get: function getter(): any {\n      // Attach this function to the instance (not the class)\n      Object.defineProperty(this, key!, {\n        configurable: true,\n        enumerable: descriptor!.enumerable,\n        value: debounceNextTickImpl(descriptor!.value),\n      });\n\n      return (this as any)[key!];\n    },\n  } as PropertyDescriptor;\n}\n\nfunction debounceNextTickImpl(fn: (...args: any[]) => void) {\n  let args: any[] | null = null;\n  let context: any = null;\n\n  return debounced;\n\n  function debounced(this: any) {\n    const previous = args;\n    args = [].slice.call(arguments);\n    context = this;\n    if (previous !== null) return;\n    nextTick(next);\n  }\n\n  function next() {\n    fn.apply(context, args as any);\n    args = null;\n    context = null;\n  }\n}\n","export function throttle(func: Function, wait: number, options: any = {}) {\n  let context: any;\n  let args: any;\n  let result: any;\n  let timeout = null as any;\n  let previous = 0;\n  const later = function () {\n    previous = options.leading === false ? 0 : Date.now();\n    timeout = null;\n    result = func.apply(context, args);\n    if (!timeout) context = args = null;\n  };\n  return function (this: any) {\n    const now = Date.now();\n    if (!previous && options.leading === false) previous = now;\n    const remaining = wait - (now - previous);\n    context = this;\n    args = arguments;\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n      previous = now;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    } else if (!timeout && options.trailing !== false) {\n      timeout = setTimeout(later, remaining);\n    }\n    return result;\n  };\n}\n","import React from 'react';\n\nexport const BuilderMetaContext = React.createContext({\n  emailMode: false,\n  ampMode: false,\n  isServer: false,\n});\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { jsx, css } from '@emotion/core';\nimport { BuilderContent } from './builder-content.component';\nimport { BuilderBlocks } from './builder-blocks.component';\nimport {\n  Builder,\n  GetContentOptions,\n  builder,\n  Subscription,\n  BehaviorSubject,\n  BuilderElement,\n  BuilderContent as Content,\n} from '@builder.io/sdk';\nimport { BuilderStoreContext } from '../store/builder-store';\nimport hash from 'hash-sum';\nimport onChange from '../../lib/on-change';\n\nexport { onChange };\n\nimport { sizes } from '../constants/device-sizes.constant';\nimport {\n  BuilderAsyncRequestsContext,\n  RequestOrPromise,\n  RequestInfo,\n  isRequestInfo,\n} from '../store/builder-async-requests';\nimport { Url } from 'url';\nimport { debounceNextTick } from '../functions/debonce-next-tick';\nimport { throttle } from '../functions/throttle';\nimport { safeDynamicRequire } from '../functions/safe-dynamic-require';\nimport { BuilderMetaContext } from '../store/builder-meta';\n\nfunction pick<T, K extends keyof T>(obj: T, ...keys: K[]): Pick<T, K> {\n  const ret: any = {};\n  keys.forEach(key => {\n    ret[key] = obj[key];\n  });\n  return ret;\n}\nfunction omit<T, K extends keyof T>(obj: T, ...keys: K[]): Omit<T, K> {\n  const ret: any = { ...obj };\n  keys.forEach(key => {\n    delete ret[key];\n  });\n  return ret;\n}\n\nconst wrapComponent = (info: any) => {\n  return (props: any) => {\n    // TODO: convention for all of this, like builderTagProps={{ style: {} foo: 'bar' }}\n    const Tag = props.builderTag || 'div';\n    const inputNames = ['children'].concat(\n      info.inputs?.map((item: any) => item.name as string) || []\n    );\n\n    const baseProps = omit(props, ...inputNames, 'attributes');\n    const inputProps = props; // pick(props, ...inputNames);\n\n    if (info.noWrap) {\n      return <info.class attributes={baseProps} {...inputProps} />;\n    }\n\n    return (\n      <Tag {...baseProps}>\n        <info.class {...inputProps} />\n      </Tag>\n    );\n  };\n};\n\nconst size = (thing: object) => Object.keys(thing).length;\n\nfunction debounce(func: Function, wait: number, immediate = false) {\n  let timeout: any;\n  return function (this: any) {\n    const context = this;\n    const args = arguments;\n    clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    }, wait);\n    if (immediate && !timeout) func.apply(context, args);\n  };\n}\n\nconst fontsLoaded = new Set();\n\n// TODO: get fetch from core JS....\nconst fetch = Builder.isBrowser ? window.fetch : require('node-fetch');\n\nconst sizeMap = {\n  desktop: 'large',\n  tablet: 'medium',\n  mobile: 'small',\n};\n\nfunction decorator(fn: Function) {\n  return function argReceiver(...fnArgs: any[]) {\n    // Check if the decorator is being called without arguments (ex `@foo methodName() {}`)\n    if (fnArgs.length === 3) {\n      const [target, key, descriptor] = fnArgs;\n      if (descriptor && (descriptor.value || descriptor.get)) {\n        fnArgs = [];\n        return descriptorChecker(target, key, descriptor);\n      }\n    }\n\n    return descriptorChecker;\n\n    // descriptorChecker determines whether a method or getter is being decorated\n    // and replaces the appropriate key with the decorated function.\n    function descriptorChecker(target: any, key: any, descriptor: any) {\n      const descriptorKey = descriptor.value ? 'value' : 'get';\n      return {\n        ...descriptor,\n        [descriptorKey]: fn(descriptor[descriptorKey], ...fnArgs),\n      };\n    }\n  };\n}\n\nconst Throttle = decorator(throttle);\n\nconst fetchCache: { [key: string]: any } = {};\n\nexport interface BuilderComponentProps {\n  /**\n   * @package\n   * @deprecated use {@link model} instead.\n   */\n  modelName?: string;\n  /**\n   * Name of the model this is rendering content for. Default is \"page\".\n   */\n  model?: string;\n  /**\n   * @package\n   * @deprecated use {@link model} instead.\n   */\n  name?: string;\n  /**\n   * Data is passed along as `state.*` to the component.\n   * @see {@link https://github.com/BuilderIO/builder/tree/master/packages/react#passing-data-and-functions-down}\n   *\n   * @example\n   * ```\n   * <BuilderComponent\n   *  model=\"page\"\n   *  data={{\n   *    products: productsList,\n   *    myFunction: () => alert('Triggered!'),\n   *    foo: 'bar'\n   *  }} >\n   * ```\n   */\n  data?: any;\n  /**\n   * Specific instance of Builder that should be used. You might use this for\n   * server side rendering. It's generally not recommended except for very\n   * advanced multi-tenant use cases.\n   */\n  builder?: Builder;\n  /**\n   * Content entry ID for this component to fetch client side\n   */\n  entry?: string;\n  /**\n   * @package\n   *\n   * Builder public API key.\n   *\n   * @see {@link builder.init()} for the preferred way of supplying your API key.\n   */\n  apiKey?: string;\n  /**\n   * @private\n   */\n  codegen?: boolean;\n  options?: GetContentOptions;\n  /**\n   * Function callback invoked with `data` and your content when it becomes\n   * available.\n   *\n   * @see {@link https://github.com/BuilderIO/builder/tree/master/packages/react#passing-data-and-functions-down}\n   */\n  contentLoaded?: (data: any, content: any) => void;\n  /**\n   * Instead of having Builder render a link for you with plain anchor\n   * elements, use your own function. Useful when using Next.js, Gatsby, or\n   * other client side routers' custom `<Link>` components.\n   *\n   * ## Notes\n   *\n   * This must be a function that returns JSX, not a component!\n   *\n   * ## Examples\n   *\n   * @see {@link https://github.com/BuilderIO/builder/blob/0f0bc1ca835335f99fc21efb20ff3c4836bc9f41/examples/next-js-builder-site/src/functions/render-link.tsx#L6}\n   */\n  renderLink?: (props: React.AnchorHTMLAttributes<any>) => React.ReactNode;\n  /**\n   * Callback to run if an error occurred while fetching content.\n   */\n  contentError?: (error: any) => void;\n  /**\n   * Manually specify what Builder content JSON object to render. @see {@link\n   * https://github.com/BuilderIO/builder/tree/master/packages/react#passing-content-manually}\n   */\n  content?: Content;\n  /**\n   * @package\n   *\n   * Location object that provides the current url, path, etc; for server side\n   * rendering.\n   */\n  location?: Location | Url;\n  /**\n   * Callback to run when Builder state changes (e.g. state.foo = 'bar' in an\n   * action)\n   */\n  onStateChange?: (newData: any) => void;\n  /**\n   * @package\n   * @deprecated\n   */\n  noAsync?: boolean;\n  /**\n   * @package\n   *\n   * Flag to render email content (small differences in our render logic for\n   * email support).\n   */\n  emailMode?: boolean;\n  /**\n   * @package\n   *\n   * Flag to render amp content (small differences in our render logic for amp\n   * support)\n   */\n  ampMode?: boolean;\n  /**\n   * @package\n   *\n   * Render content in-line only (can't passed from the content prop) don't\n   * fetch content from our API.\n   */\n  inlineContent?: boolean;\n  /**\n   * @package\n   * @deprecated\n   */\n  builderBlock?: BuilderElement;\n  /**\n   * @package\n   * @deprecated\n   */\n  dataOnly?: boolean;\n  /**\n   * @package\n   * @deprecated\n   */\n  hydrate?: boolean;\n  /**\n   * @package\n   * @deprecated use {@link Builder.isStatic} instead\n   */\n  isStatic?: boolean;\n  /**\n   * Object that will be available in actions and bindings.\n   *\n   * @see {@link https://github.com/BuilderIO/builder/tree/master/packages/react#passing-data-and-functions-down}\n   */\n  context?: any;\n  /**\n   * @deprecated\n   */\n  url?: string;\n  /**\n   * Set to true if this is not the root content component, for instance for symbols\n   */\n  isChild?: boolean;\n  /**\n   * Set to true to not call `event.stopPropagation()` in the editor to avoid\n   * issues with client site routing triggering when editing in Builder, causing\n   * navigation to other pages unintended\n   */\n  stopClickPropagationWhenEditing?: boolean;\n}\n\nexport interface BuilderComponentState {\n  state: any;\n  update: (state: any) => any;\n  updates: number;\n  context: any;\n  key: number;\n}\n\nconst tryEval = (str?: string, data: any = {}, errors?: Error[]): any => {\n  const value = str;\n  if (!(typeof value === 'string' && value.trim())) {\n    return;\n  }\n  const useReturn = !(value.includes(';') || value.includes(' return '));\n  let fn: Function = () => {\n    /* Intentionally empty */\n  };\n  try {\n    if (Builder.isBrowser) {\n      // tslint:disable-next-line:no-function-constructor-with-string-args\n      // TODO: VM in node......\n      fn = new Function(\n        'state',\n        // TODO: remove the with () {} - make a page v3 that doesn't use this\n        `var rootState = state;\n        if (typeof Proxy !== 'undefined') {\n          rootState = new Proxy(rootState, {\n            set: function () {\n              return false;\n            },\n            get: function (target, key) {\n              if (key === 'state') {\n                return state;\n              }\n              return target[key]\n            }\n          });\n        }\n        with (rootState) {\n          ${useReturn ? `return (${str});` : str};\n        }`\n      );\n    }\n  } catch (error) {\n    if (Builder.isBrowser) {\n      console.warn('Could not compile javascript', error);\n    } else {\n      // Add to req.options.errors to return to client\n    }\n  }\n  try {\n    if (Builder.isBrowser) {\n      return fn(data || {});\n    } else {\n      // Below is a hack to get certain code to *only* load in the server build, to not screw with\n      // browser bundler's like rollup and webpack. Our rollup plugin strips these comments only\n      // for the server build\n      // tslint:disable:comment-format\n      const { VM } = safeDynamicRequire('vm2');\n      return new VM({\n        sandbox: {\n          ...data,\n          ...{ state: data },\n        },\n        // TODO: convert reutrn to module.exports on server\n      }).run(value.replace(/(^|;)return /, '$1'));\n      // tslint:enable:comment-format\n    }\n  } catch (error) {\n    if (errors) {\n      errors.push(error);\n    }\n\n    if (Builder.isBrowser) {\n      console.warn('Builder custom code error:', error.message, 'in', str, error.stack);\n    } else {\n      if (process.env.DEBUG) {\n        console.debug('Builder custom code error:', error.message, 'in', str, error.stack);\n      }\n      // Add to req.options.errors to return to client\n    }\n  }\n\n  return;\n};\n\nfunction searchToObject(location: Location | Url) {\n  const pairs = (location.search || '').substring(1).split('&');\n  const obj: { [key: string]: string } = {};\n\n  for (const i in pairs) {\n    if (!(pairs[i] && typeof pairs[i] === 'string')) {\n      continue;\n    }\n    const pair = pairs[i].split('=');\n    obj[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n  }\n\n  return obj;\n}\n\n/**\n * Responsible for rendering Builder content of type: 'page' or 'section' to\n * react components. It will attempt to fetch content from the API based on\n * defined user attributes (URL path, device type, and any custom targeting you set using `builder.setUserAttributes`) unless a `BuilderContent`\n * object is provided to `props.content`\n *\n * Use it to mount content in desired location, enable editing in place when\n * previewed in the editor.\n *\n * Supports server-side-rendering when passed the content json as\n * `props.content`.\n */\nexport class BuilderComponent extends React.Component<\n  BuilderComponentProps,\n  BuilderComponentState\n> {\n  static defaults: Pick<BuilderComponentProps, 'codegen'> = {\n    codegen: Boolean(Builder.isBrowser && location.href.includes('builder.codegen=true')),\n  };\n\n  subscriptions: Subscription = new Subscription();\n  // TODO: don't trigger initial one?\n  onStateChange = new BehaviorSubject<any>(null);\n  asServer = Builder.isServer;\n\n  contentRef: BuilderContent | null = null;\n\n  styleRef: HTMLStyleElement | null = null;\n\n  rootState = Builder.isServer ? {} : onChange({}, () => this.updateState());\n\n  lastJsCode = '';\n  lastHttpRequests: { [key: string]: string | undefined } = {};\n  httpSubscriptionPerKey: { [key: string]: Subscription | undefined } = {};\n\n  ref: HTMLElement | null = null;\n\n  Component: any;\n\n  get options() {\n    // TODO: for perf cache this\n    return {\n      ...BuilderComponent.defaults,\n      ...this.props,\n    };\n  }\n\n  get name(): string | undefined {\n    return this.props.model || this.props.modelName || this.props.name; // || this.props.model\n  }\n\n  private _asyncRequests?: RequestOrPromise[];\n  private _errors?: Error[];\n  private _logs?: string[];\n\n  get element() {\n    return this.ref;\n  }\n\n  get inlinedContent() {\n    if (this.isPreviewing && !this.props.inlineContent) {\n      return undefined;\n    }\n    return this.props.content;\n  }\n\n  constructor(props: BuilderComponentProps) {\n    super(props);\n\n    // TODO: pass this all the way down - symbols, etc\n    // this.asServer = Boolean(props.hydrate && Builder.isBrowser)\n\n    this.state = {\n      // TODO: should change if this prop changes\n      context: props.context || {},\n      state: Object.assign(this.rootState, {\n        ...(this.inlinedContent && this.inlinedContent.data && this.inlinedContent.data.state),\n        isBrowser: Builder.isBrowser, // !this.asServer,\n        isServer: !Builder.isBrowser, // this.asServer,\n        _hydrate: props.hydrate,\n        location: this.locationState,\n        deviceSize: this.deviceSizeState,\n        // TODO: will user attributes be ready here?\n        device: this.device,\n        ...this.getHtmlData(),\n        ...props.data,\n      }),\n      updates: 0,\n      key: 0,\n      update: this.updateState,\n    };\n\n    if (Builder.isBrowser) {\n      const key = this.props.apiKey;\n      if (key && key !== this.builder.apiKey) {\n        this.builder.apiKey = key;\n      }\n\n      if (this.inlinedContent) {\n        // Sometimes with graphql we get the content as `content.content`\n        const content = (this.inlinedContent as any).content || this.inlinedContent;\n        this.onContentLoaded(content?.data, content);\n      }\n    }\n  }\n\n  get builder() {\n    return this.props.builder || builder;\n  }\n\n  getHtmlData() {\n    const id = (this.inlinedContent && this.inlinedContent.id) || this.props.entry;\n    const script =\n      id &&\n      Builder.isBrowser &&\n      document.querySelector(\n        `script[data-builder-json=\"${id}\"],script[data-builder-state=\"${id}\"]`\n      );\n    if (script) {\n      try {\n        const json = JSON.parse((script as HTMLElement).innerText);\n        return json;\n      } catch (err) {\n        console.warn(\n          'Could not parse Builder.io HTML data transfer',\n          err,\n          (script as HTMLElement).innerText\n        );\n      }\n    }\n    return {};\n  }\n\n  // TODO: pass down with context\n  get device() {\n    return this.builder.getUserAttributes().device || 'desktop';\n  }\n\n  get locationState() {\n    return {\n      // TODO: handle this correctly on the server. Pass in with CONTEXT\n      ...pick(this.location, 'pathname', 'hostname', 'search', 'host'),\n      path: (this.location.pathname && this.location.pathname.split('/').slice(1)) || '',\n      query: searchToObject(this.location),\n    };\n  }\n\n  // TODO: trigger state change on screen size change\n  get deviceSizeState() {\n    // TODO: use context to pass this down on server\n    return Builder.isBrowser\n      ? sizes.getSizeForWidth(window.innerWidth)\n      : sizeMap[this.device] || 'large';\n  }\n\n  messageListener = (event: MessageEvent) => {\n    const info = event.data;\n    switch (info.type) {\n      case 'builder.updateSpacer': {\n        const data = info.data;\n        const currentSpacer = this.rootState._spacer;\n        this.updateState(state => {\n          state._spacer = data;\n        });\n        break;\n      }\n      case 'builder.resetState': {\n        const { state, model } = info.data;\n        if (model === this.name) {\n          for (const key in this.rootState) {\n            // TODO: support nested functions (somehow)\n            if (typeof this.rootState[key] !== 'function') {\n              delete this.rootState[key];\n            }\n          }\n          Object.assign(this.rootState, state);\n          this.setState({\n            ...this.state,\n            state: this.rootState,\n            updates: ((this.state && this.state.updates) || 0) + 1,\n          });\n        }\n        break;\n      }\n      case 'builder.resetSymbolState': {\n        const { state, model, id } = info.data.state;\n        if (this.props.builderBlock && this.props.builderBlock === id) {\n          for (const key in this.rootState) {\n            delete this.rootState[key];\n          }\n          Object.assign(this.rootState, state);\n          this.setState({\n            ...this.state,\n            state: this.rootState,\n            updates: ((this.state && this.state.updates) || 0) + 1,\n          });\n        }\n        break;\n      }\n    }\n  };\n\n  resizeFn = () => {\n    const deviceSize = this.deviceSizeState;\n    if (deviceSize !== this.state.state.deviceSize) {\n      this.setState({\n        ...this.state,\n        updates: ((this.state && this.state.updates) || 0) + 1,\n        state: Object.assign(this.rootState, {\n          ...this.state.state,\n          deviceSize,\n        }),\n      });\n    }\n  };\n\n  resizeListener = Builder.isEditing ? throttle(this.resizeFn, 200) : debounce(this.resizeFn, 400);\n\n  static renderInto(\n    elementOrSelector: string | HTMLElement,\n    props: BuilderComponentProps = {},\n    hydrate = true,\n    fresh = false\n  ) {\n    console.debug('BuilderPage.renderInto', elementOrSelector, props, hydrate, this);\n\n    if (!elementOrSelector) {\n      return;\n    }\n\n    let element: Element | null = null;\n\n    if (typeof elementOrSelector === 'string') {\n      element = document.querySelector(elementOrSelector);\n    } else {\n      if (elementOrSelector instanceof Element) {\n        element = elementOrSelector;\n      }\n    }\n\n    if (!element) {\n      return;\n    }\n\n    const exists = element.classList.contains('builder-hydrated');\n    if (exists && !fresh) {\n      console.debug('Tried to hydrate multiple times');\n      return;\n    }\n    element.classList.add('builder-hydrated');\n\n    let shouldHydrate = hydrate && element.innerHTML.includes('builder-block');\n\n    if (!element.classList.contains('builder-component')) {\n      // TODO: maybe remove any builder-api-styles...\n      const apiStyles =\n        element.querySelector('.builder-api-styles') ||\n        (element.previousElementSibling &&\n        element.previousElementSibling.matches('.builder-api-styles')\n          ? element.previousElementSibling\n          : null);\n      let keepStyles = '';\n      if (apiStyles) {\n        const html = apiStyles.innerHTML;\n        html.replace(\n          /\\/\\*start:([^\\*]+?)\\*\\/([\\s\\S]*?)\\/\\*end:([^\\*]+?)\\*\\//g,\n          (match, id, content) => {\n            let el: HTMLElement | null = null;\n            try {\n              el = document.querySelector(`[data-emotion-css=\"${id}\"]`);\n            } catch (err) {\n              console.warn(err);\n            }\n            if (el) {\n              el.innerHTML = content;\n            } else if (!Builder.isEditing) {\n              keepStyles += match;\n            }\n\n            return match;\n          }\n        );\n        // NextTick? or longer timeout?\n        Builder.nextTick(() => {\n          apiStyles.innerHTML = keepStyles;\n        });\n      }\n      const useElement = element.querySelector('.builder-component');\n      if (useElement) {\n        element = useElement;\n      } else {\n        shouldHydrate = false;\n      }\n    }\n\n    if (location.search.includes('builder.debug=true')) {\n      console.debug('hydrate', shouldHydrate, element);\n    }\n\n    let useEl = element;\n    if (!exists) {\n      const div = document.createElement('div');\n      element.insertAdjacentElement('beforebegin', div);\n      div.appendChild(element);\n      useEl = div;\n    }\n\n    if (Builder.isEditing || (Builder.isBrowser && location.search.includes('builder.preview='))) {\n      shouldHydrate = false;\n    }\n    if (shouldHydrate && element) {\n      // TODO: maybe hydrate again. Maybe...\n      const val = ReactDOM.render(\n        <BuilderComponent {...props} />,\n        useEl,\n        (useEl as any).builderRootRef\n      );\n      (useEl as any).builderRootRef = val;\n      return val;\n    }\n    const val = ReactDOM.render(\n      <BuilderComponent {...props} />,\n      useEl,\n      (useEl as any).builderRootRef\n    );\n    (useEl as any).builderRootRef = val;\n    return val;\n  }\n\n  mounted = false;\n\n  componentDidMount() {\n    this.mounted = true;\n    if (this.asServer) {\n      this.asServer = false;\n      this.updateState(state => {\n        state.isBrowser = true;\n        state.isServer = false;\n      });\n    }\n\n    if (Builder.isIframe) {\n      window.parent?.postMessage(\n        { type: 'builder.sdkInjected', data: { modelName: this.name } },\n        '*'\n      );\n    }\n\n    if (Builder.isBrowser) {\n      // TODO: remove event on unload\n      window.addEventListener('resize', this.resizeListener);\n      if (Builder.isEditing) {\n        window.addEventListener('message', this.messageListener);\n      }\n\n      setTimeout(() => {\n        window.dispatchEvent(\n          new CustomEvent('builder:component:load', {\n            detail: {\n              ref: this,\n            },\n          })\n        );\n      });\n    }\n  }\n\n  updateState = (fn?: (state: any) => void) => {\n    const state = this.rootState;\n    if (fn) {\n      fn(state);\n    }\n    if (this.mounted) {\n      this.setState({\n        update: this.updateState,\n        state,\n        updates: ((this.state && this.state.updates) || 0) + 1,\n      });\n    } else {\n      this.state = {\n        ...this.state,\n        update: this.updateState,\n        state,\n        updates: ((this.state && this.state.updates) || 0) + 1,\n      };\n    }\n\n    this.notifyStateChange();\n  };\n\n  get isPreviewing() {\n    return (\n      (Builder.isServer || (Builder.isBrowser && Builder.isPreviewing)) &&\n      builder.previewingModel === this.name\n    );\n  }\n\n  @debounceNextTick\n  notifyStateChange() {\n    if (Builder.isServer) {\n      return;\n    }\n    if (!(this && this.state)) {\n      return;\n    }\n    const nextState = this.state.state;\n    // TODO: only run the below once per tick...\n    if (this.props.onStateChange) {\n      this.props.onStateChange(nextState);\n    }\n\n    if (Builder.isBrowser) {\n      window.dispatchEvent(\n        new CustomEvent('builder:component:stateChange', {\n          detail: {\n            state: nextState,\n            ref: this,\n          },\n        })\n      );\n    }\n    this.onStateChange.next(nextState);\n  }\n\n  processStateFromApi(state: { [key: string]: any }) {\n    return state; //  mapValues(state, value => tryEval(value, this.data, this._errors))\n  }\n\n  get location() {\n    return this.props.location || (Builder.isBrowser ? location : ({} as any));\n  }\n\n  getCssFromFont(font: any, data?: any) {\n    // TODO: compute what font sizes are used and only load those.......\n    const family = font.family + (font.kind && !font.kind.includes('#') ? ', ' + font.kind : '');\n    const name = family.split(',')[0];\n    const url = font.fileUrl ? font.fileUrl : font.files && font.files.regular;\n    let str = '';\n    if (url && family && name) {\n      str += `\n@font-face {\n  font-family: \"${family}\";\n  src: local(\"${name}\"), url('${url}') format('woff2');\n  font-display: fallback;\n  font-weight: 400;\n}\n        `.trim();\n    }\n\n    if (font.files) {\n      for (const weight in font.files) {\n        const isNumber = String(Number(weight)) === weight;\n        if (!isNumber) {\n          continue;\n        }\n        // TODO: maybe limit number loaded\n        const weightUrl = font.files[weight];\n        if (weightUrl && weightUrl !== url) {\n          str += `\n@font-face {\n  font-family: \"${family}\";\n  src: url('${weightUrl}') format('woff2');\n  font-display: fallback;\n  font-weight: ${weight};\n}\n          `.trim();\n        }\n      }\n    }\n    return str;\n  }\n\n  componentWillUnmount() {\n    this.unsubscribe();\n    if (Builder.isBrowser) {\n      window.removeEventListener('resize', this.resizeListener);\n      window.removeEventListener('message', this.messageListener);\n    }\n  }\n\n  getFontCss(data?: any) {\n    if (!this.builder.allowCustomFonts) {\n      return '';\n    }\n    // TODO: separate internal data from external\n    return (\n      (data?.customFonts &&\n        data.customFonts.length &&\n        data.customFonts.map((font: any) => this.getCssFromFont(font, data)).join(' ')) ||\n      ''\n    );\n  }\n\n  ensureFontsLoaded(data?: any) {\n    if (this.builder.allowCustomFonts && data?.customFonts && Array.isArray(data.customFonts)) {\n      for (const font of data.customFonts) {\n        const url = font.fileUrl ? font.fileUrl : font.files && font.files.regular;\n        if (!fontsLoaded.has(url)) {\n          const html = this.getCssFromFont(font, data);\n          fontsLoaded.add(url);\n          if (!html) {\n            continue;\n          }\n          const style = document.createElement('style');\n          style.className = 'builder-custom-font';\n          style.setAttribute('data-builder-custom-font', url);\n          style.innerHTML = html;\n          document.head.appendChild(style);\n        }\n      }\n    }\n  }\n\n  getCss(data?: any) {\n    const contentId = this.useContent?.id;\n    let cssCode = data?.cssCode || '';\n    if (contentId) {\n      // Allow using `&` in custom CSS code like @emotion\n      // E.g. `& .foobar { ... }` to scope CSS\n      // TODO: handle if '&' is within a string like `content: \"&\"`\n      cssCode = cssCode.replace(/&/g, `.builder-component-${contentId}`);\n    }\n\n    return cssCode + this.getFontCss(data);\n  }\n\n  get data() {\n    const data = {\n      ...(this.inlinedContent && this.inlinedContent.data?.state),\n      ...this.props.data,\n      ...this.state.state,\n    };\n    Object.assign(this.rootState, data);\n    return data;\n  }\n\n  componentDidUpdate(prevProps: BuilderComponentProps) {\n    // TODO: shallow diff\n    if (this.props.data && prevProps.data !== this.props.data) {\n      this.state.update((state: any) => {\n        Object.assign(state, this.props.data);\n      });\n    }\n\n    if (Builder.isEditing) {\n      if (this.inlinedContent && prevProps.content !== this.inlinedContent) {\n        this.onContentLoaded(this.inlinedContent.data, this.inlinedContent);\n      }\n    }\n  }\n\n  // FIXME: workaround to issue with CSS extraction and then hydration\n  // (might be preact only)\n  checkStyles(data: any) {\n    if (this.styleRef) {\n      const css = this.getCss(data);\n      if (this.styleRef.innerHTML !== css) {\n        this.styleRef.innerHTML = css;\n      }\n    }\n  }\n\n  reload() {\n    this.setState({\n      key: this.state.key + 1,\n    });\n  }\n\n  get content() {\n    let content = this.inlinedContent;\n    if (content && (content as any).content) {\n      // GraphQL workaround\n      content = {\n        ...content,\n        data: (content as any).content,\n      };\n    }\n    return content;\n  }\n\n  get useContent() {\n    return this.content || this.state.context.builderContent;\n  }\n\n  render() {\n    const content = this.content;\n\n    const dataString =\n      Builder.isBrowser && this.props.data && size(this.props.data) && hash(this.props.data);\n    let key = Builder.isEditing ? this.name : this.props.entry;\n    if (key && !Builder.isEditing && dataString && dataString.length < 300) {\n      key += ':' + dataString;\n    }\n\n    const WrapComponent = this.props.dataOnly ? React.Fragment : 'div';\n\n    const contentId = this.useContent?.id;\n\n    return (\n      // TODO: data attributes for model, id, etc?\n      <WrapComponent\n        onClick={event => {\n          // Prevent propagation from the root content component when editing to prevent issues\n          // like client side routing triggering when links are clicked, unless this behavior is\n          // disabled with the stopClickPropagationWhenEditing prop\n          if (\n            Builder.isEditing &&\n            !this.props.isChild &&\n            !this.props.stopClickPropagationWhenEditing\n          ) {\n            event.stopPropagation();\n          }\n        }}\n        className={`builder-component ${contentId ? `builder-component-${contentId}` : ''}`}\n        data-name={this.name}\n        data-source=\"Rendered by Builder.io\"\n        key={this.state.key}\n        ref={ref => (this.ref = ref)}\n      >\n        <BuilderMetaContext.Consumer>\n          {value => (\n            <BuilderMetaContext.Provider\n              value={\n                typeof this.props.ampMode === 'boolean'\n                  ? {\n                      ...value,\n                      ampMode: this.props.ampMode,\n                    }\n                  : value\n              }\n            >\n              <BuilderAsyncRequestsContext.Consumer>\n                {value => {\n                  this._asyncRequests = value && value.requests;\n                  this._errors = value && value.errors;\n                  this._logs = value && value.logs;\n\n                  return (\n                    <BuilderContent\n                      isStatic={this.props.isStatic || Builder.isStatic}\n                      key={\n                        this.inlinedContent?.id ||\n                        ('content' in this.props && !this.isPreviewing\n                          ? 'null-content-prop'\n                          : 'no-content-prop')\n                      }\n                      builder={this.builder}\n                      ref={ref => (this.contentRef = ref)}\n                      // TODO: pass entry in\n                      contentLoaded={(data, content) => this.onContentLoaded(data, content)}\n                      options={{\n                        key,\n                        entry: this.props.entry,\n                        ...(content && { initialContent: [content] }),\n                        ...(!content &&\n                          'content' in this.props &&\n                          !this.isPreviewing && { initialContent: [] }),\n                        ...(this.props.url && { url: this.props.url }),\n                        ...this.props.options,\n                        ...(this.options.codegen && {\n                          format: 'react',\n                        }),\n                      }}\n                      inline={\n                        this.props.inlineContent || (!this.isPreviewing && 'content' in this.props)\n                      }\n                      contentError={this.props.contentError}\n                      modelName={this.name || 'page'}\n                    >\n                      {(data, loading, fullData) => {\n                        if (this.props.dataOnly) {\n                          return null;\n                        }\n\n                        if (fullData && fullData.id) {\n                          this.state.context.builderContent = fullData;\n                        }\n                        if (Builder.isBrowser) {\n                          Builder.nextTick(() => {\n                            this.checkStyles(data);\n                          });\n                        }\n\n                        const { codegen } = this.options;\n\n                        if (codegen && !this.Component && data?.blocksJs) {\n                          const builderComponentNames: string[] = Array.from(\n                            new Set(Builder.components.map((item: any) => item.name))\n                          );\n                          const reversedcomponents = Builder.components.slice().reverse();\n\n                          const builderComponents = builderComponentNames.map(name =>\n                            reversedcomponents.find((item: any) => item.class && item.name === name)\n                          );\n\n                          const useBuilderState = (initialState: any) => {\n                            const [, setTick] = React.useState(0);\n                            const [state] = React.useState(() =>\n                              onChange(initialState, function () {\n                                setTick(tick => tick + 1);\n                              })\n                            );\n\n                            return state;\n                          };\n\n                          const mappedComponentNames = builderComponentNames.map(name =>\n                            (name || '').replace(/[^\\w]+/gi, '')\n                          );\n\n                          const finalizedComponents = builderComponents.map(info =>\n                            wrapComponent(info)\n                          );\n\n                          this.Component = new Function(\n                            'jsx',\n                            '_css',\n                            'Builder',\n                            'builder',\n                            'React',\n                            'useBuilderState',\n                            ...mappedComponentNames,\n                            data.blocksJs\n                          )(\n                            jsx,\n                            css,\n                            Builder,\n                            builder,\n                            React,\n                            useBuilderState,\n                            ...finalizedComponents\n                          );\n                        }\n\n                        // TODO: loading option - maybe that is what the children is or component prop\n                        // TODO: get rid of all these wrapper divs\n                        return data ? (\n                          <div\n                            data-builder-component={this.name}\n                            data-builder-content-id={fullData.id}\n                            data-builder-variation-id={\n                              fullData.testVariationId || fullData.variationId || fullData.id\n                            }\n                          >\n                            {!codegen && this.getCss(data) && (\n                              <style\n                                ref={ref => (this.styleRef = ref)}\n                                className=\"builder-custom-styles\"\n                                dangerouslySetInnerHTML={{\n                                  __html: this.getCss(data),\n                                }}\n                              />\n                            )}\n                            <BuilderStoreContext.Provider\n                              value={{\n                                ...this.state,\n                                rootState: this.rootState,\n                                state: this.data,\n                                content: fullData,\n                                renderLink: this.props.renderLink,\n                              }}\n                            >\n                              {codegen && this.Component ? (\n                                <this.Component data={this.data} context={this.state.context} />\n                              ) : (\n                                <BuilderBlocks\n                                  key={String(!!data?.blocks?.length)}\n                                  emailMode={this.props.emailMode}\n                                  fieldName=\"blocks\"\n                                  blocks={data.blocks}\n                                />\n                              )}\n                            </BuilderStoreContext.Provider>\n                          </div>\n                        ) : loading ? (\n                          <div data-builder-component={this.name} className=\"builder-loading\">\n                            {this.props.children}\n                          </div>\n                        ) : (\n                          <div data-builder-component={this.name} className=\"builder-no-content\" />\n                        );\n                      }}\n                    </BuilderContent>\n                  );\n                }}\n              </BuilderAsyncRequestsContext.Consumer>\n            </BuilderMetaContext.Provider>\n          )}\n        </BuilderMetaContext.Consumer>\n      </WrapComponent>\n    );\n  }\n\n  evalExpression(expression: string) {\n    const { data } = this;\n    return expression.replace(/{{([^}]+)}}/g, (match, group) => tryEval(group, data, this._errors));\n  }\n\n  // TODO: customizable hm\n  @Throttle(100, { leading: true, trailing: true })\n  throttledHandleRequest(propertyName: string, url: string) {\n    return this.handleRequest(propertyName, url);\n  }\n\n  async handleRequest(propertyName: string, url: string) {\n    // TODO: Builder.isEditing = just checks if iframe and parent page is this.builder.io or localhost:1234\n    if (Builder.isIframe && fetchCache[url]) {\n      this.updateState(ctx => {\n        ctx[propertyName] = fetchCache[url];\n      });\n      return fetchCache[url];\n    }\n    const request = async () => {\n      const requestStart = Date.now();\n      if (!Builder.isBrowser) {\n        console.time('Fetch ' + url);\n      }\n      let json: any;\n      try {\n        const result = await fetch(url);\n        json = await result.json();\n      } catch (err) {\n        if (this._errors) {\n          this._errors.push(err);\n        }\n        if (this._logs) {\n          this._logs.push(`Fetch to ${url} errored in ${Date.now() - requestStart}ms`);\n        }\n        return;\n      } finally {\n        if (!Builder.isBrowser) {\n          console.timeEnd('Fetch ' + url);\n          if (this._logs) {\n            this._logs.push(`Fetched ${url} in ${Date.now() - requestStart}ms`);\n          }\n        }\n      }\n\n      if (json) {\n        if (Builder.isIframe) {\n          fetchCache[url] = json;\n        }\n        // TODO: debounce next tick all of these when there are a bunch\n        this.updateState(ctx => {\n          ctx[propertyName] = json;\n        });\n      }\n\n      return json;\n    };\n    const existing =\n      this._asyncRequests &&\n      (this._asyncRequests.find(\n        req => isRequestInfo(req) && req.url === url\n      ) as RequestInfo | null);\n    if (existing) {\n      const promise = existing.promise;\n      promise.then(json => {\n        if (json) {\n          this.updateState(ctx => {\n            ctx[propertyName] = json;\n          });\n        }\n      });\n      return promise;\n    }\n    const promise = request();\n    Builder.nextTick(() => {\n      if (this._asyncRequests) {\n        this._asyncRequests.push(promise);\n      }\n    });\n    return promise;\n  }\n\n  unsubscribe() {\n    if (this.subscriptions) {\n      this.subscriptions.unsubscribe();\n      this.subscriptions = new Subscription();\n    }\n  }\n\n  handleBuilderRequest(propertyName: string, optionsString: string) {\n    const options = tryEval(optionsString, this.data, this._errors);\n    // TODO: this will screw up for multiple bits of data\n    if (this.subscriptions) {\n      this.unsubscribe();\n    }\n    // TODO: don't unsubscribe and resubscribe every time data changes, will make a TON of requests if that's the case when editing...\n    // I guess will be cached then\n    if (options) {\n      // TODO: unsubscribe on destroy\n      this.subscriptions.add(\n        this.builder.queueGetContent(options.model, options).subscribe(matches => {\n          if (matches) {\n            this.updateState(ctx => {\n              ctx[propertyName] = matches;\n            });\n          }\n        })\n      );\n    }\n  }\n\n  onContentLoaded = (data: any, content: any) => {\n    if (this.name === 'page' && Builder.isBrowser) {\n      if (data) {\n        const { title, pageTitle, description, pageDescription } = data;\n\n        if (title || pageTitle) {\n          document.title = title || pageTitle;\n        }\n\n        if (description || pageDescription) {\n          let descriptionTag = document.querySelector('meta[name=\"description\"]');\n\n          if (!descriptionTag) {\n            descriptionTag = document.createElement('meta');\n            descriptionTag.setAttribute('name', 'description');\n            document.head.appendChild(descriptionTag);\n          }\n\n          descriptionTag.setAttribute('content', description || pageDescription);\n        }\n      }\n    }\n\n    if (Builder.isEditing) {\n      this.notifyStateChange();\n    }\n\n    // Unsubscribe all? TODO: maybe don't continuous fire when editing.....\n    if (this.props.contentLoaded) {\n      this.props.contentLoaded(data, content);\n    }\n\n    if (data && data.inputs && Array.isArray(data.inputs) && data.inputs.length) {\n      if (!data.state) {\n        data.state = {};\n      }\n\n      // Maybe...\n      // if (data.context) {\n      //   Object.assign(this.state.context, data.context)\n      // }\n      // TODO: may not want this... or make sure anything overriden\n      // explitily sets to null\n      data.inputs.forEach((input: any) => {\n        if (input) {\n          if (\n            input.name &&\n            input.defaultValue !== undefined &&\n            data.state[input.name] === undefined\n          ) {\n            data.state[input.name] = input.defaultValue;\n          }\n        }\n      });\n    }\n\n    if (data && data.state) {\n      const newState = {\n        ...this.state,\n        updates: ((this.state && this.state.updates) || 0) + 1,\n        state: Object.assign(this.rootState, {\n          ...this.state.state,\n          location: this.locationState,\n          deviceSize: this.deviceSizeState,\n          device: this.device,\n          ...data.state,\n          ...this.props.data,\n        }),\n      };\n      if (this.mounted) {\n        this.setState(newState);\n      } else {\n        this.state = newState;\n      }\n    }\n\n    // TODO: also throttle on edits maybe\n    if (data && data.jsCode && Builder.isBrowser && !this.options.codegen) {\n      // Don't rerun js code when editing and not changed\n      let skip = false;\n      if (Builder.isEditing) {\n        if (this.lastJsCode === data.jsCode) {\n          skip = true;\n        } else {\n          this.lastJsCode = data.jsCode;\n        }\n      }\n\n      if (!skip) {\n        const state = this.state.state;\n\n        // TODO: real editing method\n        try {\n          const result = new Function(\n            'data',\n            'ref',\n            'state',\n            'update',\n            'element',\n            'Builder',\n            'builder',\n            'context',\n            data.jsCode\n          )(data, this, state, this.state.update, this.ref, Builder, builder, this.state.context);\n\n          // TODO: allow exports = { } syntax?\n          // TODO: do something with reuslt like view - methods, computed, actions, properties, template, etc etc\n        } catch (error) {\n          if (Builder.isBrowser) {\n            console.warn(\n              'Builder custom code error:',\n              error.message,\n              'in',\n              data.jsCode,\n              error.stack\n            );\n          } else {\n            if (process.env.DEBUG) {\n              console.debug(\n                'Builder custom code error:',\n                error.message,\n                'in',\n                data.jsCode,\n                error.stack\n              );\n            }\n            // Add to req.options.errors to return to client\n          }\n        }\n      }\n    }\n\n    if (data && data.httpRequests /* || data.builderData @DEPRECATED */ && !this.props.noAsync) {\n      // Don't rerun http requests when editing and not changed\n      // No longer needed?\n      let skip = false;\n\n      if (!skip) {\n        // TODO: another structure for this\n        for (const key in data.httpRequests) {\n          const url: string | undefined = data.httpRequests[key];\n          if (url && (!this.data[key] || Builder.isEditing)) {\n            // TODO: if Builder.isEditing and url patches https://builder.io/api/v2/content/{editingModel}\n            // Then use this.builder.get().subscribe(...)\n            if (Builder.isBrowser) {\n              const finalUrl = this.evalExpression(url);\n              if (Builder.isEditing && this.lastHttpRequests[key] === finalUrl) {\n                continue;\n              }\n              this.lastHttpRequests[key] = finalUrl;\n              const builderModelRe = /builder\\.io\\/api\\/v2\\/([^\\/\\?]+)/i;\n              const builderModelMatch = url.match(builderModelRe);\n              const model = builderModelMatch && builderModelMatch[1];\n              if (false && Builder.isEditing && model && this.builder.editingModel === model) {\n                this.throttledHandleRequest(key, finalUrl);\n                // TODO: fix this\n                // this.subscriptions.add(\n                //   this.builder.get(model).subscribe(data => {\n                //     this.state.update((state: any) => {\n                //       state[key] = data\n                //     })\n                //   })\n                // )\n              } else {\n                this.throttledHandleRequest(key, finalUrl);\n                const currentSubscription = this.httpSubscriptionPerKey[key];\n                if (currentSubscription) {\n                  currentSubscription.unsubscribe();\n                }\n\n                // TODO: fix this\n                const newSubscription = (this.httpSubscriptionPerKey[\n                  key\n                ] = this.onStateChange.subscribe(() => {\n                  const newUrl = this.evalExpression(url);\n                  if (newUrl !== finalUrl) {\n                    this.throttledHandleRequest(key, newUrl);\n                    this.lastHttpRequests[key] = newUrl;\n                  }\n                }));\n                this.subscriptions.add(newSubscription);\n              }\n            } else {\n              this.handleRequest(key, this.evalExpression(url));\n            }\n          }\n        }\n\n        // @DEPRECATED\n        // for (const key in data.builderData) {\n        //   const url = data.builderData[key]\n        //   if (url && !this.data[key]) {\n        //     this.handleBuilderRequest(key, this.evalExpression(url))\n        //   }\n        // }\n      }\n    }\n  };\n}\n","import { Builder, Component } from '@builder.io/sdk';\n\ninterface ReactComponent extends Component {}\n\nexport function BuilderBlock(options: ReactComponent) {\n  options.type = 'react';\n\n  return Builder.Component(options);\n}\n","import { Component, Builder } from '@builder.io/sdk';\n\n/**\n * Update metadata for a Builder component\n *\n * @param component Builder react component\n * @param fn Updater\n *\n * @example\n *    updatMetadata(TextBlock, current => ({\n *       ...current,\n *       fields: [\n *        ...curent.fields,\n *        { name: 'myNewField', type: 'string' }\n *       ]\n *    }))\n */\nexport function updateMetadata(\n  component: Function | string,\n  fn: (currentMetadata: Component | null) => Component | void\n) {\n  const match =\n    Builder.components.find(item => {\n      if (typeof component === 'string') {\n        return item.name === component;\n      } else {\n        return item.class === item;\n      }\n    }) || null;\n\n  const updated = fn(match);\n  if (match && updated) {\n    // re-registering the same component will replace it\n    Builder.registerComponent(updated.class || match.class, updated);\n  } else if (match && !updated) {\n    // TODO: have a way to message to remove component\n  } else if (!match && updated) {\n    Builder.registerComponent(updated.class, updated);\n  }\n}\n","import { Component } from '@builder.io/sdk';\nimport { BuilderBlock } from '../decorators/builder-block.decorator';\n\nexport function withBuilder(component: Function, options: Component) {\n  BuilderBlock(options)(component as any);\n  return component;\n}\n","import React from 'react';\nimport { BuilderElement } from '@builder.io/sdk';\nimport { BuilderBlock } from '../components/builder-block.component';\n\n/**\n * Higher order component for passing Builder.io children as React children\n *\n * @example\n * ```tsx\n *\n *    const MyButton = props => <Button>\n *      {children}\n *    </Button>\n *\n *    const ButtonWithBuilderChildren = withChildren(MyButton)\n *\n *    Builder.registerComponent(ButtonWithBuilderChildren, {\n *      name: 'MyButton',\n *      defaultChildren: [\n *        {\n *          '@type': '@builder.io/sdk:Element'\n *        }\n *      ]\n *    })\n * ```\n */\nexport const withChildren = <P extends object>(Component: React.ComponentType<P>) => {\n  const HOC = React.forwardRef<any, React.PropsWithChildren<P> & { builderBlock?: BuilderElement }>(\n    (props, ref) => {\n      const children =\n        props.children ||\n        (props.builderBlock &&\n          props.builderBlock.children &&\n          props.builderBlock.children.map(child => <BuilderBlock key={child.id} block={child} />));\n\n      return (\n        <Component {...props} ref={ref}>\n          {children}\n        </Component>\n      );\n    }\n  );\n\n  (HOC as any).builderOptions = {\n    canHaveChildren: true,\n  };\n\n  return HOC;\n};\n","import React from 'react';\nimport { BuilderElement } from '@builder.io/sdk';\nimport { BuilderBlock } from '../components/builder-block.component';\n\n/**\n * Higher order component for passing Builder.io styles and attributes directly\n * to the component child without wrapping\n *\n * Useful when you need styles etc applied directly to the component without a\n * wrapping element (e.g. div), and you are already forwarding all props and attributes\n * (e.g. <YourComponent {...props} />)\n *\n * 👉 Important: make sure you always add props.className,\n * even if you supply a className too\n *\n * @example\n * ```tsx\n *\n *    const MyButton = props => <Button\n *      {...props}\n *      className={'my-button ' + (props.className || '')}>\n *      Hello there!\n *    </Button>\n *\n *    const ButtonWithBuilderChildren = noWrap(MyButton)\n *\n *    Builder.registerComponent(ButtonWithBuilderChildren, {\n *      name: 'MyButton',\n *    })\n * ```\n */\nexport const noWrap = <P extends object>(Component: React.ComponentType<P>) => {\n  const HOC = React.forwardRef((props: React.PropsWithChildren<P> & { attributes?: any }, ref) => {\n    const finalProps = {\n      ...props,\n      ...props.attributes,\n    };\n    return <Component {...finalProps} ref={ref} />;\n  });\n  (HOC as any).builderOptions = {\n    noWrap: true,\n  };\n\n  return HOC;\n};\n","/** @jsx jsx */\nimport { jsx, InterpolationWithTheme } from '@emotion/core';\nimport React from 'react';\nimport { Builder, BuilderElement } from '@builder.io/sdk';\nimport { withBuilder } from '../functions/with-builder';\nimport { BuilderStoreContext } from '../store/builder-store';\nconst iconUrl =\n  'https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-text_fields-24px%20(1).svg?alt=media&token=12177b73-0ee3-42ca-98c6-0dd003de1929';\n\nexport interface TextProps {\n  text: string;\n  builderBlock?: BuilderElement;\n}\n\nclass TextComponent extends React.Component<TextProps> {\n  textRef: HTMLSpanElement | null = null;\n\n  componentDidUpdate(prevProps: TextProps) {\n    if (!this.allowTextEdit) {\n      return;\n    }\n    if (\n      this.textRef &&\n      !(this.textRef.contentEditable === 'true' && this.textRef === document.activeElement)\n    ) {\n      if (this.props.text !== prevProps.text) {\n        this.textRef.innerHTML = this.props.text;\n      }\n    }\n  }\n\n  componentDidMount() {\n    if (this.textRef) {\n      this.textRef.innerHTML = this.props.text;\n    }\n  }\n\n  get allowTextEdit() {\n    return (\n      Builder.isBrowser &&\n      Builder.isEditing &&\n      location.search.includes('builder.allowTextEdit=true') &&\n      !(\n        this.props.builderBlock &&\n        this.props.builderBlock.bindings &&\n        (this.props.builderBlock.bindings['component.options.text'] ||\n          this.props.builderBlock.bindings['options.text'] ||\n          this.props.builderBlock.bindings['text'])\n      )\n    );\n  }\n\n  render() {\n    const allowEditingText = this.allowTextEdit;\n\n    const textCSS: InterpolationWithTheme<any> = {\n      outline: 'none',\n      '& p:first-of-type, & .builder-paragraph:first-of-type': {\n        margin: 0,\n      },\n      '& > p, & .builder-paragraph': {\n        color: 'inherit',\n        lineHeight: 'inherit',\n        letterSpacing: 'inherit',\n        fontWeight: 'inherit',\n        fontSize: 'inherit',\n        textAlign: 'inherit',\n        fontFamily: 'inherit',\n      },\n    };\n\n    return (\n      <BuilderStoreContext.Consumer>\n        {state => {\n          if (state.content.meta?.rtlMode) {\n            textCSS.direction = 'rtl';\n          }\n\n          return (\n            <React.Fragment>\n              {/* TODO: <BuilderEditableText component that wraps this for other components with text */}\n              <span\n                ref={ref => {\n                  this.textRef = ref;\n                }}\n                contentEditable={allowEditingText || undefined}\n                onInput={e => {\n                  if (allowEditingText) {\n                    window.parent?.postMessage(\n                      {\n                        type: 'builder.textEdited',\n                        data: {\n                          id: this.props.builderBlock && this.props.builderBlock.id,\n                          value: e.currentTarget.innerHTML,\n                        },\n                      },\n                      '*'\n                    );\n                  }\n                }}\n                onKeyDown={e => {\n                  if (\n                    allowEditingText &&\n                    this.textRef &&\n                    e.which === 27 &&\n                    document.activeElement === this.textRef\n                  ) {\n                    this.textRef.blur();\n                  }\n                }}\n                onFocus={e => {\n                  if (allowEditingText) {\n                    window.parent?.postMessage(\n                      {\n                        type: 'builder.textFocused',\n                        data: {\n                          id: this.props.builderBlock && this.props.builderBlock.id,\n                        },\n                      },\n                      '*'\n                    );\n                  }\n                }}\n                onBlur={e => {\n                  if (allowEditingText) {\n                    window.parent?.postMessage(\n                      {\n                        type: 'builder.textBlurred',\n                        data: {\n                          id: this.props.builderBlock && this.props.builderBlock.id,\n                        },\n                      },\n                      '*'\n                    );\n                  }\n                }}\n                css={textCSS}\n                className=\"builder-text\"\n                {...(!allowEditingText && {\n                  dangerouslySetInnerHTML: {\n                    __html: this.props.text || (this.props as any).content || '',\n                  },\n                })}\n              />\n            </React.Fragment>\n          );\n        }}\n      </BuilderStoreContext.Consumer>\n    );\n  }\n}\n\nexport const Text = withBuilder(TextComponent, {\n  name: 'Text',\n  static: true,\n  image: iconUrl,\n  inputs: [\n    {\n      name: 'text',\n      type: 'html',\n      required: true,\n      autoFocus: true,\n      bubble: true,\n      defaultValue: 'Enter some text...',\n    },\n  ],\n  // Maybe optionally a function that takes in some params like block vs absolute, etc\n  defaultStyles: {\n    lineHeight: 'normal',\n    height: 'auto',\n    textAlign: 'center',\n  },\n});\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React, { useContext } from 'react';\nimport { Builder } from '@builder.io/sdk';\nimport { BuilderBlocks } from '../components/builder-blocks.component';\nimport { BuilderStoreContext } from '../store/builder-store';\n\nBuilder.registerComponent(Slot, {\n  name: 'Slot',\n  description: 'Allow child blocks to be inserted into this content when used as a Symbol',\n  docsLink: 'https://www.builder.io/c/docs/symbols-with-blocks',\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FYJIGb4i01jvw0SRdL5Bt%2F3aad6de36eae43b59b52c85190fdef56',\n\n  // Maybe wrap this for canHaveChildren so bind children to this hm\n  inputs: [{ name: 'name', type: 'string', required: true, defaultValue: 'children' }],\n});\n\ntype DropzoneProps = {\n  name: string;\n};\n\nexport function Slot(props: DropzoneProps) {\n  const { name } = props;\n  const context = useContext(BuilderStoreContext);\n\n  const isEditingThisSlot = !context.context.symbolId;\n\n  return (\n    <div\n      css={{\n        pointerEvents: 'auto',\n      }}\n      {...(isEditingThisSlot && {\n        'builder-slot': name,\n      })}\n    >\n      <BuilderBlocks\n        child\n        parentElementId={context.context.symbolId}\n        dataPath={`symbol.data.${name}`}\n        blocks={context.state[name] || []}\n      />\n    </div>\n  );\n}\n","import React from 'react';\nimport { BuilderElement } from '@builder.io/sdk';\nimport { withBuilder } from '../functions/with-builder';\nimport { BuilderBlock as BuilderBlockComponent } from '../components/builder-block.component';\n\nexport interface FragmentProps {\n  builderBlock?: BuilderElement;\n}\n\nclass FragmentComponent extends React.Component<FragmentProps> {\n  render() {\n    return (\n      this.props.builderBlock &&\n      this.props.builderBlock.children &&\n      this.props.builderBlock.children.map((block, index) => (\n        <BuilderBlockComponent block={block} key={block.id} index={index} />\n      ))\n    );\n  }\n}\n\nexport const Fragment = withBuilder(FragmentComponent, {\n  name: 'Core:Fragment',\n  canHaveChildren: true,\n  noWrap: true,\n  static: true,\n  hideFromInsertMenu: true,\n});\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\n\nimport { BuilderElement } from '@builder.io/sdk';\nimport { BuilderBlocks } from '../components/builder-blocks.component';\nimport { builder } from '@builder.io/sdk';\nimport { withBuilder } from '../functions/with-builder';\nimport { Link } from '../components/Link';\n\nconst DEFAULT_ASPECT_RATIO = 0.7004048582995948;\n\nconst defaultBlocks: BuilderElement[] = [\n  {\n    '@type': '@builder.io/sdk:Element',\n    responsiveStyles: {\n      large: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'stretch',\n        flexShrink: '0',\n        position: 'relative',\n        marginTop: '30px',\n        textAlign: 'center',\n        lineHeight: 'normal',\n        height: 'auto',\n        minHeight: '20px',\n        minWidth: '20px',\n        overflow: 'hidden',\n      },\n    },\n    component: {\n      name: 'Image',\n      options: {\n        image:\n          'https://builder.io/api/v1/image/assets%2Fpwgjf0RoYWbdnJSbpBAjXNRMe9F2%2Ffb27a7c790324294af8be1c35fe30f4d',\n        backgroundPosition: 'center',\n        backgroundSize: 'cover',\n        aspectRatio: DEFAULT_ASPECT_RATIO,\n      },\n    },\n  },\n  {\n    '@type': '@builder.io/sdk:Element',\n    responsiveStyles: {\n      large: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'stretch',\n        flexShrink: '0',\n        position: 'relative',\n        marginTop: '30px',\n        textAlign: 'center',\n        lineHeight: 'normal',\n        height: 'auto',\n      },\n    },\n    component: {\n      name: 'Text',\n      options: {\n        text: '<p>Enter some text...</p>',\n      },\n    },\n  },\n];\n\nclass ColumnsComponent extends React.Component<any> {\n  // TODO: Column interface\n  get columns(): any[] {\n    return this.props.columns || [];\n  }\n\n  get gutterSize(): number {\n    return typeof this.props.space === 'number' ? this.props.space || 0 : 20;\n  }\n\n  getWidth(index: number) {\n    return (this.columns[index] && this.columns[index].width) || 100 / this.columns.length;\n  }\n\n  getColumnWidth(index: number) {\n    const { columns, gutterSize } = this;\n    const subtractWidth = (gutterSize * (columns.length - 1)) / columns.length;\n    return `calc(${this.getWidth(index)}% - ${subtractWidth}px)`;\n  }\n\n  render() {\n    const { columns, gutterSize } = this;\n\n    return (\n      // FIXME: make more elegant\n      <React.Fragment>\n        <div\n          className=\"builder-columns\"\n          css={{\n            display: 'flex',\n            ...(this.props.stackColumnsAt !== 'never' && {\n              [`@media (max-width: ${this.props.stackColumnsAt !== 'tablet' ? 639 : 999}px)`]: {\n                flexDirection: this.props.reverseColumnsWhenStacked ? 'column-reverse' : 'column',\n                alignItems: 'stretch',\n              },\n            }),\n          }}\n        >\n          {columns.map((col, index) => {\n            const TagName = col.link ? Link : 'div';\n\n            // TODO: pass size down in context\n\n            return (\n              <React.Fragment key={index}>\n                <TagName\n                  className=\"builder-column\"\n                  {...(col.link ? { href: col.link } : null)}\n                  // TODO: generate width and margin-left as CSS instead so can override with pure CSS for best responsieness\n                  // and no use of !important\n                  css={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'stretch',\n                    lineHeight: 'normal',\n                    ['& > .builder-blocks']: {\n                      flexGrow: 1,\n                    },\n                    width: this.getColumnWidth(index),\n                    marginLeft: index === 0 ? 0 : gutterSize,\n                    ...(this.props.stackColumnsAt !== 'never' && {\n                      [`@media (max-width: ${\n                        this.props.stackColumnsAt !== 'tablet' ? 639 : 999\n                      }px)`]: {\n                        width: '100%',\n                        marginLeft: 0,\n                      },\n                    }),\n                  }}\n                >\n                  <BuilderBlocks\n                    key={index}\n                    // TODO: childOf [parentBlocks]?\n                    child\n                    parentElementId={this.props.builderBlock && this.props.builderBlock.id}\n                    blocks={col.blocks}\n                    dataPath={`component.options.columns.${index}.blocks`}\n                  />\n                </TagName>\n              </React.Fragment>\n            );\n          })}\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport const Columns = withBuilder(ColumnsComponent, {\n  name: 'Columns',\n  static: true,\n  inputs: [\n    {\n      name: 'columns',\n      type: 'array',\n      broadcast: true,\n      subFields: [\n        {\n          name: 'blocks',\n          type: 'array',\n          hideFromUI: true,\n          defaultValue: defaultBlocks,\n        },\n        {\n          name: 'width',\n          type: 'number',\n          hideFromUI: true,\n          helperText: 'Width %, e.g. set to 50 to fill half of the space',\n        },\n        {\n          name: 'link',\n          type: 'url',\n          helperText: 'Optionally set a url that clicking this column will link to',\n        },\n      ],\n      defaultValue: [{ blocks: defaultBlocks }, { blocks: defaultBlocks }],\n      onChange: (options: Map<string, any>) => {\n        function clearWidths() {\n          columns.forEach(col => {\n            col.delete('width');\n          });\n        }\n\n        const columns = options.get('columns') as Array<Map<String, any>>;\n\n        if (Array.isArray(columns)) {\n          const containsColumnWithWidth = !!columns.find(col => col.get('width'));\n\n          if (containsColumnWithWidth) {\n            const containsColumnWithoutWidth = !!columns.find(col => !col.get('width'));\n            if (containsColumnWithoutWidth) {\n              clearWidths();\n            } else {\n              const sumWidths = columns.reduce((memo, col) => {\n                return memo + col.get('width');\n              }, 0);\n              const widthsDontAddUp = sumWidths !== 100;\n              if (widthsDontAddUp) {\n                clearWidths();\n              }\n            }\n          }\n        }\n      },\n    },\n    {\n      name: 'space',\n      type: 'number',\n      defaultValue: 20,\n      helperText: 'Size of gap between columns',\n      advanced: true,\n    },\n    {\n      name: 'stackColumnsAt',\n      type: 'string',\n      defaultValue: 'tablet',\n      helperText: 'Convert horizontal columns to vertical at what device size',\n      enum: ['tablet', 'mobile', 'never'],\n      advanced: true,\n    },\n    {\n      name: 'reverseColumnsWhenStacked',\n      type: 'boolean',\n      defaultValue: false,\n      helperText: 'When stacking columns for mobile devices, reverse the ordering',\n      advanced: true,\n    },\n  ],\n});\n","import React from 'react';\nimport { Builder } from '@builder.io/sdk';\nimport { withBuilder } from '../functions/with-builder';\n\nclass EmbedComponent extends React.Component<any> {\n  elementRef: HTMLElement | null = null;\n\n  scriptsInserted = new Set();\n  scriptsRun = new Set();\n\n  componentDidUpdate(prevProps: any) {\n    if (this.props.content !== prevProps.content) {\n      this.findAndRunScripts();\n    }\n  }\n\n  componentDidMount() {\n    this.findAndRunScripts();\n  }\n\n  findAndRunScripts() {\n    if (this.elementRef && typeof window !== 'undefined') {\n      const scripts = this.elementRef.getElementsByTagName('script');\n      for (let i = 0; i < scripts.length; i++) {\n        const script = scripts[i];\n        if (script.src) {\n          if (this.scriptsInserted.has(script.src)) {\n            continue;\n          }\n          this.scriptsInserted.add(script.src);\n          const newScript = document.createElement('script');\n          newScript.async = true;\n          newScript.src = script.src;\n          document.head.appendChild(newScript);\n        } else {\n          if (this.scriptsRun.has(script.innerText)) {\n            continue;\n          }\n          this.scriptsRun.add(script.innerText);\n          try {\n            new Function(script.innerText)();\n          } catch (error) {\n            console.warn('Builder custom code component error:', error);\n          }\n        }\n      }\n    }\n  }\n\n  get content() {\n    // Remove scripts on server - if they manipulate dom there can be issues on hydration\n    // TODO: allow this to by bypassed by context or prop that says if this is going to be HTML\n    // loaded without client JS/hydration (static)\n    if (Builder.isServer) {\n      return (this.props.content || '').replace(/<script[\\s\\S]*?<\\/script>/g, '');\n    }\n    return this.props.content;\n  }\n\n  render() {\n    return (\n      <div\n        ref={ref => (this.elementRef = ref)}\n        className=\"builder-embed\"\n        dangerouslySetInnerHTML={{ __html: this.content }}\n      />\n    );\n  }\n}\n\nexport const Embed = withBuilder(EmbedComponent, {\n  name: 'Embed',\n  static: true,\n  inputs: [\n    {\n      name: 'url',\n      type: 'url',\n      required: true,\n      defaultValue: '',\n      helperText: 'e.g. enter a youtube url, google map, etc',\n      onChange(options: Map<string, any>) {\n        const url = options.get('url');\n        if (url) {\n          options.set('content', 'Loading...');\n          // TODO: get this out of here!\n          const apiKey = 'ae0e60e78201a3f2b0de4b';\n          return fetch(`https://iframe.ly/api/iframely?url=${url}&api_key=${apiKey}`)\n            .then(res => res.json())\n            .then(data => {\n              if (options.get('url') === url) {\n                if (data.html) {\n                  options.set('content', data.html);\n                } else {\n                  options.set('content', 'Invalid url, please try another');\n                }\n              }\n            })\n            .catch(err => {\n              options.set(\n                'content',\n                'There was an error embedding this URL, please try again or another URL'\n              );\n            });\n        } else {\n          options.delete('content');\n        }\n      },\n    },\n    {\n      name: 'content',\n      type: 'html',\n      defaultValue: `<div style=\"padding: 20px; text-align: center\">(Choose an embed URL)<div>`,\n      hideFromUI: true,\n    },\n  ],\n});\n","import React from 'react';\nimport { BuilderElement, Builder } from '@builder.io/sdk';\nimport { withBuilder } from '../functions/with-builder';\n\ninterface Props {\n  code: string;\n  builderBlock?: BuilderElement;\n  replaceNodes?: boolean;\n  scriptsClientOnly?: boolean;\n}\n\n// TODO: settings context to pass this down. do in shopify-specific generated code\nconst globalReplaceNodes = ({} as { [key: string]: Element[] }) || null;\n\nconst isShopify = Builder.isBrowser && 'Shopify' in window;\n\nif (Builder.isBrowser && globalReplaceNodes) {\n  const customCodeQuerySelector = isShopify\n    ? '.builder-custom-code'\n    : '.builder-custom-code.replace-nodes';\n  try {\n    let allCustomCodeElements = Array.from(document.querySelectorAll(customCodeQuerySelector));\n\n    // Search each template element (if present) for custom code blocks since\n    // querySelectorAll cannot search all templates that we use for variations, because they are\n    // considered document fragments and are not a part of the DOM.\n    const builderTemplates = document.querySelectorAll('template[data-template-variant-id]');\n    if (builderTemplates.length) {\n      Array.from(builderTemplates).forEach(template => {\n        const content: DocumentFragment = (template as any).content;\n        const codeElements = content.querySelectorAll(customCodeQuerySelector);\n        if (codeElements.length) {\n          allCustomCodeElements = allCustomCodeElements.concat(Array.from(codeElements));\n        }\n      });\n    }\n\n    allCustomCodeElements.forEach(el => {\n      const parent = el.parentElement;\n      const id = parent && parent.getAttribute('builder-id');\n      if (id) {\n        globalReplaceNodes[id] = globalReplaceNodes[id] || [];\n        globalReplaceNodes[id].push(el);\n      }\n    });\n  } catch (err) {\n    console.error('Builder replace nodes error:', err);\n  }\n}\n\nclass CustomCodeComponent extends React.Component<Props> {\n  elementRef: Element | null = null;\n  originalRef: Element | null = null;\n\n  scriptsInserted = new Set();\n  scriptsRun = new Set();\n\n  firstLoad = true;\n  replaceNodes: boolean;\n\n  constructor(props: Props) {\n    super(props);\n\n    const id = this.props.builderBlock?.id;\n    this.replaceNodes = Boolean(\n      Builder.isBrowser && (props.replaceNodes || isShopify) && id && globalReplaceNodes?.[id]\n    );\n\n    if (this.replaceNodes && Builder.isBrowser && this.firstLoad && this.props.builderBlock) {\n      if (id && globalReplaceNodes?.[id]) {\n        const el = globalReplaceNodes[id].shift() || null;\n        this.originalRef = el;\n        if (globalReplaceNodes[id].length === 0) {\n          delete globalReplaceNodes[id];\n        }\n      } else {\n        const existing = document.querySelectorAll(\n          `.${this.props.builderBlock.id} .builder-custom-code`\n        );\n        if (existing.length === 1) {\n          const node = existing[0];\n          this.originalRef = node as HTMLElement;\n          this.originalRef.remove();\n        }\n      }\n    }\n  }\n\n  get noReactRender() {\n    // Don't render liquid client side\n    return Boolean(isShopify && this.props.code?.match(/{[{%]/g));\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.code !== prevProps.code) {\n      this.findAndRunScripts();\n    }\n  }\n\n  componentDidMount() {\n    this.firstLoad = false;\n    if (!this.replaceNodes) {\n      this.findAndRunScripts();\n    }\n    if (Builder.isBrowser && this.replaceNodes && this.originalRef && this.elementRef) {\n      this.elementRef.appendChild(this.originalRef);\n    }\n  }\n\n  findAndRunScripts() {\n    if (this.elementRef && typeof window !== 'undefined') {\n      const scripts = this.elementRef.getElementsByTagName('script');\n      for (let i = 0; i < scripts.length; i++) {\n        const script = scripts[i];\n        if (script.src) {\n          if (this.scriptsInserted.has(script.src)) {\n            continue;\n          }\n          this.scriptsInserted.add(script.src);\n          const newScript = document.createElement('script');\n          newScript.async = true;\n          newScript.src = script.src;\n          document.head.appendChild(newScript);\n        } else if (\n          !script.type ||\n          ['text/javascript', 'application/javascript', 'application/ecmascript'].includes(\n            script.type\n          )\n        ) {\n          if (this.scriptsRun.has(script.innerText)) {\n            continue;\n          }\n          try {\n            this.scriptsRun.add(script.innerText);\n            new Function(script.innerText)();\n          } catch (error) {\n            console.warn('Builder custom code component error:', error);\n          }\n        }\n      }\n    }\n  }\n\n  get code() {\n    if (Builder.isServer && this.props.scriptsClientOnly) {\n      return (this.props.code || '').replace(\n        /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,\n        ''\n      );\n    }\n    return this.props.code;\n  }\n\n  render() {\n    // TODO: remove <script> tags for server render (unless has some param to say it's only goingn to be run on server)\n    // like embed\n    return (\n      <div\n        ref={ref => (this.elementRef = ref)}\n        // TODO: add a class when node replaced in (?)\n        className={'builder-custom-code' + (this.props.replaceNodes ? ' replace-nodes' : '')}\n        {...(!this.replaceNodes &&\n          !this.noReactRender && {\n            dangerouslySetInnerHTML: { __html: this.code },\n          })}\n      />\n    );\n  }\n}\n\nexport const CustomCode = withBuilder(CustomCodeComponent, {\n  name: 'Custom Code',\n  static: true,\n  requiredPermissions: ['editCode'],\n  inputs: [\n    {\n      name: 'code',\n      type: 'html',\n      required: true,\n      defaultValue: '<p>Hello there, I am custom HTML code!</p>',\n      code: true,\n    },\n    {\n      name: 'replaceNodes',\n      type: 'boolean',\n      helperText: 'Preserve server rendered dom nodes',\n      advanced: true,\n      ...(isShopify && {\n        defaultValue: true,\n      }),\n    },\n    {\n      name: 'scriptsClientOnly',\n      type: 'boolean',\n      defaultValue: false,\n      // TODO: default true?\n      helperText:\n        'Only print and run scripts on the client. Important when scripts influence DOM that could be replaced when client loads',\n      advanced: true,\n    },\n  ],\n} as any);\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\n\nimport { BuilderBlock as BuilderBlockComponent } from '../components/builder-block.component';\nimport { BuilderElement, Builder } from '@builder.io/sdk';\nimport { BuilderMetaContext } from '../store/builder-meta';\nimport { withBuilder } from '../functions/with-builder';\nimport { throttle } from '../functions/throttle';\n\n// Taken from (and modified) the shopify theme script repo\n// https://github.com/Shopify/theme-scripts/blob/bcfb471f2a57d439e2f964a1bb65b67708cc90c3/packages/theme-images/images.js#L59\nfunction removeProtocol(path: string) {\n  return path.replace(/http(s)?:/, '');\n}\n\nfunction isElementInViewport(el: HTMLElement) {\n  const rect = el.getBoundingClientRect();\n\n  return (\n    rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n    rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n  );\n}\n\nfunction getShopifyImageUrl(src: string, size: string): string | null {\n  if (!src || !src?.match(/cdn\\.shopify\\.com/) || !size) {\n    return src;\n  }\n\n  if (size === 'master') {\n    return removeProtocol(src);\n  }\n\n  const match = src.match(/(_\\d+x(\\d+)?)?(\\.(jpg|jpeg|gif|png|bmp|bitmap|tiff|tif)(\\?v=\\d+)?)/i);\n\n  if (match) {\n    const prefix = src.split(match[0]);\n    const suffix = match[3];\n    const useSize = size.match('x') ? size : `${size}x`;\n\n    return removeProtocol(`${prefix[0]}_${useSize}${suffix}`);\n  }\n\n  return null;\n}\n\nconst DEFAULT_ASPECT_RATIO = 0.7041;\n\nexport function updateQueryParam(uri = '', key: string, value: string | number | boolean): string {\n  const re = new RegExp('([?&])' + key + '=.*?(&|$)', 'i');\n  const separator = uri.indexOf('?') !== -1 ? '&' : '?';\n  if (uri.match(re)) {\n    return uri.replace(re, '$1' + key + '=' + encodeURIComponent(value) + '$2');\n  }\n\n  return uri + separator + key + '=' + encodeURIComponent(value);\n}\n\nexport function getSrcSet(url: string): string {\n  if (!url) {\n    return url;\n  }\n\n  const sizes = [100, 200, 400, 800, 1200, 1600, 2000];\n\n  if (url.match(/builder\\.io/)) {\n    let srcUrl = url;\n    const widthInSrc = Number(url.split('?width=')[1]);\n    if (!isNaN(widthInSrc)) {\n      srcUrl = `${srcUrl} ${widthInSrc}w`;\n    }\n\n    return sizes\n      .filter(size => size !== widthInSrc)\n      .map(size => `${updateQueryParam(url, 'width', size)} ${size}w`)\n      .concat([srcUrl])\n      .join(', ');\n  }\n\n  if (url.match(/cdn\\.shopify\\.com/)) {\n    return sizes\n      .map(size => [getShopifyImageUrl(url, `${size}x${size}`), size])\n      .filter(([sizeUrl]) => !!sizeUrl)\n      .map(([sizeUrl, size]) => `${sizeUrl} ${size}w`)\n      .concat([url])\n      .join(', ');\n  }\n\n  return url;\n}\n\nexport const getSizes = (sizes: string, block: BuilderElement) => {\n  let useSizes = '';\n\n  if (sizes) {\n    const splitSizes = sizes.split(',');\n    const sizesLength = splitSizes.length;\n    useSizes = splitSizes\n      .map((size: string, index) => {\n        if (sizesLength === index + 1) {\n          // If it is the last size in the array, then we want to strip out\n          // any media query information. According to the img spec, the last\n          // value for sizes cannot have a media query. If there is a media\n          // query at the end it breaks AMP mode rendering\n          // https://github.com/ampproject/amphtml/blob/b6313e372fdd1298928e2417dcc616b03288e051/src/size-list.js#L169\n          return size.replace(/\\([\\s\\S]*?\\)/g, '').trim();\n        } else {\n          return size;\n        }\n      })\n      .join(', ');\n  } else if (block && block.responsiveStyles) {\n    const generatedSizes = [];\n    let hasSmallOrMediumSize = false;\n    const unitRegex = /^\\d+/;\n\n    if (block.responsiveStyles?.small?.width?.match(unitRegex)) {\n      hasSmallOrMediumSize = true;\n      const mediaQuery = '(max-width: 639px)';\n      const widthAndQuery = `${mediaQuery} ${block.responsiveStyles.small.width.replace(\n        '%',\n        'vw'\n      )}`;\n      generatedSizes.push(widthAndQuery);\n    }\n\n    if (block.responsiveStyles?.medium?.width?.match(unitRegex)) {\n      hasSmallOrMediumSize = true;\n      const mediaQuery = '(max-width: 999px)';\n      const widthAndQuery = `${mediaQuery} ${block.responsiveStyles.medium.width.replace(\n        '%',\n        'vw'\n      )}`;\n      generatedSizes.push(widthAndQuery);\n    }\n\n    if (block.responsiveStyles?.large?.width) {\n      const width = block.responsiveStyles.large.width.replace('%', 'vw');\n      generatedSizes.push(width);\n    } else if (hasSmallOrMediumSize) {\n      generatedSizes.push('100vw');\n    }\n\n    if (generatedSizes.length) {\n      useSizes = generatedSizes.join(', ');\n    }\n  }\n\n  return useSizes;\n};\n\n// TODO: use picture tag to support more formats\nclass ImageComponent extends React.Component<any, { imageLoaded: boolean; load: boolean }> {\n  get useLazyLoading() {\n    // Use builder.getLocation()\n    return Builder.isBrowser && location.search.includes('builder.lazyLoadImages=false')\n      ? false\n      : Builder.isBrowser && location.href.includes('builder.lazyLoadImages=true')\n      ? true\n      : this.props.lazy;\n  }\n\n  // TODO: setting to always fade in the images (?)\n  state = {\n    imageLoaded: !this.useLazyLoading,\n    load: !this.useLazyLoading,\n  };\n\n  pictureRef: HTMLPictureElement | null = null;\n\n  scrollListener: null | ((e: Event) => void) = null;\n  intersectionObserver: IntersectionObserver | null = null;\n\n  componentWillUnmount() {\n    if (Builder.isBrowser) {\n      if (this.scrollListener) {\n        window.removeEventListener('scroll', this.scrollListener);\n        this.scrollListener = null;\n      }\n\n      if (this.intersectionObserver && this.pictureRef) {\n        this.intersectionObserver.unobserve(this.pictureRef);\n      }\n    }\n  }\n\n  componentDidMount() {\n    if (this.props.lazy && Builder.isBrowser) {\n      if (this.pictureRef && isElementInViewport(this.pictureRef)) {\n        this.setState({\n          load: true,\n        });\n      } else if (typeof IntersectionObserver === 'function' && this.pictureRef) {\n        const observer = (this.intersectionObserver = new IntersectionObserver(\n          (entries, observer) => {\n            entries.forEach(entry => {\n              // In view\n              if (entry.intersectionRatio > 0) {\n                this.setState({\n                  load: true,\n                });\n                if (this.pictureRef) {\n                  observer.unobserve(this.pictureRef);\n                }\n              }\n            });\n          }\n        ));\n\n        observer.observe(this.pictureRef);\n      } else {\n        // throttled scroll capture listener\n        const listener = throttle(\n          (event: Event) => {\n            if (this.pictureRef) {\n              const rect = this.pictureRef.getBoundingClientRect();\n              const buffer = window.innerHeight / 2;\n              if (rect.top < window.innerHeight + buffer) {\n                this.setState({\n                  ...this.state,\n                  load: true,\n                });\n                window.removeEventListener('scroll', listener);\n                this.scrollListener = null;\n              }\n            }\n          },\n          400,\n          {\n            leading: false,\n            trailing: true,\n          }\n        );\n        this.scrollListener = listener;\n\n        window.addEventListener('scroll', listener, {\n          capture: true,\n          passive: true,\n        });\n        listener();\n      }\n    }\n  }\n\n  // Allow our legacy `image` prop, as well as allow a `src` prop for more intuitive\n  // DX of manual usage (<Image src=\"...\" />)\n  get image() {\n    return this.props.image || this.props.src;\n  }\n\n  getSrcSet(): string | undefined {\n    const url = this.image;\n    if (!url) {\n      return;\n    }\n\n    // We can auto add srcset for cdn.builder.io and shopify\n    // images, otherwise you can supply this prop manually\n    if (!(url.match(/builder\\.io/) || url.match(/cdn\\.shopify\\.com/))) {\n      return;\n    }\n\n    return getSrcSet(url);\n  }\n\n  render() {\n    const { aspectRatio, lazy } = this.props;\n    const children = this.props.builderBlock && this.props.builderBlock.children;\n\n    let srcset = this.props.srcset;\n    const sizes = getSizes(this.props.sizes, this.props.builderBlock);\n    const image = this.image;\n\n    if (srcset && image && image.includes('builder.io/api/v1/image')) {\n      if (!srcset.includes(image.split('?')[0])) {\n        console.debug('Removed given srcset');\n        srcset = this.getSrcSet();\n      }\n    } else if (image && !srcset) {\n      srcset = this.getSrcSet();\n    }\n\n    const { fitContent } = this.props;\n\n    return (\n      <BuilderMetaContext.Consumer>\n        {value => {\n          const amp = value.ampMode;\n          const Tag: 'img' = amp ? ('amp-img' as any) : 'img';\n\n          const imageContents = (!lazy || this.state.load || amp) && (\n            <Tag\n              {...(amp\n                ? ({\n                    layout: 'responsive',\n                    height:\n                      this.props.height ||\n                      (aspectRatio ? Math.round(aspectRatio * 1000) : undefined),\n                    width:\n                      this.props.width ||\n                      (aspectRatio ? Math.round(1000 / aspectRatio) : undefined),\n                  } as any)\n                : null)}\n              alt={this.props.altText}\n              key={\n                Builder.isEditing\n                  ? (typeof this.image === 'string' && this.image.split('?')[0]) || undefined\n                  : undefined\n              }\n              role={!this.props.altText ? 'presentation' : undefined}\n              css={{\n                opacity: amp ? 1 : this.useLazyLoading && !this.state.imageLoaded ? 0 : 1,\n                transition: 'opacity 0.2s ease-in-out',\n                objectFit: this.props.backgroundSize || 'cover',\n                objectPosition: this.props.backgroundPosition || 'center',\n                ...(aspectRatio &&\n                  !amp && {\n                    position: 'absolute',\n                    height: '100%',\n                    width: '100%',\n                    left: 0,\n                    top: 0,\n                  }),\n                ...(amp && {\n                  ['& img']: {\n                    objectFit: this.props.backgroundSize,\n                    objectPosition: this.props.backgroundPosition,\n                  },\n                }),\n              }}\n              loading=\"lazy\"\n              className={'builder-image' + (this.props.className ? ' ' + this.props.className : '')}\n              src={this.image}\n              {...(!amp && {\n                // TODO: queue these so react renders all loads at once\n                onLoad: () => this.setState({ imageLoaded: true }),\n              })}\n              // TODO: memoize on image on client\n              srcSet={srcset}\n              sizes={!amp && sizes ? sizes : undefined}\n            />\n          );\n\n          return (\n            <React.Fragment>\n              {amp ? (\n                imageContents\n              ) : (\n                <picture ref={ref => (this.pictureRef = ref)}>\n                  {srcset && srcset.match(/builder\\.io/) && !this.props.noWebp && (\n                    <source srcSet={srcset.replace(/\\?/g, '?format=webp&')} type=\"image/webp\" />\n                  )}\n                  {imageContents}\n                </picture>\n              )}\n              {aspectRatio && !amp && !(fitContent && children && children.length) ? (\n                <div\n                  className=\"builder-image-sizer\"\n                  css={{\n                    width: '100%',\n                    paddingTop: aspectRatio * 100 + '%',\n                    pointerEvents: 'none',\n                    fontSize: 0,\n                  }}\n                >\n                  {' '}\n                </div>\n              ) : null}\n              {children && children.length ? (\n                fitContent ? (\n                  children.map((block: BuilderElement, index: number) => (\n                    <BuilderBlockComponent key={block.id} block={block} />\n                  ))\n                ) : (\n                  // TODO: if no aspect ratio and has children, don't make this absolute but instead\n                  // make the image absolute and fit the children (or with a special option)\n                  <div\n                    css={{\n                      display: 'flex',\n                      flexDirection: 'column',\n                      alignItems: 'stretch',\n                      position: 'absolute',\n                      top: 0,\n                      left: 0,\n                      width: '100%',\n                      height: '100%',\n                    }}\n                  >\n                    {children.map((block: BuilderElement, index: number) => (\n                      <BuilderBlockComponent key={block.id} block={block} />\n                    ))}\n                  </div>\n                )\n              ) : null}\n            </React.Fragment>\n          );\n        }}\n      </BuilderMetaContext.Consumer>\n    );\n  }\n}\n\nexport const Image = withBuilder(ImageComponent, {\n  name: 'Image',\n  static: true,\n  image:\n    'https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-insert_photo-24px.svg?alt=media&token=4e5d0ef4-f5e8-4e57-b3a9-38d63a9b9dc4',\n  defaultStyles: {\n    position: 'relative',\n    minHeight: '20px',\n    minWidth: '20px',\n    overflow: 'hidden',\n  },\n  canHaveChildren: true,\n  inputs: [\n    {\n      // TODO: new editor type 'responsiveImage' that can do different crops per breakpoint\n      // and sets an object and that is read here\n      name: 'image',\n      type: 'file',\n      bubble: true,\n      allowedFileTypes: ['jpeg', 'jpg', 'png', 'svg'],\n      required: true,\n      defaultValue:\n        'https://cdn.builder.io/api/v1/image/assets%2Fpwgjf0RoYWbdnJSbpBAjXNRMe9F2%2Ffb27a7c790324294af8be1c35fe30f4d',\n      onChange: (options: Map<string, any>) => {\n        const DEFAULT_ASPECT_RATIO = 0.7041;\n        options.delete('srcset');\n        options.delete('noWebp');\n        function loadImage(url: string, timeout = 60000): Promise<HTMLImageElement> {\n          return new Promise((resolve, reject) => {\n            const img = document.createElement('img');\n            let loaded = false;\n            img.onload = () => {\n              loaded = true;\n              resolve(img);\n            };\n\n            img.addEventListener('error', event => {\n              console.warn('Image load failed', event.error);\n              reject(event.error);\n            });\n\n            img.src = url;\n            setTimeout(() => {\n              if (!loaded) {\n                reject(new Error('Image load timed out'));\n              }\n            }, timeout);\n          });\n        }\n\n        function round(num: number) {\n          return Math.round(num * 1000) / 1000;\n        }\n\n        const value = options.get('image');\n        const aspectRatio = options.get('aspectRatio');\n\n        // For SVG images - don't render as webp, keep them as SVG\n        fetch(value)\n          .then(res => res.blob())\n          .then(blob => {\n            if (blob.type.includes('svg')) {\n              options.set('noWebp', true);\n            }\n          });\n\n        if (value && (!aspectRatio || aspectRatio === DEFAULT_ASPECT_RATIO)) {\n          return loadImage(value).then(img => {\n            const possiblyUpdatedAspectRatio = options.get('aspectRatio');\n            if (\n              options.get('image') === value &&\n              (!possiblyUpdatedAspectRatio || possiblyUpdatedAspectRatio === DEFAULT_ASPECT_RATIO)\n            ) {\n              if (img.width && img.height) {\n                options.set('aspectRatio', round(img.height / img.width));\n                options.set('height', img.height);\n                options.set('width', img.width);\n              }\n            }\n          });\n        }\n      },\n    },\n    {\n      name: 'backgroundSize',\n      type: 'text',\n      defaultValue: 'cover',\n      enum: [\n        {\n          label: 'contain',\n          value: 'contain',\n          helperText: 'The image should never get cropped',\n        },\n        {\n          label: 'cover',\n          value: 'cover',\n          helperText: `The image should fill it's box, cropping when needed`,\n        },\n        // TODO: add these options back\n        // { label: 'auto', value: 'auto', helperText: '' },\n        // { label: 'fill', value: 'fill', helperText: 'The image should fill the box, being stretched or squished if necessary' },\n      ] as any,\n    },\n    {\n      name: 'backgroundPosition',\n      type: 'text',\n      defaultValue: 'center',\n      enum: [\n        'center',\n        'top',\n        'left',\n        'right',\n        'bottom',\n        'top left',\n        'top right',\n        'bottom left',\n        'bottom right',\n      ],\n    },\n    {\n      name: 'altText',\n      type: 'string',\n      helperText: 'Text to display when the user has images off',\n    },\n    {\n      name: 'height',\n      type: 'number',\n      hideFromUI: true,\n    },\n    {\n      name: 'width',\n      type: 'number',\n      hideFromUI: true,\n    },\n    {\n      name: 'sizes',\n      type: 'string',\n      hideFromUI: true,\n    },\n    {\n      name: 'srcset',\n      type: 'string',\n      hideFromUI: true,\n    },\n    // TODO: force lazy load option (maybe via binding for now hm component.options.lazy: true)\n    {\n      name: 'lazy',\n      type: 'boolean',\n      defaultValue: true,\n      hideFromUI: true,\n    },\n    {\n      name: 'fitContent',\n      type: 'boolean',\n      helperText:\n        \"When child blocks are provided, fit to them instead of using the image's aspect ratio\",\n      defaultValue: true,\n    },\n    {\n      name: 'aspectRatio',\n      type: 'number',\n      helperText:\n        \"This is the ratio of height/width, e.g. set to 1.5 for a 300px wide and 200px tall photo. Set to 0 to not force the image to maintain it's aspect ratio\",\n      advanced: true,\n      defaultValue: DEFAULT_ASPECT_RATIO,\n    },\n    // {\n    //   name: 'backgroundRepeat',\n    //   type: 'text',\n    //   defaultValue: 'no-repeat',\n    //   enum: ['no-repeat', 'repeat', 'repeat-x', 'repeat-y'],\n    // },\n  ],\n});\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\n\nimport { throttle } from '../functions/throttle';\nimport { withChildren } from '../functions/with-children';\nimport { Builder } from '@builder.io/sdk';\n\nconst DEFAULT_ASPECT_RATIO = 0.7004048582995948;\n\nclass VideoComponent extends React.Component<{\n  video: string;\n  autoPlay?: boolean;\n  controls?: boolean;\n  muted?: boolean;\n  loop?: boolean;\n  playsInline?: boolean;\n  aspectRatio?: number;\n  width?: number;\n  height?: number;\n  fit?: 'contain' | 'cover' | 'fill';\n  position?: string;\n  posterImage?: string;\n  lazyLoad?: boolean;\n  fitContent?: boolean;\n}> {\n  video: HTMLVideoElement | null = null;\n  containerRef: HTMLElement | null = null;\n\n  scrollListener: null | ((e: Event) => void) = null;\n\n  get lazyLoad() {\n    // Default is true, must be explicitly turned off to not have this behavior\n    // as it's highly recommended for performance and bandwidth optimization\n    return this.props.lazyLoad !== false;\n  }\n\n  state = {\n    load: !this.lazyLoad,\n  };\n\n  updateVideo() {\n    if (this.video) {\n      const attributes: Array<'muted' | 'playsInline' | 'autoPlay'> = [\n        'muted',\n        'playsInline',\n        'autoPlay',\n      ];\n      attributes.forEach(attr => {\n        if (this.props[attr]) {\n          this.video?.setAttribute(attr.toLowerCase(), 'true');\n        } else {\n          this.video?.removeAttribute(attr.toLowerCase());\n        }\n      });\n    }\n  }\n\n  componentDidUpdate() {\n    this.updateVideo();\n  }\n\n  componentDidMount() {\n    this.updateVideo();\n\n    if (this.lazyLoad && Builder.isBrowser) {\n      // TODO: have a way to consolidate all listeners into one timer\n      // to avoid excessive reflows\n      const listener = throttle(\n        (event: Event) => {\n          if (this.containerRef) {\n            const rect = this.containerRef.getBoundingClientRect();\n            const buffer = window.innerHeight / 2;\n            if (rect.top < window.innerHeight + buffer) {\n              this.setState(state => ({\n                ...state,\n                load: true,\n              }));\n              window.removeEventListener('scroll', listener);\n              this.scrollListener = null;\n            }\n          }\n        },\n        400,\n        {\n          leading: false,\n          trailing: true,\n        }\n      );\n      this.scrollListener = listener;\n\n      window.addEventListener('scroll', listener, {\n        capture: true,\n        passive: true,\n      });\n      listener();\n    }\n  }\n\n  componentWillUnmount() {\n    if (Builder.isBrowser && this.scrollListener) {\n      window.removeEventListener('scroll', this.scrollListener);\n      this.scrollListener = null;\n    }\n  }\n\n  render() {\n    const { aspectRatio, children } = this.props;\n    return (\n      <div ref={ref => (this.containerRef = ref)} css={{ position: 'relative' }}>\n        {/* TODO: option to load the whole thing (inc. poster image) or just video */}\n        <video\n          key={this.props.video || 'no-src'}\n          poster={this.props.posterImage}\n          ref={ref => (this.video = ref)}\n          autoPlay={this.props.autoPlay}\n          muted={this.props.muted}\n          controls={this.props.controls}\n          loop={this.props.loop}\n          className=\"builder-video\"\n          css={{\n            width: '100%',\n            height: '100%',\n            objectFit: this.props.fit,\n            objectPosition: this.props.position,\n            // Hack to get object fit to work as expected and not have the video\n            // overflow\n            borderRadius: 1,\n            ...(aspectRatio\n              ? {\n                  position: 'absolute',\n                }\n              : null),\n          }}\n        >\n          {(!this.lazyLoad || this.state.load) && (\n            <source type=\"video/mp4\" src={this.props.video} />\n          )}\n        </video>\n        {aspectRatio && !(this.props.fitContent && children) ? (\n          <div\n            css={{\n              width: '100%',\n              paddingTop: aspectRatio * 100 + '%',\n              pointerEvents: 'none',\n              fontSize: 0,\n            }}\n          />\n        ) : null}\n        {children && this.props.fitContent ? (\n          <div css={{ display: 'flex', flexDirection: 'column', alignItems: 'stretch' }}>\n            {children}\n          </div>\n        ) : (\n          <div\n            css={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'stretch',\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              width: '100%',\n              height: '100%',\n            }}\n          >\n            {children}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport const Video = Builder.registerComponent(withChildren(VideoComponent), {\n  name: 'Video',\n  canHaveChildren: true,\n  defaultStyles: {\n    minHeight: '20px',\n    minWidth: '20px',\n  },\n  image:\n    'https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-videocam-24px%20(1).svg?alt=media&token=49a84e4a-b20e-4977-a650-047f986874bb',\n  inputs: [\n    {\n      name: 'video',\n      type: 'file',\n      allowedFileTypes: ['mp4'],\n      bubble: true,\n      defaultValue:\n        'https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/assets%2FKQlEmWDxA0coC3PK6UvkrjwkIGI2%2F28cb070609f546cdbe5efa20e931aa4b?alt=media&token=912e9551-7a7c-4dfb-86b6-3da1537d1a7f',\n      required: true,\n      onChange: (options: Map<string, any>) => {\n        const DEFAULT_ASPECT_RATIO = 0.7004048582995948;\n        function loadImage(url: string, timeout = 60000): Promise<HTMLImageElement> {\n          return new Promise((resolve, reject) => {\n            const img = document.createElement('img');\n            let loaded = false;\n            img.onload = () => {\n              loaded = true;\n              resolve(img);\n            };\n\n            img.addEventListener('error', event => {\n              console.warn('Image load failed', event.error);\n              reject(event.error);\n            });\n\n            img.src = url;\n            setTimeout(() => {\n              if (!loaded) {\n                reject(new Error('Image load timed out'));\n              }\n            }, timeout);\n          });\n        }\n\n        function round(num: number) {\n          return Math.round(num * 1000) / 1000;\n        }\n\n        // // TODO\n        const value = options.get('image');\n        const aspectRatio = options.get('aspectRatio');\n        if (value && (!aspectRatio || aspectRatio === DEFAULT_ASPECT_RATIO)) {\n          return loadImage(value).then(img => {\n            const possiblyUpdatedAspectRatio = options.get('aspectRatio');\n            if (\n              options.get('image') === value &&\n              (!possiblyUpdatedAspectRatio || possiblyUpdatedAspectRatio === DEFAULT_ASPECT_RATIO)\n            ) {\n              if (img.width && img.height) {\n                options.set('aspectRatio', round(img.height / img.width));\n              }\n            }\n          });\n        }\n      },\n    },\n    {\n      name: 'posterImage',\n      type: 'file',\n      allowedFileTypes: ['jpeg', 'png'],\n      helperText: 'Image to show before the video plays',\n    },\n    {\n      name: 'autoPlay',\n      type: 'boolean',\n      defaultValue: true,\n    },\n    {\n      name: 'controls',\n      type: 'boolean',\n      defaultValue: false,\n    },\n    {\n      name: 'muted',\n      type: 'boolean',\n      defaultValue: true,\n    },\n    {\n      name: 'loop',\n      type: 'boolean',\n      defaultValue: true,\n    },\n    {\n      name: 'playsInline',\n      type: 'boolean',\n      defaultValue: true,\n    },\n    {\n      name: 'fit',\n      type: 'text',\n      defaultValue: 'cover',\n      enum: ['contain', 'cover', 'fill', 'auto'],\n    },\n    {\n      name: 'fitContent',\n      type: 'boolean',\n      helperText: 'When child blocks are provided, fit to them instead of using the aspect ratio',\n      defaultValue: true,\n      advanced: true,\n    },\n    {\n      name: 'position',\n      type: 'text',\n      defaultValue: 'center',\n      enum: [\n        'center',\n        'top',\n        'left',\n        'right',\n        'bottom',\n        'top left',\n        'top right',\n        'bottom left',\n        'bottom right',\n      ],\n    },\n    {\n      name: 'height',\n      type: 'number',\n      advanced: true,\n    },\n    {\n      name: 'width',\n      type: 'number',\n      advanced: true,\n    },\n    {\n      name: 'aspectRatio',\n      type: 'number',\n      advanced: true,\n      defaultValue: DEFAULT_ASPECT_RATIO,\n    },\n    {\n      name: 'lazyLoad',\n      type: 'boolean',\n      helperText:\n        'Load this video \"lazily\" - as in only when a user scrolls near the video. Recommended for optmized performance and bandwidth consumption',\n      defaultValue: true,\n      advanced: true,\n    },\n  ],\n});\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\nimport { BuilderComponent } from '../components/builder-component.component';\nimport { Builder, BuilderElement } from '@builder.io/sdk';\nimport hash from 'hash-sum';\nimport { NoWrap } from '../components/no-wrap';\nimport { BuilderStoreContext } from '../store/builder-store';\nimport { withBuilder } from '../functions/with-builder';\n\nconst size = (thing: object) => Object.keys(thing).length;\n\nconst isShopify = Builder.isBrowser && 'Shopify' in window;\n\nconst refs: Record<string, Element> = {};\n\nif (Builder.isBrowser) {\n  try {\n    Array.from(document.querySelectorAll('[builder-static-symbol]')).forEach(el => {\n      const id = (el as HTMLDivElement).getAttribute('builder-static-symbol');\n      if (id) {\n        refs[id] = el;\n      }\n    });\n  } catch (err) {\n    console.error('Builder replace nodes error:', err);\n  }\n}\n\nexport interface SymbolInfo {\n  model?: string;\n  entry?: string;\n  data?: any;\n  content?: any;\n  inline?: boolean;\n  dynamic?: boolean;\n}\n\nexport interface SymbolProps {\n  symbol?: SymbolInfo;\n  dataOnly?: boolean;\n  dynamic?: boolean;\n  builderBlock?: BuilderElement;\n  attributes?: any;\n  inheritState?: boolean;\n}\n\nclass SymbolComponent extends React.Component<SymbolProps> {\n  ref: BuilderComponent | null = null;\n  staticRef: HTMLDivElement | null = null;\n\n  get placeholder() {\n    return (\n      <div css={{ padding: 10 }}>\n        Symbols let you reuse dynamic elements across your content. Please choose a model and entry\n        for this symbol.\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    if (this.useStatic && this.staticRef && refs[this.props.builderBlock?.id!]) {\n      this.staticRef.parentNode?.replaceChild(refs[this.props.builderBlock?.id!], this.staticRef);\n    }\n  }\n\n  get useStatic() {\n    return Boolean(\n      Builder.isBrowser &&\n        refs[this.props.builderBlock?.id!] &&\n        !(Builder.isEditing || Builder.isPreviewing)\n    );\n  }\n\n  render() {\n    if (this.useStatic) {\n      return <div ref={el => (this.staticRef = el)} />;\n    }\n\n    const symbol = this.props.symbol;\n\n    let showPlaceholder = false;\n\n    if (!symbol) {\n      showPlaceholder = true;\n    }\n\n    const TagName = this.props.dataOnly\n      ? NoWrap\n      : (this.props.builderBlock && this.props.builderBlock.tagName) || 'div';\n\n    const { model, entry, data, content, inline } = symbol || {};\n    const dynamic = symbol?.dynamic || this.props.dynamic;\n    if (!(model && (entry || dynamic)) && !content?.data?.blocksJs && !inline) {\n      showPlaceholder = true;\n    }\n\n    let key = dynamic ? undefined : [model, entry].join(':');\n    const dataString = Builder.isEditing ? null : data && size(data) && hash(data);\n\n    if (key && dataString && dataString.length < 300) {\n      key += ':' + dataString;\n    }\n\n    const attributes = this.props.attributes || {};\n    return (\n      <BuilderStoreContext.Consumer key={(model || 'no model') + ':' + (entry || 'no entry')}>\n        {state => {\n          return (\n            <TagName\n              data-model={model}\n              {...attributes}\n              className={\n                (attributes.class || attributes.className || '') +\n                ' builder-symbol' +\n                (symbol?.inline ? ' builder-inline-symbol' : '') +\n                (symbol?.dynamic || this.props.dynamic ? ' builder-dynamic-symbol' : '')\n              }\n            >\n              {showPlaceholder ? (\n                this.placeholder\n              ) : (\n                <BuilderComponent\n                  isChild\n                  ref={(ref: any) => (this.ref = ref)}\n                  context={{ ...state.context, symbolId: this.props.builderBlock?.id }}\n                  modelName={model}\n                  entry={entry}\n                  data={{\n                    ...data,\n                    ...(!!this.props.inheritState && state.state),\n                    ...this.props.builderBlock?.component?.options?.symbol?.content?.data?.state,\n                  }}\n                  renderLink={state.renderLink}\n                  inlineContent={symbol?.inline}\n                  {...(content && { content })}\n                  options={{ key, noEditorUpdates: true }}\n                  codegen={!!content?.data?.blocksJs}\n                  hydrate={state.state?._hydrate}\n                  builderBlock={this.props.builderBlock}\n                  dataOnly={this.props.dataOnly}\n                >\n                  {/* TODO: builder blocks option for loading stuff */}\n                  {this.props.children}\n                </BuilderComponent>\n              )}\n            </TagName>\n          );\n        }}\n      </BuilderStoreContext.Consumer>\n    );\n  }\n}\n\nexport const Symbol = withBuilder(SymbolComponent, {\n  // Builder:Symbol\n  name: 'Symbol',\n  noWrap: true,\n  static: true,\n  // TODO: allow getter for icon so different icon if data symbol hm,\n  // Maybe \"this\" context is the block element in editor, and it's the\n  // builderBlock json otherwise. In BuilderBlock decorator find any getters\n  // and convert to strings when passing and convert back to getters after\n  // with `this` bound\n  inputs: [\n    {\n      name: 'symbol',\n      type: 'uiSymbol',\n    },\n    {\n      name: 'dataOnly',\n      helperText: `Make this a data symbol that doesn't display any UI`,\n      type: 'boolean',\n      defaultValue: false,\n      advanced: true,\n      hideFromUI: true,\n    },\n    {\n      name: 'inheritState',\n      helperText: `Inherit the parent component state and data`,\n      type: 'boolean',\n      defaultValue: isShopify,\n      advanced: true,\n      hideFromUI: true,\n    },\n    {\n      name: 'renderToLiquid',\n      helperText:\n        'Render this symbols contents to liquid. Turn off to fetch with javascript and use custom targeting',\n      type: 'boolean',\n      defaultValue: isShopify,\n      advanced: true,\n      hideFromUI: true,\n    },\n    {\n      name: 'useChildren',\n      hideFromUI: true,\n      type: 'boolean',\n    },\n  ],\n});\n","import React from 'react';\nimport { withBuilder } from '../functions/with-builder';\nimport { Link } from '../components/Link';\n\nexport interface ButtonProps {\n  attributes?: any;\n  text?: string;\n  link?: string;\n  openLinkInNewTab?: boolean;\n}\n\nclass ButtonComponent extends React.Component<ButtonProps> {\n  render() {\n    const Tag = this.props.link ? Link : 'span';\n    return (\n      <Tag\n        href={this.props.link}\n        target={this.props.openLinkInNewTab ? '_blank' : undefined}\n        {...this.props.attributes}\n      >\n        {this.props.text}\n      </Tag>\n    );\n  }\n}\n\nexport const Button = withBuilder(ButtonComponent, {\n  name: 'Core:Button',\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F81a15681c3e74df09677dfc57a615b13',\n  defaultStyles: {\n    // TODO: make min width more intuitive and set one\n    appearance: 'none',\n    paddingTop: '15px',\n    paddingBottom: '15px',\n    paddingLeft: '25px',\n    paddingRight: '25px',\n    backgroundColor: '#3898EC',\n    color: 'white',\n    borderRadius: '4px',\n    textAlign: 'center',\n    cursor: 'pointer',\n  },\n  inputs: [\n    {\n      name: 'text',\n      type: 'text',\n      defaultValue: 'Click me!',\n      bubble: true,\n    },\n    {\n      name: 'link',\n      type: 'url',\n      bubble: true,\n    },\n    {\n      name: 'openLinkInNewTab',\n      type: 'boolean',\n      defaultValue: false,\n      friendlyName: 'Open link in new tab',\n    },\n  ],\n  static: true,\n  noWrap: true,\n});\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\nimport { BuilderElement } from '@builder.io/sdk';\nimport { BuilderBlock as BuilderBlockComponent } from '../components/builder-block.component';\nimport { withBuilder } from '../functions/with-builder';\n\ninterface SectionProps {\n  builderBlock?: BuilderElement;\n  verticalAlignContent?: string;\n  maxWidth?: number;\n}\n\nclass SectionComponent extends React.Component<SectionProps> {\n  render() {\n    return (\n      <div\n        css={{\n          width: '100%',\n          // height: '100%' was is here so the inner contents can align center, but that is causing\n          // issues in Safari. Need another workaround.\n          alignSelf: 'stretch',\n          flexGrow: 1,\n          boxSizing: 'border-box',\n          maxWidth: this.props.maxWidth,\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'stretch',\n          marginLeft: 'auto',\n          marginRight: 'auto',\n        }}\n      >\n        {this.props.children}\n        {/* TODO: maybe builder <BuilderBlocks? */}\n        {this.props.builderBlock &&\n          this.props.builderBlock.children &&\n          this.props.builderBlock.children.map((block, index) => (\n            <BuilderBlockComponent key={block.id} block={block} />\n          ))}\n        {/* <BuilderBlocks blocks={this.builderBlock.children} dataPath=\"children\" emailMode /> */}\n      </div>\n    );\n  }\n}\n\nexport const Section = withBuilder(SectionComponent, {\n  name: 'Core:Section',\n  static: true,\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F682efef23ace49afac61748dd305c70a',\n  inputs: [\n    {\n      name: 'maxWidth',\n      type: 'number',\n      defaultValue: 1200,\n    },\n  ],\n  defaultStyles: {\n    paddingLeft: '20px',\n    paddingRight: '20px',\n    paddingTop: '50px',\n    paddingBottom: '50px',\n    marginTop: '0px',\n    width: '100vw',\n    marginLeft: 'calc(50% - 50vw)',\n  },\n  canHaveChildren: true,\n\n  // TODO: defaults that deep merge and can be anyting - responsive styles, etc\n  defaultChildren: [\n    {\n      '@type': '@builder.io/sdk:Element',\n      responsiveStyles: {\n        large: {\n          textAlign: 'center',\n        },\n      },\n      component: {\n        name: 'Text',\n        options: {\n          text:\n            \"<p><b>I am a section! My content keeps from getting too wide, so that it's easy to read even on big screens.</b></p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur</p>\",\n        },\n      },\n    },\n  ],\n  // TODO\n  // defaultChildren: ..\n\n  // Share these hooks across the projects\n  // hooks: {\n  //   'BlocksOverlay::debounceNextTickUpdateStyles#updateStyles': () => convert margin selectors to paddings of table\n  //   '@builder.io/app:Style.foo': () => { /* ... */ } // maybe optionally async\n  // }\n});\n","import React from 'react';\nimport { BuilderElement } from '@builder.io/sdk';\nimport { BuilderBlock as BuilderBlockComponent } from '../components/builder-block.component';\nimport { BuilderStoreContext } from '../store/builder-store';\nimport { withBuilder } from '../functions/with-builder';\n\ninterface StateProviderProps {\n  builderBlock?: BuilderElement;\n  state: any;\n  context?: any;\n}\n\nclass StateProviderComponent extends React.Component<StateProviderProps> {\n  render() {\n    return (\n      <BuilderStoreContext.Consumer>\n        {state => (\n          <BuilderStoreContext.Provider\n            value={{\n              ...state,\n              state: {\n                ...state.state,\n                ...this.props.state,\n              },\n              context: {\n                ...state.context,\n                ...this.props.context,\n              },\n            }}\n          >\n            {this.props.builderBlock &&\n              this.props.builderBlock.children &&\n              this.props.builderBlock.children.map((block, index) => (\n                <BuilderBlockComponent block={block} key={block.id} index={index} child={true} />\n              ))}\n            {this.props.children}\n          </BuilderStoreContext.Provider>\n        )}\n      </BuilderStoreContext.Consumer>\n    );\n  }\n}\n\nexport const StateProvider = withBuilder(StateProviderComponent, {\n  name: 'Builder:StateProvider',\n  // TODO: default children\n  canHaveChildren: true,\n  static: true,\n  noWrap: true,\n  hideFromInsertMenu: true,\n});\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\nimport { BuilderElement, builder, Builder } from '@builder.io/sdk';\nimport { BuilderStoreContext } from '../store/builder-store';\nimport { BuilderComponent } from '../components/builder-component.component';\nimport { withBuilder } from '../functions/with-builder';\n\nexport interface RouterProps {\n  model?: string;\n  data?: string;\n  content?: any;\n  handleRouting?: boolean;\n  builderBlock?: BuilderElement;\n  preloadOnHover?: boolean;\n  onRoute?: (routeEvent: RouteEvent) => void;\n}\n\nconst prefetched = new Set();\n\nfunction searchToObject(location: Location) {\n  const pairs = (location.search || '').substring(1).split('&');\n  const obj: { [key: string]: string } = {};\n\n  for (const i in pairs) {\n    if (!(pairs[i] && typeof pairs[i] === 'string')) {\n      continue;\n    }\n    const pair = pairs[i].split('=');\n    obj[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n  }\n\n  return obj;\n}\n\nexport interface RouteEvent {\n  /**\n   * Url being routed to\n   */\n  url: string;\n  /**\n   * Html anchor element the href is on that\n   * caused the route\n   */\n  anchorNode: HTMLAnchorElement;\n  /**\n   * Has preventDefault() been called preventing\n   * builder from routing to the clicked URL\n   */\n  defaultPrevented: boolean;\n  /**\n   * Prevents builder from handling routing for you to handle\n   * yourself\n   */\n  preventDefault(): void;\n}\n\nclass RouterComponent extends React.Component<RouterProps> {\n  builder = builder;\n\n  routed = false;\n\n  private preloadQueue = 0;\n\n  // TODO: handle route to same url as current (do nothing)\n  // TODO: replaceState option\n  public route(url: string) {\n    this.routed = true;\n\n    // TODO: check if relative?\n    if (window.history && window.history.pushState) {\n      history.pushState(null, '', url);\n      this.updateLocationState();\n      return true;\n    } else {\n      location.href = url;\n      return false;\n    }\n  }\n\n  private updateLocationState() {\n    if (this.privateState) {\n      // Reload path info\n      this.privateState.update(obj => {\n        // TODO: force always override the location path info... hmm\n        obj.location = {\n          ...obj.location,\n          pathname: location.pathname,\n          search: location.search,\n          path: location.pathname.split('/').slice(1),\n          query: searchToObject(location),\n        };\n      });\n    }\n  }\n\n  private get model() {\n    return this.props.model || 'page';\n  }\n\n  componentDidMount() {\n    if (typeof document !== 'undefined') {\n      document.addEventListener('click', this.onClick);\n      window.addEventListener('popstate', this.onPopState);\n      document.addEventListener('mouseover', this.onMouseOverOrTouchStart);\n      document.addEventListener('touchstart', this.onMouseOverOrTouchStart);\n    }\n  }\n\n  componentWillUnmount() {\n    if (typeof document !== 'undefined') {\n      document.removeEventListener('click', this.onClick);\n      document.removeEventListener('mouseover', this.onMouseOverOrTouchStart);\n      window.removeEventListener('popstate', this.onPopState);\n      document.removeEventListener('touchstart', this.onMouseOverOrTouchStart);\n    }\n  }\n\n  private onPopState = (event: Event) => {\n    this.updateLocationState();\n  };\n\n  private onMouseOverOrTouchStart = (event: MouseEvent | TouchEvent) => {\n    if (this.preloadQueue > 4) {\n      return;\n    }\n\n    if (this.props.preloadOnHover === false) {\n      return;\n    }\n\n    const hrefTarget = this.findHrefTarget(event);\n    if (!hrefTarget) {\n      return;\n    }\n\n    let href = hrefTarget.getAttribute('href');\n    if (!href) {\n      return;\n    }\n\n    // TODO: onPreload hook and preload dom event\n    // Also allow that to be defaultPrevented to cancel this behavior\n    if (!this.isRelative(href)) {\n      const converted = this.convertToRelative(href);\n      if (converted) {\n        href = converted;\n      } else {\n        return;\n      }\n    }\n\n    if (href.startsWith('#')) {\n      return;\n    }\n\n    if (prefetched.has(href)) {\n      return;\n    }\n    prefetched.add(href);\n\n    const parsedUrl = this.parseUrl(href);\n\n    // TODO: override location!\n    this.preloadQueue++;\n\n    // TODO: use builder from context\n    const attributes = builder.getUserAttributes();\n    attributes.urlPath = parsedUrl.pathname;\n    attributes.queryString = parsedUrl.search;\n\n    // Should be queue?\n    const subscription = builder\n      .get(this.model, {\n        userAttributes: attributes,\n        key: this.model + ':' + parsedUrl.pathname + parsedUrl.search,\n      })\n      .subscribe(() => {\n        this.preloadQueue--;\n        subscription.unsubscribe();\n      });\n  };\n\n  private onClick = async (event: MouseEvent) => {\n    if (this.props.handleRouting === false) {\n      return;\n    }\n\n    if (event.button !== 0 || event.ctrlKey || event.defaultPrevented || event.metaKey) {\n      // If this is a non-left click, or the user is holding ctr/cmd, or the url is absolute,\n      // or if the link has a target attribute, don't route on the client and let the default\n      // href property handle the navigation\n      return;\n    }\n\n    const hrefTarget = this.findHrefTarget(event);\n    if (!hrefTarget) {\n      return;\n    }\n\n    // target=\"_blank\" or target=\"_self\" etc\n    if (hrefTarget.target && hrefTarget.target !== '_client') {\n      return;\n    }\n\n    let href = hrefTarget.getAttribute('href');\n    if (!href) {\n      return;\n    }\n\n    if (this.props.onRoute) {\n      const routeEvent: RouteEvent = {\n        url: href,\n        anchorNode: hrefTarget,\n        preventDefault() {\n          this.defaultPrevented = true;\n        },\n        defaultPrevented: false,\n      };\n\n      this.props.onRoute(routeEvent);\n\n      if (routeEvent.defaultPrevented) {\n        // Wait should this be here? they may want browser to handle this by deault preventing ours...\n        // event.preventDefault()\n        return;\n      }\n    }\n\n    if (!this.isRelative(href)) {\n      const converted = this.convertToRelative(href);\n      if (converted) {\n        href = converted;\n      } else {\n        return;\n      }\n    }\n\n    if (href.startsWith('#')) {\n      return;\n    }\n\n    // Otherwise if this url is relative, navigate on the client\n    event.preventDefault();\n\n    this.route(href);\n  };\n\n  render() {\n    const { model } = this;\n    return (\n      <BuilderStoreContext.Consumer>\n        {state => {\n          this.privateState = state;\n          // TODO: useEffect based on this that fetches new data and\n          // populates as content={} param for fast updates\n          const url =\n            state.state &&\n            state.state.location &&\n            state.state.location.pathname + state.state.location.search;\n\n          return (\n            <div className=\"builder-router\" data-model={model}>\n              {/* TODO: move to emotion */}\n              <style>{`\n                @keyframes builderLoadingSpinner {\n                  0% {\n                    transform: rotate(0deg);\n                  }\n                  100% {\n                    transform: rotate(360deg);\n                  }\n                }\n                /* TODO: overridable tag */\n                .builder-page-loading {\n                  -webkit-animation: builderLoadingSpinner 1s infinite linear;\n                  animation: builderLoadingSpinner 1s infinite linear;\n                  -webkit-transform: translateZ(0);\n                  transform: translateZ(0);\n                  border-radius: 50%;\n                  width: 36px;\n                  height: 36px;\n                  margin: 6px auto;\n                  position: relative;\n                  border: 1px solid transparent;\n                  border-left: 1px solid #808284;\n                }\n              `}</style>\n              <BuilderComponent\n                // TODO: this key strategy is inidial bc it gives loading for full page when fetching content\n                // Also sometimes content flashes to loading even when it's already precached in memory and should immediately display\n                // - why\n                key={url}\n                data={this.props.data}\n                content={this.routed ? undefined : this.props.content}\n                modelName={model}\n                options={{\n                  key: Builder.isEditing ? undefined : this.model + ':' + url, // TODO: other custom targets specify if should refetch components on change\n                }}\n              >\n                {/* TODO: builder blocks option for loading stuff */}\n                {/* TODO: input for builder blocks for this */}\n                {this.props.children || (\n                  <div css={{ display: 'flex' }}>\n                    <div css={{ margin: '40vh auto' }} className=\"builder-page-loading\" />\n                  </div>\n                )}\n              </BuilderComponent>\n            </div>\n          );\n        }}\n      </BuilderStoreContext.Consumer>\n    );\n  }\n\n  private findHrefTarget(event: MouseEvent | TouchEvent): HTMLAnchorElement | null {\n    // TODO: move to core\n    let element = event.target as HTMLElement | null;\n\n    while (element) {\n      if (element instanceof HTMLAnchorElement && element.getAttribute('href')) {\n        return element;\n      }\n\n      if (element === event.currentTarget) {\n        break;\n      }\n\n      element = element.parentElement;\n    }\n\n    return null;\n  }\n\n  private isRelative(href: string) {\n    return !href.match(/^(\\/\\/|https?:\\/\\/)/i);\n  }\n\n  private privateState: {\n    state: any;\n    update: (mutator: (state: any) => any) => void;\n  } | null = null;\n\n  // This method can only be called client side only. It is only invoked on click events\n  private parseUrl(url: string) {\n    const a = document.createElement('a');\n    a.href = url;\n    return a;\n  }\n\n  private convertToRelative(href: string): string | null {\n    const currentUrl = this.parseUrl(location.href);\n    const hrefUrl = this.parseUrl(href);\n\n    if (currentUrl.host === hrefUrl.host) {\n      const relativeUrl = hrefUrl.pathname + (hrefUrl.search ? hrefUrl.search : '');\n\n      if (relativeUrl.startsWith('#')) {\n        return null;\n      }\n      return relativeUrl || '/';\n    }\n\n    return null;\n  }\n}\n\nexport const Router = withBuilder(RouterComponent, {\n  name: 'Core:Router',\n  hideFromInsertMenu: true,\n  // TODO: advanced: true\n  inputs: [\n    {\n      // TODO: search picker\n      name: 'model',\n      type: 'string',\n      defaultValue: 'page',\n      advanced: true,\n    },\n    {\n      name: 'handleRouting',\n      type: 'boolean',\n      defaultValue: true,\n      advanced: true,\n    },\n    {\n      name: 'preloadOnHover',\n      type: 'boolean',\n      defaultValue: true,\n      advanced: true,\n    },\n    {\n      name: 'onRoute',\n      type: 'function',\n      advanced: true,\n      // Subfields are function arguments - object with properties\n    },\n  ],\n});\n","export const get = (obj: any, path: string, defaultValue?: any) => {\n  const result = String.prototype.split\n    .call(path, /[,[\\].]+?/)\n    .filter(Boolean)\n    .reduce((res, key) => (res !== null && res !== undefined ? res[key] : res), obj);\n  return result === undefined || result === obj ? defaultValue : result;\n};\n","/** @jsx jsx */\nimport { jsx } from '@emotion/core';\nimport React from 'react';\nimport { BuilderBlock as BuilderBlockComponent } from '../../components/builder-block.component';\nimport { BuilderElement, Builder, builder } from '@builder.io/sdk';\nimport { BuilderBlocks } from '../../components/builder-blocks.component';\nimport { BuilderStoreContext } from '../../store/builder-store';\nimport { set } from '../../functions/set';\nimport { get } from '../../functions/get';\nimport { withBuilder } from '../../functions/with-builder';\n\nexport interface FormProps {\n  attributes?: any;\n  name?: string;\n  action?: string;\n  validate?: boolean;\n  method?: string;\n  builderBlock?: BuilderElement;\n  sendSubmissionsTo?: string;\n  sendSubmissionsToEmail?: string;\n  sendWithJs?: boolean;\n  contentType?: string;\n  customHeaders?: { [key: string]: string };\n  successUrl?: string;\n  previewState?: string;\n  successMessage?: BuilderElement[];\n  errorMessage?: BuilderElement[];\n  sendingMessage?: BuilderElement[];\n  resetFormOnSubmit?: boolean;\n  errorMessagePath?: string;\n}\n\nclass FormComponent extends React.Component<FormProps> {\n  ref: HTMLFormElement | null = null;\n\n  // TODO: link this state to global state and allow togglign the modes in\n  // the style and or data editor. TODO: for now some kind of input for preview state\n  // that only impacts in the editor?\n  state = {\n    state: 'unsubmitted' as 'unsubmitted' | 'sending' | 'success' | 'error',\n    // TODO: separate response and error?\n    responseData: null as any,\n    formErrorMessage: '',\n  };\n\n  get submissionState() {\n    return (Builder.isEditing && this.props.previewState) || this.state.state;\n  }\n\n  render() {\n    return (\n      // TODO: JS data bindings\n      <BuilderStoreContext.Consumer>\n        {state => (\n          <BuilderStoreContext.Provider\n            value={{\n              ...state,\n              state: {\n                ...state.state,\n                formErrorMessage: this.state.formErrorMessage,\n              },\n            }}\n          >\n            <form\n              validate={this.props.validate}\n              ref={ref => (this.ref = ref)}\n              action={!this.props.sendWithJs && this.props.action}\n              method={this.props.method}\n              name={this.props.name}\n              onSubmit={event => {\n                const sendWithJs =\n                  this.props.sendWithJs || this.props.sendSubmissionsTo === 'email';\n                // TODO: custom validate event that can preventDefault and use ref or event to set\n                // invalid message\n                if (this.props.sendSubmissionsTo === 'zapier') {\n                  event.preventDefault();\n                  // TODO: send submission to zapier\n                } else if (sendWithJs) {\n                  if (!(this.props.action || this.props.sendSubmissionsTo === 'email')) {\n                    event.preventDefault();\n                    return;\n                  }\n                  event.preventDefault();\n\n                  // TODO: error and success state\n                  const el = event.currentTarget;\n                  const headers = this.props.customHeaders || {};\n\n                  let body: any;\n\n                  const formData = new FormData(el);\n\n                  // TODO: maybe support null\n                  const formPairs: {\n                    key: string;\n                    value: File | boolean | number | string | FileList;\n                  }[] = Array.from(event.currentTarget.querySelectorAll('input,select,textarea'))\n                    .filter(el => !!(el as HTMLInputElement).name)\n                    .map(el => {\n                      let value: any;\n                      const key = (el as HTMLImageElement).name;\n                      if (el instanceof HTMLInputElement) {\n                        if (el.type === 'radio') {\n                          if (el.checked) {\n                            value = el.name;\n                            return { key, value };\n                          }\n                        } else if (el.type === 'checkbox') {\n                          value = el.checked;\n                        } else if (el.type === 'number' || el.type === 'range') {\n                          const num = el.valueAsNumber;\n                          if (!isNaN(num)) {\n                            value = num;\n                          }\n                        } else if (el.type === 'file') {\n                          // TODO: one vs multiple files\n                          value = el.files;\n                        } else {\n                          value = el.value;\n                        }\n                      } else {\n                        value = (el as HTMLInputElement).value;\n                      }\n\n                      return { key, value };\n                    });\n\n                  let contentType = this.props.contentType;\n\n                  if (this.props.sendSubmissionsTo === 'email') {\n                    contentType = 'multipart/form-data';\n                  }\n\n                  Array.from(formPairs).forEach(({ value }) => {\n                    if (\n                      value instanceof File ||\n                      (Array.isArray(value) && value[0] instanceof File) ||\n                      value instanceof FileList\n                    ) {\n                      contentType = 'multipart/form-data';\n                    }\n                  });\n\n                  // TODO: send as urlEncoded or multipart by default\n                  // because of ease of use and reliability in browser API\n                  // for encoding the form?\n                  if (contentType !== 'application/json') {\n                    body = formData;\n                  } else {\n                    // Json\n                    const json = {};\n\n                    Array.from(formPairs).forEach(({ value, key }) => {\n                      set(json, key, value);\n                    });\n\n                    body = JSON.stringify(json);\n                  }\n\n                  if (contentType && contentType !== 'multipart/form-data') {\n                    if (\n                      // Zapier doesn't allow content-type header to be sent from browsers\n                      !(sendWithJs && this.props.action?.includes('zapier.com'))\n                    ) {\n                      headers['content-type'] = contentType;\n                    }\n                  }\n\n                  const presubmitEvent = new CustomEvent('presubmit', {\n                    detail: {\n                      body,\n                    },\n                  });\n                  if (this.ref) {\n                    this.ref.dispatchEvent(presubmitEvent);\n                    if (presubmitEvent.defaultPrevented) {\n                      return;\n                    }\n                  }\n\n                  this.setState({\n                    ...this.state,\n                    state: 'sending',\n                  });\n\n                  const formUrl = `${\n                    builder.env === 'dev' ? 'http://localhost:5000' : 'https://builder.io'\n                  }/api/v1/form-submit?apiKey=${builder.apiKey}&to=${btoa(\n                    this.props.sendSubmissionsToEmail || ''\n                  )}&name=${encodeURIComponent(this.props.name || '')}`;\n\n                  fetch(\n                    this.props.sendSubmissionsTo === 'email' ? formUrl : this.props.action!, // TODO: throw error if no action URL\n                    {\n                      body,\n                      headers,\n                      method: this.props.method || 'post',\n                    }\n                  ).then(\n                    async res => {\n                      let body;\n                      const contentType = res.headers.get('content-type');\n                      if (contentType && contentType.indexOf('application/json') !== -1) {\n                        body = await res.json();\n                      } else {\n                        body = await res.text();\n                      }\n\n                      if (!res.ok && this.props.errorMessagePath) {\n                        // TODO: allow supplying an error formatter function\n                        let message = get(body, this.props.errorMessagePath);\n\n                        if (message) {\n                          if (typeof message !== 'string') {\n                            // TODO: ideally convert json to yaml so it woul dbe like\n                            // error: - email has been taken\n                            message = JSON.stringify(message);\n                          }\n                          this.setState({\n                            ...this.state,\n                            formErrorMessage: message,\n                          });\n                        }\n                      }\n\n                      this.setState({\n                        ...this.state,\n                        responseData: body,\n                        state: res.ok ? 'success' : 'error',\n                      });\n\n                      if (res.ok) {\n                        // TODO: send submit success event\n\n                        const submitSuccessEvent = new CustomEvent('submit:success', {\n                          detail: {\n                            res,\n                            body,\n                          },\n                        });\n                        if (this.ref) {\n                          this.ref.dispatchEvent(submitSuccessEvent);\n                          if (submitSuccessEvent.defaultPrevented) {\n                            return;\n                          }\n                          // TODO: option to turn this on/off?\n                          if (this.props.resetFormOnSubmit !== false) {\n                            this.ref.reset();\n                          }\n                        }\n\n                        // TODO: client side route event first that can be preventDefaulted\n                        if (this.props.successUrl) {\n                          if (this.ref) {\n                            const event = new CustomEvent('route', {\n                              detail: {\n                                url: this.props.successUrl,\n                              },\n                            });\n                            this.ref.dispatchEvent(event);\n                            if (!event.defaultPrevented) {\n                              location.href = this.props.successUrl;\n                            }\n                          } else {\n                            location.href = this.props.successUrl;\n                          }\n                        }\n                      }\n                    },\n                    err => {\n                      const submitErrorEvent = new CustomEvent('submit:error', {\n                        detail: {\n                          error: err,\n                        },\n                      });\n                      if (this.ref) {\n                        this.ref.dispatchEvent(submitErrorEvent);\n                        if (submitErrorEvent.defaultPrevented) {\n                          return;\n                        }\n                      }\n\n                      // TODO: send submit error event\n                      this.setState({\n                        ...this.state,\n                        responseData: err,\n                        state: 'error',\n                      });\n                    }\n                  );\n                }\n              }}\n              {...this.props.attributes}\n            >\n              {/* TODO: maybe BuilderBlocks */}\n              {this.props.builderBlock &&\n                this.props.builderBlock.children &&\n                this.props.builderBlock.children.map((block, index) => (\n                  <BuilderBlockComponent key={block.id} block={block} />\n                ))}\n\n              {this.submissionState === 'error' && (\n                <BuilderBlocks dataPath=\"errorMessage\" blocks={this.props.errorMessage!} />\n              )}\n\n              {this.submissionState === 'sending' && (\n                <BuilderBlocks dataPath=\"sendingMessage\" blocks={this.props.sendingMessage!} />\n              )}\n\n              {/* TODO: option to turn this off */}\n              {this.submissionState === 'error' && this.state.responseData && (\n                // TODO: tag to edit\n                <pre\n                  className=\"builder-form-error-text\"\n                  css={{ padding: 10, color: 'red', textAlign: 'center' }}\n                >\n                  {JSON.stringify(this.state.responseData, null, 2)}\n                </pre>\n              )}\n\n              {this.submissionState === 'success' && (\n                <BuilderBlocks dataPath=\"successMessage\" blocks={this.props.successMessage!} />\n              )}\n            </form>\n          </BuilderStoreContext.Provider>\n        )}\n      </BuilderStoreContext.Consumer>\n    );\n  }\n}\n\nexport const Form = withBuilder(FormComponent, {\n  name: 'Form:Form',\n  // editableTags: ['builder-form-error']\n  defaults: {\n    responsiveStyles: {\n      large: {\n        marginTop: '15px',\n        paddingBottom: '15px',\n      },\n    },\n  },\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fef36d2a846134910b64b88e6d18c5ca5',\n  inputs: [\n    {\n      name: 'sendSubmissionsTo',\n      type: 'string',\n      // TODO: save to builder data and user can download as csv\n      // TODO: easy for mode too or computed add/remove fields form mode\n      // so you can edit details and high level mode at same time...\n      // Later - more integrations like mailchimp\n      // /api/v1/form-submit?to=mailchimp\n      enum: [\n        {\n          label: 'Send to email',\n          value: 'email',\n          helperText: 'Send form submissions to the email address of your choosing',\n        },\n        {\n          label: 'Custom',\n          value: 'custom',\n          helperText:\n            'Handle where the form requests go manually with a little code, e.g. to your own custom backend',\n        },\n      ],\n      defaultValue: 'email',\n    },\n    {\n      name: 'sendSubmissionsToEmail',\n      type: 'string',\n      required: true, // TODO: required: () => options.get(\"sendSubmissionsTo\") === \"email\"\n      defaultValue: 'your@email.com',\n      showIf: 'options.get(\"sendSubmissionsTo\") === \"email\"',\n    },\n    {\n      name: 'sendWithJs',\n      type: 'boolean',\n      helperText: 'Set to false to use basic html form action',\n      defaultValue: true,\n      showIf: 'options.get(\"sendSubmissionsTo\") === \"custom\"',\n    },\n    {\n      name: 'name',\n      type: 'string',\n      defaultValue: 'My form',\n      // advanced: true\n    },\n    {\n      name: 'action',\n      type: 'string',\n      helperText: 'URL to send the form data to',\n      showIf: 'options.get(\"sendSubmissionsTo\") === \"custom\"',\n    },\n    {\n      name: 'contentType',\n      type: 'string',\n      defaultValue: 'application/json',\n      advanced: true,\n      // TODO: do automatically if file input\n      enum: ['application/json', 'multipart/form-data', 'application/x-www-form-urlencoded'],\n      showIf: 'options.get(\"sendSubmissionsTo\") === \"custom\" && options.get(\"sendWithJs\") === true',\n    },\n    {\n      name: 'method',\n      type: 'string',\n      showIf: 'options.get(\"sendSubmissionsTo\") === \"custom\"',\n      advanced: true,\n    },\n    {\n      name: 'previewState',\n      type: 'string',\n      // TODO: persist: false flag\n      enum: ['unsubmitted', 'sending', 'success', 'error'],\n      defaultValue: 'unsubmitted',\n      helperText:\n        'Choose a state to edit, e.g. choose \"success\" to show what users see on success and edit the message',\n      showIf: 'options.get(\"sendSubmissionsTo\") !== \"zapier\" && options.get(\"sendWithJs\") === true',\n    },\n    {\n      name: 'successUrl',\n      type: 'url',\n      helperText: 'Optional URL to redirect the user to on form submission success',\n      showIf: 'options.get(\"sendSubmissionsTo\") !== \"zapier\" && options.get(\"sendWithJs\") === true',\n    },\n    {\n      name: 'resetFormOnSubmit',\n      type: 'boolean',\n      showIf: options =>\n        options.get('sendSubmissionsTo') === 'custom' && options.get('sendWithJs') === true,\n      advanced: true,\n    },\n    {\n      name: 'successMessage',\n      type: 'uiBlocks',\n      hideFromUI: true,\n      defaultValue: [\n        {\n          '@type': '@builder.io/sdk:Element',\n          responsiveStyles: {\n            large: {\n              marginTop: '10px',\n            },\n          },\n          component: {\n            name: 'Text',\n            options: {\n              text: '<span>Thanks!</span>',\n            },\n          },\n        },\n      ],\n    },\n    {\n      name: 'validate',\n      type: 'boolean',\n      defaultValue: true,\n      advanced: true,\n    },\n    {\n      name: 'errorMessagePath',\n      type: 'text',\n      advanced: true,\n      helperText:\n        'Path to where to get the error message from in a JSON response to display to the user, e.g. \"error.message\" for a response like { \"error\": { \"message\": \"this username is taken\" }}',\n    },\n    {\n      name: 'errorMessage',\n      type: 'uiBlocks',\n      hideFromUI: true,\n      defaultValue: [\n        {\n          '@type': '@builder.io/sdk:Element',\n          responsiveStyles: {\n            large: {\n              marginTop: '10px',\n            },\n          },\n          bindings: {\n            'component.options.text': 'state.formErrorMessage || block.component.options.text',\n          },\n          component: {\n            name: 'Text',\n            options: {\n              // TODO: how pull in API message\n              text: '<span>Form submission error :( Please check your answers and try again</span>',\n            },\n          },\n        },\n      ],\n    },\n    {\n      name: 'sendingMessage',\n      type: 'uiBlocks',\n      hideFromUI: true,\n      defaultValue: [\n        {\n          '@type': '@builder.io/sdk:Element',\n          responsiveStyles: {\n            large: {\n              marginTop: '10px',\n            },\n          },\n          component: {\n            name: 'Text',\n            options: {\n              // TODO: how pull in API message\n              text: '<span>Sending...</span>',\n            },\n          },\n        },\n      ],\n    },\n    {\n      name: 'customHeaders',\n      type: 'map',\n      // TODO: add typings for this property\n      ...({\n        valueType: {\n          type: 'string',\n        },\n      } as any),\n      advanced: true,\n      showIf: 'options.get(\"sendSubmissionsTo\") === \"custom\" && options.get(\"sendWithJs\") === true',\n    },\n    // TODO: custom headers or any fetch options\n    // TODO: json vs serialized (i.e. send on client or not)\n    // TODO: success/fail stuff\n  ],\n  noWrap: true,\n  // TODO: defaultChildren with two inputs and submit button\n  canHaveChildren: true,\n  defaultChildren: [\n    {\n      '@type': '@builder.io/sdk:Element',\n      responsiveStyles: {\n        large: {\n          marginTop: '10px',\n        },\n      },\n      component: {\n        name: 'Text',\n        options: {\n          text: '<span>Enter your name</span>',\n        },\n      },\n    },\n    {\n      '@type': '@builder.io/sdk:Element',\n      responsiveStyles: {\n        large: {\n          marginTop: '10px',\n        },\n      },\n      component: {\n        name: 'Form:Input',\n        options: {\n          name: 'name',\n          placeholder: 'Jane Doe',\n        },\n      },\n    },\n    {\n      '@type': '@builder.io/sdk:Element',\n      responsiveStyles: {\n        large: {\n          marginTop: '10px',\n        },\n      },\n      component: {\n        name: 'Text',\n        options: {\n          text: '<span>Enter your email</span>',\n        },\n      },\n    },\n    {\n      '@type': '@builder.io/sdk:Element',\n      responsiveStyles: {\n        large: {\n          marginTop: '10px',\n        },\n      },\n      component: {\n        name: 'Form:Input',\n        options: {\n          name: 'email',\n          placeholder: 'jane@doe.com',\n        },\n      },\n    },\n    {\n      '@type': '@builder.io/sdk:Element',\n      responsiveStyles: {\n        large: {\n          marginTop: '10px',\n        },\n      },\n      component: {\n        name: 'Form:SubmitButton',\n        options: {\n          text: 'Submit',\n        },\n      },\n    },\n  ],\n});\n","import React from 'react';\nimport { Builder } from '@builder.io/sdk';\nimport { withBuilder } from '../../functions/with-builder';\n\n// TODO: how do onchange...\n// TODO: actions all custom events and custom js gets\n// passed an element reference and listens for events....\n// Needs to unsubscribe, so must manage\nexport interface FormInputProps {\n  type?: string;\n  attributes?: any;\n  name?: string;\n  value?: string;\n  placeholder?: string;\n  defaultValue?: string;\n  required?: boolean;\n}\n\nclass FormInputComponent extends React.Component<FormInputProps> {\n  render() {\n    return (\n      <input\n        key={Builder.isEditing && this.props.defaultValue ? this.props.defaultValue : 'default-key'}\n        placeholder={this.props.placeholder}\n        type={this.props.type}\n        name={this.props.name}\n        value={this.props.value}\n        defaultValue={this.props.defaultValue}\n        required={this.props.required}\n        {...this.props.attributes}\n      />\n    );\n  }\n}\n\nexport const FormInput = withBuilder(FormInputComponent, {\n  name: 'Form:Input',\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fad6f37889d9e40bbbbc72cdb5875d6ca',\n  inputs: [\n    {\n      name: 'type',\n      type: 'text',\n      enum: [\n        'text',\n        'number',\n        'email',\n        'url',\n        'checkbox',\n        'radio',\n        'range',\n        'date',\n        'datetime-local',\n        'search',\n        'tel',\n        'time',\n        'file',\n        'month',\n        'week',\n        'password',\n        'color',\n        'hidden',\n      ],\n      defaultValue: 'text',\n    },\n    {\n      name: 'name',\n      type: 'string',\n      required: true,\n      helperText:\n        'Every input in a form needs a unique name describing what it takes, e.g. \"email\"',\n    },\n    {\n      name: 'placeholder',\n      type: 'string',\n      defaultValue: 'Hello there',\n      helperText: 'Text to display when there is no value',\n    },\n    // TODO: handle value vs default value automatically like ng-model\n    {\n      name: 'defaultValue',\n      type: 'string',\n    },\n    {\n      name: 'value',\n      type: 'string',\n      advanced: true,\n    },\n\n    {\n      name: 'required',\n      type: 'boolean',\n      helperText: 'Is this input required to be filled out to submit a form',\n      defaultValue: false,\n    },\n  ],\n  // TODO\n  // TODO: call editorHooks?\n  // ...({\n  //   hooks: {\n  //     'ElementLayout:shiftBottomSide': (element: Element, amount: number, snap: boolean) => {\n  //       // TODO: either update line height or split the padding padding on bottom sides hmm\n  //     }\n  //   } as any,\n  // }),\n  noWrap: true,\n  static: true,\n  defaultStyles: {\n    paddingTop: '10px',\n    paddingBottom: '10px',\n    paddingLeft: '10px',\n    paddingRight: '10px',\n    borderRadius: '3px',\n    borderWidth: '1px',\n    borderStyle: 'solid',\n    borderColor: '#ccc',\n  },\n});\n","import React from 'react';\nimport { withBuilder } from '../../functions/with-builder';\n\nexport interface ButtonProps {\n  attributes?: any;\n  text?: string;\n}\n\nclass FormSubmitButtonComponent extends React.Component<ButtonProps> {\n  render() {\n    return (\n      <button type=\"submit\" {...this.props.attributes}>\n        {this.props.text}\n      </button>\n    );\n  }\n}\n\nexport const FormSubmitButton = withBuilder(FormSubmitButtonComponent, {\n  name: 'Form:SubmitButton',\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Fdf2820ffed1f4349a94c40b3221f5b98',\n  defaultStyles: {\n    appearance: 'none',\n    paddingTop: '15px',\n    paddingBottom: '15px',\n    paddingLeft: '25px',\n    paddingRight: '25px',\n    backgroundColor: '#3898EC',\n    color: 'white',\n    borderRadius: '4px',\n    cursor: 'pointer',\n  },\n  inputs: [\n    {\n      name: 'text',\n      type: 'text',\n      defaultValue: 'Click me',\n    },\n  ],\n  static: true,\n  noWrap: true,\n  // TODO: optional children? maybe as optional form input\n  // that only shows if advanced setting is flipped\n  // TODO: defaultChildren\n  // canHaveChildren: true,\n});\n","import React from 'react';\nimport { BuilderElement } from '@builder.io/sdk';\nimport { BuilderBlockComponent } from '../../builder-react';\nimport { withBuilder } from '../../functions/with-builder';\n\nexport interface LabelProps {\n  attributes?: any;\n  text?: string;\n  for?: string;\n  builderBlock?: BuilderElement;\n}\n\nclass LabelComponent extends React.Component<LabelProps> {\n  render() {\n    return (\n      <label htmlFor={this.props.for} {...this.props.attributes}>\n        {this.props.text && (\n          <span\n            className=\"builder-label-text\"\n            dangerouslySetInnerHTML={{\n              __html: this.props.text,\n            }}\n          />\n        )}\n        {this.props.builderBlock &&\n          this.props.builderBlock.children &&\n          this.props.builderBlock.children.map(item => (\n            <BuilderBlockComponent key={item.id} block={item} />\n          ))}\n      </label>\n    );\n  }\n}\n\n// TODO: strict ADA mode that enforces with custom error messages that all inputs need\n// labels and names\nexport const Label = withBuilder(LabelComponent, {\n  name: 'Form:Label',\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F9322342f04b545fb9a8091cd801dfb5b',\n  inputs: [\n    {\n      name: 'text',\n      type: 'html',\n      richText: true,\n      defaultValue: 'Label',\n    },\n    {\n      name: 'for',\n      type: 'text',\n      helperText: 'The name of the input this label is for',\n      advanced: true,\n    },\n  ],\n  noWrap: true,\n  static: true,\n  canHaveChildren: true,\n  // TODO: take inner html or blocsk\n  // TODO: optional children? maybe as optional form input\n  // that only shows if advanced setting is flipped\n  // TODO: defaultChildren\n  // canHaveChildren: true,\n});\n","import React from 'react';\nimport { Builder } from '@builder.io/sdk';\nimport { withBuilder } from '../../functions/with-builder';\n\nexport interface FormSelectProps {\n  options?: { name?: string; value: string }[];\n  attributes?: any;\n  name?: string;\n  value?: string;\n  defaultValue?: string;\n}\n\nclass FormSelectComponent extends React.Component<FormSelectProps> {\n  render() {\n    const { options } = this.props;\n    return (\n      <select\n        value={this.props.value}\n        key={Builder.isEditing && this.props.defaultValue ? this.props.defaultValue : 'default-key'}\n        defaultValue={this.props.defaultValue}\n        name={this.props.name}\n        {...this.props.attributes}\n      >\n        {options &&\n          options.map(option => (\n            <option value={option.value}>{option.name || option.value}</option>\n          ))}\n      </select>\n    );\n  }\n}\n\nexport const FormSelect = withBuilder(FormSelectComponent, {\n  name: 'Form:Select',\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2F83acca093fb24aaf94dee136e9a4b045',\n  defaultStyles: {\n    alignSelf: 'flex-start',\n  },\n  inputs: [\n    {\n      name: 'options',\n      type: 'list',\n      required: true,\n      subFields: [\n        {\n          name: 'value',\n          type: 'text',\n          required: true,\n        },\n        {\n          name: 'name',\n          type: 'text',\n        },\n      ],\n      defaultValue: [\n        {\n          value: 'option 1',\n        },\n        {\n          value: 'option 2',\n        },\n      ],\n    },\n    {\n      name: 'name',\n      type: 'string',\n      required: true,\n      helperText:\n        'Every select in a form needs a unique name describing what it gets, e.g. \"email\"',\n    },\n    {\n      name: 'defaultValue',\n      type: 'string',\n    },\n    {\n      name: 'value',\n      type: 'string',\n      advanced: true,\n    },\n\n    {\n      name: 'required',\n      type: 'boolean',\n      defaultValue: false,\n    },\n  ],\n  static: true,\n  noWrap: true,\n});\n","import React from 'react';\nimport { withBuilder } from '../../functions/with-builder';\n\nexport interface FormTextAreaProps {\n  attributes?: any;\n  name?: string;\n  value?: string;\n  defaultValue?: string;\n  placeholder?: string;\n}\n\nclass TextAreaComponent extends React.Component<FormTextAreaProps> {\n  render() {\n    return (\n      <textarea\n        placeholder={this.props.placeholder}\n        name={this.props.name}\n        value={this.props.value}\n        defaultValue={this.props.defaultValue}\n        {...this.props.attributes}\n      />\n    );\n  }\n}\n\nexport const TextArea = withBuilder(TextAreaComponent, {\n  name: 'Form:TextArea',\n  image:\n    'https://cdn.builder.io/api/v1/image/assets%2FIsxPKMo2gPRRKeakUztj1D6uqed2%2Ff74a2f3de58c4c3e939204e5b6b8f6c3',\n  inputs: [\n    {\n      advanced: true,\n      name: 'value',\n      type: 'string',\n    },\n    {\n      name: 'name',\n      type: 'string',\n      required: true,\n      helperText: 'Every input in a form needs a unique name describing what it gets, e.g. \"email\"',\n    },\n    {\n      name: 'defaultValue',\n      type: 'string',\n    },\n    {\n      name: 'placeholder',\n      type: 'string',\n      defaultValue: 'Hello there',\n    },\n    {\n      name: 'required',\n      type: 'boolean',\n      defaultValue: false,\n    },\n  ],\n  defaultStyles: {\n    paddingTop: '10px',\n    paddingBottom: '10px',\n    paddingLeft: '10px',\n    paddingRight: '10px',\n    borderRadius: '3px',\n    borderWidth: '1px',\n    borderStyle: 'solid',\n    borderColor: '#ccc',\n  },\n  static: true,\n  noWrap: true,\n});\n","import React from 'react';\nimport { BuilderElement } from '@builder.io/sdk';\nimport { withBuilder } from '../../functions/with-builder';\n\nexport interface ImgProps {\n  attributes?: any;\n  image?: string;\n  builderBlock?: BuilderElement;\n}\n\n// TODO: srcset, alt text input, object size/position input, etc\n\nclass ImgComponent extends React.Component<ImgProps> {\n  render() {\n    const attributes = this.props.attributes || {};\n    return (\n      <img\n        {...this.props.attributes}\n        src={this.props.image || attributes.src}\n        // TODO: generate this\n        // srcSet={this.props.image || attributes.srcSet || attributes.srcset}\n      />\n    );\n  }\n}\n\nexport const Img = withBuilder(ImgComponent, {\n  // friendlyName?\n  name: 'Raw:Img',\n  hideFromInsertMenu: true,\n  image:\n    'https://firebasestorage.googleapis.com/v0/b/builder-3b0a2.appspot.com/o/images%2Fbaseline-insert_photo-24px.svg?alt=media&token=4e5d0ef4-f5e8-4e57-b3a9-38d63a9b9dc4',\n  inputs: [\n    {\n      name: 'image',\n      bubble: true,\n      type: 'file',\n      allowedFileTypes: ['jpeg', 'jpg', 'png', 'svg'],\n      required: true,\n    },\n  ],\n  noWrap: true,\n  static: true,\n});\n","import * as React from 'react';\nimport { BuilderElement, Builder } from '@builder.io/sdk';\n\nexport interface RawTextProps {\n  attributes?: any;\n  text?: string;\n  builderBlock?: BuilderElement;\n}\n\nexport const RawText = (props: RawTextProps) => {\n  const attributes = props.attributes || {};\n  return (\n    <span\n      className={attributes?.class || attributes?.className}\n      dangerouslySetInnerHTML={{ __html: props.text || '' }}\n    />\n  );\n};\n\nBuilder.registerComponent(RawText, {\n  name: 'Builder:RawText',\n  hideFromInsertMenu: true,\n  inputs: [\n    {\n      name: 'text',\n      bubble: true,\n      type: 'longText',\n      required: true,\n    },\n  ],\n});\n","import './scripts/init-editing';\n\nimport { builder, Builder } from '@builder.io/sdk';\nexport { BuilderElement } from '@builder.io/sdk';\n\nBuilder.isReact = true;\n\nexport { BuilderBlocks } from './components/builder-blocks.component';\nexport { BuilderBlock as BuilderBlockComponent } from './components/builder-block.component';\nexport { BuilderContent } from './components/builder-content.component';\nimport { BuilderComponent, onChange } from './components/builder-component.component';\nexport { BuilderStoreContext, BuilderStore } from './store/builder-store';\nexport { BuilderMetaContext } from './store/builder-meta';\nexport { BuilderAsyncRequestsContext } from './store/builder-async-requests';\nexport { BuilderBlock } from './decorators/builder-block.decorator';\n\nexport * from './functions/update-metadata';\n\nexport { withBuilder } from './functions/with-builder';\nexport { withChildren } from './functions/with-children';\nexport { noWrap } from './functions/no-wrap';\n\nexport { BuilderComponent as BuilderPage, onChange };\nexport { BuilderComponent };\nexport { BuilderComponent as RenderContent };\n\nexport { Text } from './blocks/Text';\nexport { Slot as Dropzone } from './blocks/Slot';\nexport { Fragment } from './blocks/Fragment';\nexport { Columns } from './blocks/Columns';\nexport { Embed } from './blocks/Embed';\nexport { CustomCode } from './blocks/CustomCode';\nexport { Image, getSrcSet } from './blocks/Image';\nexport { Video } from './blocks/Video';\nexport { Symbol } from './blocks/Symbol';\nexport { Button } from './blocks/Button';\nexport { Section } from './blocks/Section';\nexport { StateProvider } from './blocks/StateProvider';\nexport { Router } from './blocks/Router';\n\nexport { Form } from './blocks/forms/Form';\nexport { FormInput } from './blocks/forms/Input';\nexport { FormSubmitButton } from './blocks/forms/Button';\nexport { Label } from './blocks/forms/Label'; // advanced?\nexport { FormSelect } from './blocks/forms/Select'; // advanced?\nexport { TextArea } from './blocks/forms/TextArea';\nexport { Img } from './blocks/raw/Img';\nexport { RawText } from './blocks/raw/RawText';\n\nexport { stringToFunction } from './functions/string-to-function';\n\nexport { builder, Builder };\nexport default builder;\n"],"names":["window","parent","postMessage","type","data","value","supportsPatchUpdates","priorVersion","version","sizeNames","sizes","xsmall","min","default","max","small","medium","large","getWidthForSize","size","this","getSizeForWidth","width","sizeNames_1","_i","set","obj","_path","Object","path","Array","isArray","toString","match","slice","reduce","a","c","i","Math","abs","Number","length","safeDynamicRequire","Builder","isServer","eval","fnCache","api","state","builder","stringToFunction","str","expression","errors","logs","trim","cacheKey","useReturn","includes","startsWith","fn","isBrowser","Function","error","push","message","indexOf","console","warn","args","VM","event_1","timeout","sandbox","event","run","replace","stack","process","env","DEBUG","debug","isPromise","thing","then","isRequestInfo","BuilderAsyncRequestsContext","React","createContext","requests","BuilderStoreContext","rootState","content","context","update","mutator","applyPatchWithMinimalMutationChain","patch","preserveRoot","op","pathArr","split","shift","newObj","objPart","isLast","property","index","splice","nextProperty","newPart","String","htmlEscape","blockToHtmlString","block","tagName","id","class","keys","properties","map","key","join","component","name","options","text","children","item","Link","props","Consumer","renderLink","camelCaseToKebabCase","g","toLowerCase","kebabCaseToCamelCase","toUpperCase","Device","desktop","tablet","mobile","blocksMap","voidElements","Set","last","arr","omit","values","newObject","assign","values_1","cssCase","fastClone","JSON","parse","stringify","capitalize","_this","hasError","updates","selection","setTimeout","$block","$blocks","patches","location","href","newBlock","patches_1","setState","__extends","BuilderBlock","privateState","errorInfo","_errors","_logs","initialAnimationStepStyles","animation","animations","trigger","firstStep","steps","stepStyles","styles","reversedNames","reverse","self","responsiveStyles","reversedNames_1","emailMode","&.builder-block","hoverAnimation","find","transition","duration","easing","delay","transitionDelay","undefined","isEditing","removeEventListener","onWindowMessage","addEventListener","bindings","animator","bindAnimations","filter","elementId","InnerComponent","_f","TagName","html","jsx","dangerouslySetInnerHTML","__html","componentName","componentInfo","tag","components","style","hide","show","actions","useState","Proxy","prop","innerComponentProperties","isVoid","has","noWrap","fragment","styleStr","attr","styleSplit_1","stylePieces","finalOptions","_spacer","_a","builder-index","isIframe","memo","Fragment","ClassNames","css","addClass","emotionCss","className","_asyncRequests","attributes","builderBlock","builderState","fieldName","child","repeat","collection","collectionPath","collectionName","itemName_1","itemName","array","childState","$index","$item","Provider","__assign","getElement","display","padding","color","fontSize","fontStyle","contents","Component","noBlocks","parentElementId","parentId","dataPath","BuilderBlocks","blocks","flexDirection","alignItems","onClick","onClickEmptyBlocks","NoWrap","getData","blocksString","hasBlocks","newData","variantsScript","variantsString","contentId","VariantsProvider","initialContent","canTrack","Boolean","variations","variants","allVariants","variantsJson_1","testRatio","React.createElement","React.Fragment","cookieName","variantId","getCookie","n","random","variant","setCookie","loading","noEditorUpdates","contentLoaded","Subscription","reactEvent","nativeEvent","autoTrack","trackInteraction","renderedVairantId","clicked","BuilderContent","model","modelName","isStatic","variationId","inline","firstLoad","subscribeToContent","contentData","trackImpression","subscriptions","add","queueGetContent","subscribe","matches","addedObserver","IntersectionObserver","ref","intersectionObserver","entries","observer","forEach","entry","intersectionRatio","trackedImpression","unobserve","observe","err","contentError","unsubscribe","dataOnly","useData","renderScript","Tag","data-template-variant-id","defineProperty","exports","TARGET","Symbol","UNSUBSCRIBE","concatPath","shallowClone","onChange","object","applyPath","applyPrevious","proxyTarget","inApply","changed","isUnsubscribed","equals","is","propCache","WeakMap","pathCache","proxyCache","handleChange","previous","item_1","callback","walkPath","invalidateCachedDescriptor","target","get","delete","buildProxy","proxy","handler","ignoreChange","ignoreSymbols","receiver","Reflect","isPrimitive","RegExp","isBuiltinWithoutMutableMethods","isShallow","descriptor","Map","getOwnPropertyDescriptor","configurable","writable","ignore","result","deleteProperty","apply","thisArg","argumentsList","compare","Date","valueOf","call","lastIndexOf","bind","module","nextTick","debounceNextTick","debounceNextTickImpl","enumerable","arguments","next","throttle","func","wait","later","leading","now","remaining","clearTimeout","trailing","BuilderMetaContext","ampMode","pick","ret","wrapComponent","info","builderTag","inputNames","concat","inputs","baseProps","inputProps","debounce","immediate","fontsLoaded","fetch","require","sizeMap","decorator","fnArgs","descriptorChecker","descriptorKey","Throttle","fetchCache","tryEval","searchToObject","pairs","search","substring","pair","decodeURIComponent","_super","BehaviorSubject","updateState","data_1","_b","deviceSize","deviceSizeState","resizeFn","mounted","notifyStateChange","title","pageTitle","description","pageDescription","document","descriptionTag","querySelector","createElement","setAttribute","head","appendChild","input","defaultValue","newState","locationState","device","jsCode","codegen","skip","lastJsCode","httpRequests","noAsync","url","finalUrl_1","evalExpression","lastHttpRequests","builderModelMatch","throttledHandleRequest","currentSubscription","httpSubscriptionPerKey","newSubscription","onStateChange","newUrl","handleRequest","inlinedContent","_hydrate","hydrate","getHtmlData","apiKey","onContentLoaded","BuilderComponent","defaults","isPreviewing","inlineContent","script","innerText","getUserAttributes","pathname","query","innerWidth","elementOrSelector","fresh","element","Element","exists","classList","contains","shouldHydrate","innerHTML","apiStyles_1","previousElementSibling","keepStyles_1","el","useElement","useEl","div","insertAdjacentElement","val_1","ReactDOM","render","builderRootRef","val","asServer","resizeListener","messageListener","dispatchEvent","CustomEvent","detail","previewingModel","nextState","font","family","kind","fileUrl","files","regular","weight","weightUrl","allowCustomFonts","customFonts","getCssFromFont","useContent","cssCode","getFontCss","prevProps","styleRef","css_1","getCss","builderContent","dataString","hash","WrapComponent","isChild","stopClickPropagationWhenEditing","stopPropagation","contentRef","format","fullData","checkStyles","blocksJs","builderComponentNames","from","reversedcomponents_1","builderComponents","mappedComponentNames","finalizedComponents","initialState","setTick","testVariationId","group","propertyName","ctx","request","requestStart","time","json","err_1","timeEnd","existing","req","promise_1","promise","optionsString","__decorate","updateMetadata","updated","registerComponent","withBuilder","withChildren","HOC","forwardRef","builderOptions","canHaveChildren","finalProps","iconUrl","TextComponent","allowTextEdit","textRef","contentEditable","activeElement","allowEditingText","textCSS","outline","& p:first-of-type, & .builder-paragraph:first-of-type","margin","& > p, & .builder-paragraph","lineHeight","letterSpacing","fontWeight","textAlign","fontFamily","meta","rtlMode","direction","onInput","e","currentTarget","onKeyDown","which","blur","onFocus","onBlur","Text","static","image","required","autoFocus","bubble","defaultStyles","height","Slot","useContext","isEditingThisSlot","symbolId","pointerEvents","builder-slot","docsLink","FragmentComponent","BuilderBlockComponent","hideFromInsertMenu","DEFAULT_ASPECT_RATIO","defaultBlocks","@type","flexShrink","position","marginTop","minHeight","minWidth","overflow","backgroundPosition","backgroundSize","aspectRatio","ColumnsComponent","columns","space","subtractWidth","getWidth","gutterSize","stackColumnsAt","reverseColumnsWhenStacked","col","link","flexGrow","getColumnWidth","marginLeft","Columns","broadcast","subFields","hideFromUI","helperText","clearWidths","advanced","enum","EmbedComponent","findAndRunScripts","elementRef","scripts","getElementsByTagName","src","scriptsInserted","newScript","async","scriptsRun","Embed","res","catch","globalReplaceNodes","isShopify","customCodeQuerySelector_1","allCustomCodeElements_1","querySelectorAll","builderTemplates","template","codeElements","parentElement","getAttribute","replaceNodes","originalRef","node","remove","CustomCodeComponent","code","scriptsClientOnly","noReactRender","CustomCode","requiredPermissions","removeProtocol","isElementInViewport","rect","getBoundingClientRect","top","left","bottom","innerHeight","documentElement","clientHeight","right","clientWidth","getShopifyImageUrl","prefix","suffix","useSize","updateQueryParam","uri","re","separator","encodeURIComponent","getSrcSet","srcUrl","widthInSrc_1","isNaN","getSizes","useSizes","splitSizes","sizesLength_1","generatedSizes","hasSmallOrMediumSize","unitRegex","widthAndQuery","imageLoaded","useLazyLoading","load","ImageComponent","lazy","scrollListener","pictureRef","listener_1","buffer","capture","passive","srcset","fitContent","amp","imageContents","layout","round","alt","altText","role","opacity","objectFit","objectPosition","onLoad","srcSet","noWebp","paddingTop","Image","allowedFileTypes","blob","Promise","resolve","reject","img","loaded","onload","Error","num","possiblyUpdatedAspectRatio","label","lazyLoad","VideoComponent","video","removeAttribute","updateVideo","containerRef","poster","posterImage","autoPlay","muted","controls","loop","fit","borderRadius","Video","refs","SymbolComponent","useStatic","staticRef","parentNode","replaceChild","symbol","showPlaceholder","dynamic","inheritState","ButtonComponent","openLinkInNewTab","Button","appearance","paddingBottom","paddingLeft","paddingRight","backgroundColor","cursor","friendlyName","SectionComponent","alignSelf","boxSizing","maxWidth","marginRight","Section","defaultChildren","StateProviderComponent","StateProvider","prefetched","updateLocationState","preloadQueue","preloadOnHover","hrefTarget","findHrefTarget","isRelative","converted","convertToRelative","parsedUrl","parseUrl","urlPath","queryString","subscription","userAttributes","handleRouting","button","ctrlKey","defaultPrevented","metaKey","onRoute","routeEvent","anchorNode","preventDefault","route","RouterComponent","routed","history","pushState","onPopState","onMouseOverOrTouchStart","HTMLAnchorElement","currentUrl","hrefUrl","host","relativeUrl","Router","prototype","responseData","formErrorMessage","FormComponent","previewState","validate","action","sendWithJs","method","onSubmit","sendSubmissionsTo","headers","customHeaders","body","formData","FormData","formPairs","HTMLInputElement","checked","valueAsNumber","contentType_1","contentType","File","FileList","json_1","presubmitEvent","formUrl","btoa","sendSubmissionsToEmail","ok","errorMessagePath","submitSuccessEvent","resetFormOnSubmit","reset","successUrl","submitErrorEvent","submissionState","errorMessage","sendingMessage","successMessage","Form","showIf","component.options.text","valueType","placeholder","FormInputComponent","FormInput","borderWidth","borderStyle","borderColor","FormSubmitButtonComponent","FormSubmitButton","LabelComponent","htmlFor","for","Label","richText","FormSelectComponent","option","FormSelect","TextAreaComponent","TextArea","ImgComponent","Img","RawText","isReact"],"mappings":"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"}