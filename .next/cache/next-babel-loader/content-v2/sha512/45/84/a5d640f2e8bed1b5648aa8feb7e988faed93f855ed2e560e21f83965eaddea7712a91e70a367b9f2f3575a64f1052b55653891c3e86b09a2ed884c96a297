{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Bruno\\\\Desktop\\\\tienda\\\\nextjs-shopify-master\\\\components\\\\common\\\\Searchbar.tsx\";\n\n/** @jsxRuntime classic */\n\n/** @jsx jsx */\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useRouter } from 'next/router';\nimport { LoadingDots } from '@components/ui';\nimport builderConfig from '@config/builder';\nimport { ProductGrid } from 'blocks/ProductGrid/ProductGrid';\nimport { Button, Themed, jsx, Input, Label } from 'theme-ui';\nimport { searchProducts } from '@lib/shopify/storefront-data-hooks/src/api/operations-builder';\nimport { ExpandModal } from 'react-spring-modal';\nimport { throttle } from 'lodash';\nimport 'react-spring-modal/styles.css';\nimport { Cross } from '@components/icons';\n\nconst Searchbar = () => {\n  var _buttonRef$current;\n\n  const router = useRouter();\n  const {\n    q\n  } = router.query;\n  const {\n    0: isOpen,\n    1: setIsOpen\n  } = useState(false);\n  const buttonRef = useRef(null);\n  useEffect(() => {\n    setIsOpen(false);\n  }, [router.asPath.split('?')[0]]);\n  return jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 5\n    }\n  }, jsx(ExpandModal, {\n    transitionConfig: {},\n    contentTransition: {},\n    overlayProps: {\n      style: {\n        maxWidth: 1920,\n        left: '50%',\n        transform: 'translateX(-50%)',\n        overflow: 'auto',\n        top: (((_buttonRef$current = buttonRef.current) === null || _buttonRef$current === void 0 ? void 0 : _buttonRef$current.getBoundingClientRect().bottom) || 0) + 15\n      }\n    },\n    isOpen: isOpen,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 7\n    }\n  }, jsx(SearchModalContent, {\n    initialSearch: q && String(q),\n    onSearch: term => {\n      const op = q ? 'replace' : 'push';\n      router[op]({\n        pathname: router.asPath.split('?')[0],\n        query: {\n          q: term\n        }\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  })), jsx(Themed.div, {\n    ref: buttonRef,\n    as: Button,\n    mx: 2,\n    onClick: () => setIsOpen(!isOpen),\n    \"aria-label\": \"Search\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }, isOpen ? jsx(Cross, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 11\n    }\n  }) : jsx(\"svg\", {\n    width: \"20\",\n    height: \"22\",\n    viewBox: \"0 0 20 22\",\n    fill: \"none\",\n    stroke: \"currentColor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 11\n    }\n  }, jsx(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }))));\n};\n\nconst SearchModalContent = props => {\n  const {\n    0: search,\n    1: setSearch\n  } = useState(props.initialSearch && String(props.initialSearch));\n  const {\n    0: products,\n    1: setProducts\n  } = useState([]);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n\n  const getProducts = async searchTerm => {\n    setLoading(true);\n    const results = await searchProducts(builderConfig, String(searchTerm), // TODO: pagination\n    20, 0);\n    setSearch(searchTerm);\n    setProducts(results);\n    setLoading(false);\n\n    if (searchTerm) {\n      props.onSearch(searchTerm);\n    }\n  };\n\n  useEffect(() => {\n    if (search) {\n      getProducts(search);\n    }\n  }, []);\n  const throttleSearch = useCallback(throttle(getProducts), []);\n  return jsx(Themed.div, {\n    sx: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      p: [1, 2],\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, jsx(Input, {\n    type: \"search\",\n    sx: {\n      marginBottom: 15\n    },\n    defaultValue: props.initialSearch,\n    placeholder: \"Search for products...\",\n    onChange: event => throttleSearch(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }), loading ? jsx(LoadingDots, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 9\n    }\n  }) : products.length ? jsx(React.Fragment, null, jsx(Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, \"Search Results for \\\"\", jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 33\n    }\n  }, search), \"\\\"\"), jsx(ProductGrid, {\n    cardProps: {\n      imgHeight: 540,\n      imgWidth: 540,\n      imgPriority: false\n    },\n    products: products,\n    offset: 0,\n    limit: products.length,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  })) : jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 9\n    }\n  }, search ? jsx(React.Fragment, null, \"There are no products that match \\\"\", jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 49\n    }\n  }, search), \"\\\"\") : jsx(React.Fragment, null, \" \")));\n};\n\nexport default Searchbar;","map":{"version":3,"sources":["C:/Users/Bruno/Desktop/tienda/nextjs-shopify-master/components/common/Searchbar.tsx"],"names":["React","useState","useEffect","useCallback","useRef","useRouter","LoadingDots","builderConfig","ProductGrid","Button","Themed","jsx","Input","Label","searchProducts","ExpandModal","throttle","Cross","Searchbar","router","q","query","isOpen","setIsOpen","buttonRef","asPath","split","style","maxWidth","left","transform","overflow","top","current","getBoundingClientRect","bottom","String","term","op","pathname","SearchModalContent","props","search","setSearch","initialSearch","products","setProducts","loading","setLoading","getProducts","searchTerm","results","onSearch","throttleSearch","display","flexDirection","justifyContent","p","width","marginBottom","event","target","value","length","imgHeight","imgWidth","imgPriority"],"mappings":"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","sourcesContent":["/** @jsxRuntime classic */\n/** @jsx jsx */\nimport React, { FC, useState, useEffect, useCallback, useRef } from 'react'\nimport { useRouter } from 'next/router'\nimport { LoadingDots } from '@components/ui'\nimport builderConfig from '@config/builder'\nimport { ProductGrid } from 'blocks/ProductGrid/ProductGrid'\nimport { Button, Themed, jsx, Input, Label } from 'theme-ui'\nimport { searchProducts } from '@lib/shopify/storefront-data-hooks/src/api/operations-builder'\nimport { ExpandModal } from 'react-spring-modal'\nimport { throttle } from 'lodash'\nimport 'react-spring-modal/styles.css'\nimport { Cross } from '@components/icons'\n\ninterface Props {\n  className?: string\n  id?: string\n}\n\nconst Searchbar: FC<Props> = () => {\n  const router = useRouter()\n  const { q } = router.query\n  const [isOpen, setIsOpen] = useState(false)\n  const buttonRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    setIsOpen(false)\n  }, [router.asPath.split('?')[0]])\n\n  return (\n    <React.Fragment>\n      <ExpandModal\n        transitionConfig={{}}\n        contentTransition={{}}\n        overlayProps={{\n          style: {\n            maxWidth: 1920,\n            left: '50%',\n            transform: 'translateX(-50%)',\n            overflow: 'auto',\n            top: (buttonRef.current?.getBoundingClientRect().bottom || 0) + 15,\n          },\n        }}\n        isOpen={isOpen}\n      >\n        <SearchModalContent\n          initialSearch={q && String(q)}\n          onSearch={(term: string) => {\n            const op = q ? 'replace' : 'push'\n            router[op]({\n              pathname: router.asPath.split('?')[0],\n              query: {\n                q: term,\n              },\n            })\n          }}\n        />\n      </ExpandModal>\n\n      <Themed.div\n        ref={buttonRef}\n        as={Button}\n        mx={2}\n        onClick={() => setIsOpen(!isOpen)}\n        aria-label=\"Search\"\n      >\n        {isOpen ? (\n          <Cross />\n        ) : (\n          <svg\n            width=\"20\"\n            height=\"22\"\n            viewBox=\"0 0 20 22\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              clipRule=\"evenodd\"\n              d=\"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z\"\n            />\n          </svg>\n        )}\n      </Themed.div>\n    </React.Fragment>\n  )\n}\n\nconst SearchModalContent = (props: {\n  initialSearch?: string\n  onSearch: (term: string) => any\n}) => {\n  const [search, setSearch] = useState(\n    props.initialSearch && String(props.initialSearch)\n  )\n  const [products, setProducts] = useState([] as any[])\n  const [loading, setLoading] = useState(false)\n  const getProducts = async (searchTerm: string) => {\n    setLoading(true)\n    const results = await searchProducts(\n      builderConfig,\n      String(searchTerm),\n      // TODO: pagination\n      20,\n      0\n    )\n    setSearch(searchTerm)\n    setProducts(results)\n    setLoading(false)\n    if (searchTerm) {\n      props.onSearch(searchTerm)\n    }\n  }\n\n  useEffect(() => {\n    if (search) {\n      getProducts(search)\n    }\n  }, [])\n\n  const throttleSearch = useCallback(throttle(getProducts), [])\n\n  return (\n    <Themed.div\n      sx={{\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        p: [1, 2],\n        width: '100%',\n      }}\n    >\n      <Input\n        type=\"search\"\n        sx={{ marginBottom: 15 }}\n        defaultValue={props.initialSearch}\n        placeholder=\"Search for products...\"\n        onChange={(event) => throttleSearch(event.target.value)}\n      />\n      {loading ? (\n        <LoadingDots />\n      ) : products.length ? (\n        <>\n          <Label>\n            Search Results for \"<strong>{search}</strong>\"\n          </Label>\n          <ProductGrid\n            cardProps={{\n              imgHeight: 540,\n              imgWidth: 540,\n              imgPriority: false,\n            }}\n            products={products}\n            offset={0}\n            limit={products.length}\n          ></ProductGrid>\n        </>\n      ) : (\n        <span>\n          {search ? (\n            <>\n              There are no products that match \"<strong>{search}</strong>\"\n            </>\n          ) : (\n            <> </>\n          )}\n        </span>\n      )}\n    </Themed.div>\n  )\n}\n\nexport default Searchbar\n"]},"metadata":{},"sourceType":"module"}