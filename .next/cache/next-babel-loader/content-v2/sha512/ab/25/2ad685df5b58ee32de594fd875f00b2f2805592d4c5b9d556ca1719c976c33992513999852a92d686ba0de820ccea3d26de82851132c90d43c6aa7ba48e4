{"ast":null,"code":"import _defineProperty from \"C:/Users/Bruno/Desktop/tienda/nextjs-shopify-master/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:/Users/Bruno/Desktop/tienda/nextjs-shopify-master/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Bruno/Desktop/tienda/nextjs-shopify-master/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as qs from 'qs';\nexport function getAllProducts(_x) {\n  return _getAllProducts.apply(this, arguments);\n}\n\nfunction _getAllProducts() {\n  _getAllProducts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(config) {\n    var limit,\n        offset,\n        productsContent,\n        _args = arguments;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            limit = _args.length > 1 && _args[1] !== undefined ? _args[1] : 100;\n            offset = _args.length > 2 && _args[2] !== undefined ? _args[2] : 0;\n            _context.next = 4;\n            return fetch(\"https://cdn.builder.io/api/v2/content/\".concat(config.productsModel, \"?apiKey=\").concat(config.apiKey, \"&limit=\").concat(limit, \"&offset=\").concat(offset, \"&cachebust=true\")).then(function (res) {\n              return res.json();\n            });\n\n          case 4:\n            productsContent = _context.sent.results;\n            return _context.abrupt(\"return\", productsContent.map(function (pr) {\n              return pr.data;\n            }));\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getAllProducts.apply(this, arguments);\n}\n\nexport function searchProducts(_x2, _x3) {\n  return _searchProducts.apply(this, arguments);\n}\n\nfunction _searchProducts() {\n  _searchProducts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(config, searchString) {\n    var limit,\n        offset,\n        query,\n        productsContent,\n        _args2 = arguments;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            limit = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : 100;\n            offset = _args2.length > 3 && _args2[3] !== undefined ? _args2[3] : 0;\n            query = qs.stringify({\n              fields: ['data'],\n              limit: limit,\n              offset: offset,\n              apiKey: config.apiKey\n            }, {\n              allowDots: true\n            });\n            _context2.next = 5;\n            return fetch(\"https://cdn.builder.io/api/v2/content/\".concat(config.productsModel, \"?\").concat(query, \"&query.data.title=\").concat(JSON.stringify({\n              $regex: \"\".concat(searchString),\n              $options: 'i'\n            }))).then(function (res) {\n              return res.json();\n            });\n\n          case 5:\n            productsContent = _context2.sent.results;\n            return _context2.abrupt(\"return\", (productsContent === null || productsContent === void 0 ? void 0 : productsContent.map(function (product) {\n              return product.data;\n            })) || []);\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _searchProducts.apply(this, arguments);\n}\n\nexport function getAllProductPaths(_x4, _x5) {\n  return _getAllProductPaths.apply(this, arguments);\n}\n\nfunction _getAllProductPaths() {\n  _getAllProductPaths = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(config, limit) {\n    var products;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return getAllProducts(config, limit);\n\n          case 2:\n            products = _context3.sent;\n            return _context3.abrupt(\"return\", (products === null || products === void 0 ? void 0 : products.map(function (entry) {\n              return entry.handle;\n            })) || []);\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _getAllProductPaths.apply(this, arguments);\n}\n\nexport function getProduct(_x6, _x7) {\n  return _getProduct.apply(this, arguments);\n}\n/**\n * Collections\n */\n\nfunction _getProduct() {\n  _getProduct = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(config, options) {\n    var _productsContent$;\n\n    var query, productsContent;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            if (!(Boolean(options.id) === Boolean(options.handle))) {\n              _context4.next = 2;\n              break;\n            }\n\n            throw new Error('Either a handle or id is required');\n\n          case 2:\n            query = qs.stringify({\n              limit: 1,\n              apiKey: config.apiKey,\n              query: {\n                data: options.id ? {\n                  id: {\n                    $eq: options.id\n                  }\n                } : {\n                  handle: {\n                    $eq: options.handle\n                  }\n                }\n              }\n            });\n            _context4.next = 5;\n            return fetch(\"https://cdn.builder.io/api/v2/content/\".concat(config.productsModel, \"?\").concat(query)).then(function (res) {\n              return res.json();\n            });\n\n          case 5:\n            productsContent = _context4.sent.results;\n\n            if (!options.withContent) {\n              _context4.next = 8;\n              break;\n            }\n\n            return _context4.abrupt(\"return\", productsContent[0]);\n\n          case 8:\n            return _context4.abrupt(\"return\", (_productsContent$ = productsContent[0]) === null || _productsContent$ === void 0 ? void 0 : _productsContent$.data);\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _getProduct.apply(this, arguments);\n}\n\nexport function getAllCollections(_x8) {\n  return _getAllCollections.apply(this, arguments);\n}\n\nfunction _getAllCollections() {\n  _getAllCollections = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(config) {\n    var limit,\n        offset,\n        fields,\n        query,\n        collectionsContent,\n        _args5 = arguments;\n    return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            limit = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : 20;\n            offset = _args5.length > 2 && _args5[2] !== undefined ? _args5[2] : 0;\n            fields = _args5.length > 3 ? _args5[3] : undefined;\n            query = qs.stringify({\n              fields: fields || 'data',\n              limit: limit,\n              offset: offset,\n              apiKey: config.apiKey,\n              cachebust: true\n            }, {\n              allowDots: true\n            });\n            _context5.next = 6;\n            return fetch(\"https://cdn.builder.io/api/v2/content/\".concat(config.collectionsModel, \"?\").concat(query)).then(function (res) {\n              return res.json();\n            });\n\n          case 6:\n            collectionsContent = _context5.sent.results;\n            return _context5.abrupt(\"return\", (collectionsContent === null || collectionsContent === void 0 ? void 0 : collectionsContent.map(function (entry) {\n              return entry.data;\n            })) || []);\n\n          case 8:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n  return _getAllCollections.apply(this, arguments);\n}\n\nexport function searchCollections(_x9, _x10) {\n  return _searchCollections.apply(this, arguments);\n}\n\nfunction _searchCollections() {\n  _searchCollections = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(config, searchString) {\n    var limit,\n        offset,\n        query,\n        collectionsContent,\n        _args6 = arguments;\n    return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            limit = _args6.length > 2 && _args6[2] !== undefined ? _args6[2] : 100;\n            offset = _args6.length > 3 && _args6[3] !== undefined ? _args6[3] : 0;\n            query = qs.stringify({\n              fields: ['data'],\n              limit: limit,\n              offset: offset,\n              apiKey: config.apiKey\n            }, {\n              allowDots: true\n            });\n            _context6.next = 5;\n            return fetch(\"https://cdn.builder.io/api/v2/content/\".concat(config.collectionsModel, \"?\").concat(query, \"&query.$or=\").concat(JSON.stringify([{\n              'data.description': {\n                $regex: \"\".concat(searchString)\n              }\n            }, {\n              'data.title': {\n                $regex: \"\".concat(searchString)\n              }\n            }]))).then(function (res) {\n              return res.json();\n            });\n\n          case 5:\n            collectionsContent = _context6.sent.results;\n            return _context6.abrupt(\"return\", (collectionsContent === null || collectionsContent === void 0 ? void 0 : collectionsContent.map(function (entry) {\n              return entry.data;\n            })) || []);\n\n          case 7:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n  return _searchCollections.apply(this, arguments);\n}\n\nexport function getAllCollectionPaths(_x11, _x12) {\n  return _getAllCollectionPaths.apply(this, arguments);\n}\n\nfunction _getAllCollectionPaths() {\n  _getAllCollectionPaths = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(config, limit) {\n    var collections;\n    return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.next = 2;\n            return getAllCollections(config, limit);\n\n          case 2:\n            collections = _context7.sent;\n            return _context7.abrupt(\"return\", (collections === null || collections === void 0 ? void 0 : collections.map(function (entry) {\n              return entry.handle;\n            })) || []);\n\n          case 4:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n  return _getAllCollectionPaths.apply(this, arguments);\n}\n\nexport function getCollection(_x13, _x14) {\n  return _getCollection.apply(this, arguments);\n}\n\nfunction _getCollection() {\n  _getCollection = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(config, options) {\n    var _collectionsContent$;\n\n    var query, collectionsContent, collection, productsQuery, _yield$getCollectionP, products, nextPageCursor, hasNextPage;\n\n    return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            if (!(Boolean(options.id) === Boolean(options.handle))) {\n              _context8.next = 2;\n              break;\n            }\n\n            throw new Error('Either a handle or id is required');\n\n          case 2:\n            query = qs.stringify({\n              limit: 1,\n              apiKey: config.apiKey,\n              cachebust: true,\n              query: {\n                data: options.id ? {\n                  id: {\n                    $eq: options.id\n                  }\n                } : {\n                  handle: {\n                    $eq: options.handle\n                  }\n                }\n              }\n            });\n            _context8.next = 5;\n            return fetch(\"https://cdn.builder.io/api/v2/content/\".concat(config.collectionsModel, \"?\").concat(query)).then(function (res) {\n              return res.json();\n            });\n\n          case 5:\n            collectionsContent = _context8.sent.results;\n            collection = (_collectionsContent$ = collectionsContent[0]) === null || _collectionsContent$ === void 0 ? void 0 : _collectionsContent$.data;\n\n            if (!config.isDemo) {\n              _context8.next = 9;\n              break;\n            }\n\n            return _context8.abrupt(\"return\", collection);\n\n          case 9:\n            productsQuery = _objectSpread(_objectSpread({\n              limit: 20,\n              handle: collection === null || collection === void 0 ? void 0 : collection.handle\n            }, options.productsQuery), {}, {\n              apiKey: config.apiKey\n            });\n            _context8.next = 12;\n            return getCollectionProducts(productsQuery);\n\n          case 12:\n            _yield$getCollectionP = _context8.sent;\n            products = _yield$getCollectionP.products;\n            nextPageCursor = _yield$getCollectionP.nextPageCursor;\n            hasNextPage = _yield$getCollectionP.hasNextPage;\n            return _context8.abrupt(\"return\", _objectSpread(_objectSpread({}, collection), {}, {\n              products: products,\n              nextPageCursor: nextPageCursor,\n              hasNextPage: hasNextPage\n            }));\n\n          case 17:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n  return _getCollection.apply(this, arguments);\n}\n\nexport var getCollectionProducts = function getCollectionProducts(productsQuery) {\n  var search = qs.stringify(productsQuery);\n  return fetch(\"https://cdn.builder.io/api/v1/shopify-sync/collection-products?\".concat(search)).then(function (res) {\n    return res.json();\n  });\n};","map":{"version":3,"sources":["C:/Users/Bruno/Desktop/tienda/nextjs-shopify-master/lib/shopify/storefront-data-hooks/src/api/operations-builder.ts"],"names":["qs","getAllProducts","config","limit","offset","fetch","productsModel","apiKey","then","res","json","productsContent","results","map","pr","data","searchProducts","searchString","query","stringify","fields","allowDots","JSON","$regex","$options","product","getAllProductPaths","products","entry","handle","getProduct","options","Boolean","id","Error","$eq","withContent","getAllCollections","cachebust","collectionsModel","collectionsContent","searchCollections","getAllCollectionPaths","collections","getCollection","collection","isDemo","productsQuery","getCollectionProducts","nextPageCursor","hasNextPage","search"],"mappings":"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","sourcesContent":["import * as qs from 'qs'\n\nexport interface BuillderConfig {\n  apiKey: string\n  productsModel: string\n  collectionsModel: string\n  isDemo?: boolean\n}\n\nexport interface CollectionProductsQuery {\n  handle: string\n  limit?: number\n  cursor?: string\n  apiKey: string\n}\n\nexport async function getAllProducts(\n  config: BuillderConfig,\n  limit = 100,\n  offset = 0\n) {\n  const productsContent = (\n    await fetch(\n      `https://cdn.builder.io/api/v2/content/${config.productsModel}?apiKey=${config.apiKey}&limit=${limit}&offset=${offset}&cachebust=true`\n    ).then((res) => res.json())\n  ).results\n\n  return productsContent.map((pr: any) => pr.data)\n}\n\nexport async function searchProducts(\n  config: BuillderConfig,\n  searchString: string,\n  limit = 100,\n  offset = 0\n) {\n  const query = qs.stringify(\n    {\n      fields: ['data'],\n      limit,\n      offset,\n      apiKey: config.apiKey,\n    },\n    { allowDots: true }\n  )\n\n  const productsContent = (\n    await fetch(\n      `https://cdn.builder.io/api/v2/content/${\n        config.productsModel\n      }?${query}&query.data.title=${JSON.stringify({\n        $regex: `${searchString}`,\n        $options: 'i',\n      })}`\n    ).then((res) => res.json())\n  ).results\n  return productsContent?.map((product: any) => product.data) || []\n}\n\nexport async function getAllProductPaths(\n  config: BuillderConfig,\n  limit?: number\n): Promise<string[]> {\n  const products: any[] = await getAllProducts(config, limit)\n  return products?.map((entry) => entry.handle) || []\n}\n\nexport async function getProduct(\n  config: BuillderConfig,\n  options: { id?: string; handle?: string; withContent?: boolean }\n) {\n  if (Boolean(options.id) === Boolean(options.handle)) {\n    throw new Error('Either a handle or id is required')\n  }\n  const query = qs.stringify({\n    limit: 1,\n    apiKey: config.apiKey,\n    query: {\n      data: options.id\n        ? {\n            id: { $eq: options.id },\n          }\n        : {\n            handle: { $eq: options.handle },\n          },\n    },\n  })\n\n  const productsContent = (\n    await fetch(\n      `https://cdn.builder.io/api/v2/content/${config.productsModel}?${query}`\n    ).then((res) => res.json())\n  ).results\n\n  if (options.withContent) {\n    return productsContent[0]\n  }\n  return productsContent[0]?.data\n}\n\n/**\n * Collections\n */\n\nexport async function getAllCollections(\n  config: BuillderConfig,\n  limit = 20,\n  offset = 0,\n  fields?: string\n) {\n  const query = qs.stringify(\n    {\n      fields: fields || 'data',\n      limit,\n      offset,\n      apiKey: config.apiKey,\n      cachebust: true,\n    },\n    { allowDots: true }\n  )\n\n  const collectionsContent = (\n    await fetch(\n      `https://cdn.builder.io/api/v2/content/${config.collectionsModel}?${query}`\n    ).then((res) => res.json())\n  ).results\n\n  return collectionsContent?.map((entry: any) => entry.data) || []\n}\n\nexport async function searchCollections(\n  config: BuillderConfig,\n  searchString: string,\n  limit = 100,\n  offset = 0\n) {\n  const query = qs.stringify(\n    {\n      fields: ['data'],\n      limit,\n      offset,\n      apiKey: config.apiKey,\n    },\n    { allowDots: true }\n  )\n\n  const collectionsContent = (\n    await fetch(\n      `https://cdn.builder.io/api/v2/content/${\n        config.collectionsModel\n      }?${query}&query.$or=${JSON.stringify([\n        {\n          'data.description': { $regex: `${searchString}` },\n        },\n        {\n          'data.title': { $regex: `${searchString}` },\n        },\n      ])}`\n    ).then((res) => res.json())\n  ).results\n  return collectionsContent?.map((entry: any) => entry.data) || []\n}\n\nexport async function getAllCollectionPaths(\n  config: BuillderConfig,\n  limit?: number\n): Promise<string[]> {\n  const collections: any[] = await getAllCollections(config, limit)\n  return collections?.map((entry) => entry.handle) || []\n}\n\nexport async function getCollection(\n  config: BuillderConfig,\n  options: {\n    id?: string\n    handle?: string\n    productsQuery?: Omit<CollectionProductsQuery, 'handle'>\n  }\n) {\n  if (Boolean(options.id) === Boolean(options.handle)) {\n    throw new Error('Either a handle or id is required')\n  }\n  const query = qs.stringify({\n    limit: 1,\n    apiKey: config.apiKey,\n    cachebust: process.env.NODE_ENV !== 'production',\n    query: {\n      data: options.id\n        ? {\n            id: { $eq: options.id },\n          }\n        : {\n            handle: { $eq: options.handle },\n          },\n    },\n  })\n\n  const collectionsContent = (\n    await fetch(\n      `https://cdn.builder.io/api/v2/content/${config.collectionsModel}?${query}`\n    ).then((res) => res.json())\n  ).results\n\n  const collection = collectionsContent[0]?.data\n  if (config.isDemo) {\n    return collection\n  }\n  const productsQuery = {\n    limit: 20,\n    handle: collection?.handle,\n    ...options.productsQuery,\n    apiKey: config.apiKey,\n  }\n  const { products, nextPageCursor, hasNextPage } = await getCollectionProducts(\n    productsQuery\n  )\n\n  return {\n    ...collection,\n    products,\n    nextPageCursor,\n    hasNextPage,\n  }\n}\n\nexport const getCollectionProducts = (\n  productsQuery: CollectionProductsQuery\n): Promise<{\n  nextPageCursor: string\n  products: any[]\n  hasNextPage: boolean\n}> => {\n  const search = qs.stringify(productsQuery)\n  return fetch(\n    `https://cdn.builder.io/api/v1/shopify-sync/collection-products?${search}`\n  ).then((res) => res.json())\n}\n"]},"metadata":{},"sourceType":"module"}