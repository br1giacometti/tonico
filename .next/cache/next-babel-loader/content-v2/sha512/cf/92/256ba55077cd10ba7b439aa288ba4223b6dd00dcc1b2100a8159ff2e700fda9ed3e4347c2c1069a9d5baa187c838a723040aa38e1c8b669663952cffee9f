{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Bruno\\\\Desktop\\\\tienda\\\\nextjs-shopify-master\\\\blocks\\\\ProductView\\\\ProductView.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/** @jsxRuntime classic */\n\n/** @jsx jsx */\nimport React, { useMemo, useState, useEffect } from 'react';\nimport { Themed, jsx } from 'theme-ui';\nimport { Grid, Button } from '@theme-ui/components';\nimport OptionPicker from '@components/common/OptionPicker';\nimport { NextSeo } from 'next-seo';\nimport { useUI } from '@components/ui/context';\nimport { useAddItemToCart } from '@lib/shopify/storefront-data-hooks';\nimport { prepareVariantsWithOptions, prepareVariantsImages, getPrice } from '@lib/shopify/storefront-data-hooks/src/utils/product';\nimport { ImageCarousel, LoadingDots } from '@components/ui';\nimport ProductLoader from './ProductLoader';\n\nconst ProductBox = ({\n  product,\n  renderSeo = true,\n  description = product.description,\n  title = product.title\n}) => {\n  var _product$options, _product$options$find, _product$options$find2, _product$options2, _product$options2$fin, _product$options2$fin2, _product$images, _product$images$;\n\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const addItem = useAddItemToCart();\n  const colors = product === null || product === void 0 ? void 0 : (_product$options = product.options) === null || _product$options === void 0 ? void 0 : (_product$options$find = _product$options.find(option => {\n    var _option$name;\n\n    return (option === null || option === void 0 ? void 0 : (_option$name = option.name) === null || _option$name === void 0 ? void 0 : _option$name.toLowerCase()) === 'color';\n  })) === null || _product$options$find === void 0 ? void 0 : (_product$options$find2 = _product$options$find.values) === null || _product$options$find2 === void 0 ? void 0 : _product$options$find2.map(op => op.value);\n  const sizes = product === null || product === void 0 ? void 0 : (_product$options2 = product.options) === null || _product$options2 === void 0 ? void 0 : (_product$options2$fin = _product$options2.find(option => {\n    var _option$name2;\n\n    return (option === null || option === void 0 ? void 0 : (_option$name2 = option.name) === null || _option$name2 === void 0 ? void 0 : _option$name2.toLowerCase()) === 'size';\n  })) === null || _product$options2$fin === void 0 ? void 0 : (_product$options2$fin2 = _product$options2$fin.values) === null || _product$options2$fin2 === void 0 ? void 0 : _product$options2$fin2.map(op => op.value);\n  const variants = useMemo(() => prepareVariantsWithOptions(product === null || product === void 0 ? void 0 : product.variants), [product === null || product === void 0 ? void 0 : product.variants]);\n  const images = useMemo(() => prepareVariantsImages(variants, 'color'), [variants]);\n  const {\n    openSidebar\n  } = useUI();\n  const {\n    0: variant,\n    1: setVariant\n  } = useState(variants[0] || {});\n  const {\n    0: color,\n    1: setColor\n  } = useState(variant.color);\n  const {\n    0: size,\n    1: setSize\n  } = useState(variant.size);\n  useEffect(() => {\n    const newVariant = variants.find(variant => {\n      return (variant.size === size || !size) && (variant.color === color || !color);\n    });\n\n    if (variant.id !== (newVariant === null || newVariant === void 0 ? void 0 : newVariant.id)) {\n      setVariant(newVariant);\n    }\n  }, [size, color, variants, variant.id]);\n\n  const addToCart = async () => {\n    setLoading(true);\n\n    try {\n      await addItem(variant.id, 1);\n      openSidebar();\n      setLoading(false);\n    } catch (err) {\n      setLoading(false);\n    }\n  };\n\n  const allImages = images.map(({\n    src\n  }) => ({\n    src: src.src\n  })).concat(product.images && product.images.filter(({\n    src\n  }) => !images.find(image => image.src.src === src)));\n  return jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 5\n    }\n  }, renderSeo && jsx(NextSeo, {\n    title: title,\n    description: description,\n    openGraph: {\n      type: 'website',\n      title: title,\n      description: description,\n      images: [{\n        url: (_product$images = product.images) === null || _product$images === void 0 ? void 0 : (_product$images$ = _product$images[0]) === null || _product$images$ === void 0 ? void 0 : _product$images$.src,\n        width: 800,\n        height: 600,\n        alt: title\n      }]\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }), jsx(Grid, {\n    gap: 4,\n    columns: [1, 2],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }\n  }, jsx(\"div\", {\n    sx: {\n      border: '1px solid gray',\n      padding: 2,\n      marginBottom: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 11\n    }\n  }, jsx(ImageCarousel, {\n    showZoom: true,\n    alt: title,\n    width: 1050,\n    height: 1050,\n    priority: true,\n    onThumbnailClick: index => {\n      var _images$index;\n\n      if ((_images$index = images[index]) !== null && _images$index !== void 0 && _images$index.color) {\n        setColor(images[index].color);\n      }\n    },\n    images: (allImages === null || allImages === void 0 ? void 0 : allImages.length) > 0 ? allImages : [{\n      src: `https://via.placeholder.com/1050x1050`\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }))), jsx(\"div\", {\n    sx: {\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, jsx(\"span\", {\n    sx: {\n      mt: 0,\n      mb: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, jsx(Themed.h1, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, title), jsx(Themed.h4, {\n    \"aria-label\": \"price\",\n    sx: {\n      mt: 0,\n      mb: 2\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }, getPrice(variant.priceV2.amount, variant.priceV2.currencyCode))), jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: description\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  }), jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  }, jsx(Grid, {\n    padding: 2,\n    columns: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, (colors === null || colors === void 0 ? void 0 : colors.length) && jsx(OptionPicker, {\n    key: \"Color\",\n    name: \"Color\",\n    options: colors,\n    selected: color,\n    onChange: event => setColor(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }), (sizes === null || sizes === void 0 ? void 0 : sizes.length) && jsx(OptionPicker, {\n    key: \"Size\",\n    name: \"Size\",\n    options: sizes,\n    selected: size,\n    onChange: event => setSize(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }))), jsx(Button, {\n    name: \"add-to-cart\",\n    disabled: loading,\n    sx: {\n      margin: 2,\n      display: 'block'\n    },\n    onClick: addToCart,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 11\n    }\n  }, \"Add to Cart \", loading && jsx(LoadingDots, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 37\n    }\n  })))));\n};\n\nconst ProductView = (_ref) => {\n  let {\n    product\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"product\"]);\n\n  return jsx(ProductLoader, {\n    product: product,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 5\n    }\n  }, productObject => jsx(ProductBox, _objectSpread(_objectSpread({}, props), {}, {\n    product: productObject,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 27\n    }\n  })));\n};\n\nexport default ProductView;","map":{"version":3,"sources":["C:/Users/Bruno/Desktop/tienda/nextjs-shopify-master/blocks/ProductView/ProductView.tsx"],"names":["React","useMemo","useState","useEffect","Themed","jsx","Grid","Button","OptionPicker","NextSeo","useUI","useAddItemToCart","prepareVariantsWithOptions","prepareVariantsImages","getPrice","ImageCarousel","LoadingDots","ProductLoader","ProductBox","product","renderSeo","description","title","loading","setLoading","addItem","colors","options","find","option","name","toLowerCase","values","map","op","value","sizes","variants","images","openSidebar","variant","setVariant","color","setColor","size","setSize","newVariant","id","addToCart","err","allImages","src","concat","filter","image","type","url","width","height","alt","border","padding","marginBottom","index","length","display","flexDirection","mt","mb","priceV2","amount","currencyCode","__html","event","target","margin","ProductView","props","productObject"],"mappings":"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","sourcesContent":["/** @jsxRuntime classic */\n/** @jsx jsx */\nimport React, { useMemo, useState, useEffect } from 'react'\nimport { Themed, jsx } from 'theme-ui'\nimport { Grid, Button } from '@theme-ui/components'\nimport OptionPicker from '@components/common/OptionPicker'\nimport { NextSeo } from 'next-seo'\nimport { useUI } from '@components/ui/context'\nimport { useAddItemToCart } from '@lib/shopify/storefront-data-hooks'\nimport {\n  prepareVariantsWithOptions,\n  prepareVariantsImages,\n  getPrice,\n} from '@lib/shopify/storefront-data-hooks/src/utils/product'\nimport { ImageCarousel, LoadingDots } from '@components/ui'\nimport ProductLoader from './ProductLoader'\n\ninterface Props {\n  className?: string\n  children?: any\n  product: ShopifyBuy.Product\n  renderSeo?: boolean\n  description?: string\n  title?: string\n}\n\nconst ProductBox: React.FC<Props> = ({\n  product,\n  renderSeo = true,\n  description = product.description,\n  title = product.title,\n}) => {\n  const [loading, setLoading] = useState(false)\n  const addItem = useAddItemToCart()\n  const colors: string[] | undefined = product?.options\n    ?.find((option) => option?.name?.toLowerCase() === 'color')\n    ?.values?.map((op) => op.value as string)\n\n  const sizes: string[] | undefined = product?.options\n    ?.find((option) => option?.name?.toLowerCase() === 'size')\n    ?.values?.map((op) => op.value as string)\n\n  const variants = useMemo(\n    () => prepareVariantsWithOptions(product?.variants),\n    [product?.variants]\n  )\n  const images = useMemo(() => prepareVariantsImages(variants, 'color'), [\n    variants,\n  ])\n\n  const { openSidebar } = useUI()\n\n  const [variant, setVariant] = useState(variants[0] || {})\n  const [color, setColor] = useState(variant.color)\n  const [size, setSize] = useState(variant.size)\n\n  useEffect(() => {\n    const newVariant = variants.find((variant) => {\n      return (\n        (variant.size === size || !size) && (variant.color === color || !color)\n      )\n    })\n\n    if (variant.id !== newVariant?.id) {\n      setVariant(newVariant)\n    }\n  }, [size, color, variants, variant.id])\n\n  const addToCart = async () => {\n    setLoading(true)\n    try {\n      await addItem(variant.id, 1)\n      openSidebar()\n      setLoading(false)\n    } catch (err) {\n      setLoading(false)\n    }\n  }\n  const allImages = images\n    .map(({ src }) => ({ src: src.src }))\n    .concat(\n      product.images &&\n        product.images.filter(\n          ({ src }) => !images.find((image) => image.src.src === src)\n        )\n    )\n\n  return (\n    <React.Fragment>\n      {renderSeo && (\n        <NextSeo\n          title={title}\n          description={description}\n          openGraph={{\n            type: 'website',\n            title: title,\n            description: description,\n            images: [\n              {\n                url: product.images?.[0]?.src!,\n                width: 800,\n                height: 600,\n                alt: title,\n              },\n            ],\n          }}\n        />\n      )}\n      <Grid gap={4} columns={[1, 2]}>\n        <div>\n          <div\n            sx={{\n              border: '1px solid gray',\n              padding: 2,\n              marginBottom: 2,\n            }}\n          >\n            <ImageCarousel\n              showZoom\n              alt={title}\n              width={1050}\n              height={1050}\n              priority\n              onThumbnailClick={(index) => {\n                if (images[index]?.color) {\n                  setColor(images[index].color)\n                }\n              }}\n              images={allImages?.length > 0 ? allImages: [{\n                  src: `https://via.placeholder.com/1050x1050`,\n                }]}\n            ></ImageCarousel>\n          </div>\n        </div>\n        <div sx={{ display: 'flex', flexDirection: 'column' }}>\n          <span sx={{ mt: 0, mb: 2 }}>\n            <Themed.h1>{title}</Themed.h1>\n            <Themed.h4 aria-label=\"price\" sx={{ mt: 0, mb: 2 }}>\n              {getPrice(variant.priceV2.amount, variant.priceV2.currencyCode)}\n            </Themed.h4>\n          </span>\n          <div dangerouslySetInnerHTML={{ __html: description! }} />\n          <div>\n            <Grid padding={2} columns={2}>\n              {colors?.length && (\n                <OptionPicker\n                  key=\"Color\"\n                  name=\"Color\"\n                  options={colors}\n                  selected={color}\n                  onChange={(event) => setColor(event.target.value)}\n                />\n              )}\n              {sizes?.length && (\n                <OptionPicker\n                  key=\"Size\"\n                  name=\"Size\"\n                  options={sizes}\n                  selected={size}\n                  onChange={(event) => setSize(event.target.value)}\n                />\n              )}\n            </Grid>\n          </div>\n          <Button\n            name=\"add-to-cart\"\n            disabled={loading}\n            sx={{ margin: 2, display: 'block' }}\n            onClick={addToCart}\n          >\n            Add to Cart {loading && <LoadingDots />}\n          </Button>\n        </div>\n      </Grid>\n    </React.Fragment>\n  )\n}\n\nconst ProductView: React.FC<{\n  product: string | ShopifyBuy.Product\n  renderSeo?: boolean\n  description?: string\n  title?: string\n}> = ({ product, ...props }) => {\n  return (\n    <ProductLoader product={product}>\n      {(productObject) => <ProductBox {...props} product={productObject} />}\n    </ProductLoader>\n  )\n}\nexport default ProductView\n"]},"metadata":{},"sourceType":"module"}